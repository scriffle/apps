<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Topic Builder - Dynamic Learning Check-in</title>
    <style>
/* ============================================
   CSS VARIABLES & RESET
   ============================================ */
:root {
    /* Colors */
    --color-primary: #2d9d78;
    --color-primary-dark: #1e7d5e;
    --color-primary-pale: #e8f5f0;
    
    --color-bg: #f8faf9;
    --color-bg-card: #ffffff;
    --color-bg-warm: #f5f7f6;
    --color-bg-hover: rgba(45, 157, 120, 0.08);
    
    --color-text: #1a2e28;
    --color-text-secondary: #4a5f58;
    --color-text-muted: #7a8f88;
    --color-text-inverse: #ffffff;
    
    --color-border: #d4ddd9;
    --color-border-light: #e8eeeb;
    
    --color-success: #22c55e;
    --color-warning: #f59e0b;
    --color-error: #ef4444;
    
    /* Typography */
    --font-display: 'Segoe UI', system-ui, -apple-system, sans-serif;
    --font-body: 'Segoe UI', system-ui, -apple-system, sans-serif;
    --font-mono: 'SF Mono', 'Consolas', 'Monaco', monospace;
    
    --text-xs: 0.75rem;
    --text-sm: 0.875rem;
    --text-base: 1rem;
    --text-lg: 1.125rem;
    --text-xl: 1.25rem;
    --text-2xl: 1.5rem;
    
    /* Spacing */
    --space-1: 0.25rem;
    --space-2: 0.5rem;
    --space-3: 0.75rem;
    --space-4: 1rem;
    --space-5: 1.5rem;
    --space-6: 2rem;
    
    /* Borders & Shadows */
    --radius-sm: 6px;
    --radius-md: 8px;
    --radius-lg: 12px;
    --radius-xl: 16px;
    
    --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
    --shadow-md: 0 4px 6px rgba(0,0,0,0.07);
    --shadow-lg: 0 10px 25px rgba(0,0,0,0.1);
    
    /* Transitions */
    --transition-fast: 0.15s ease;
    --transition-normal: 0.25s ease;
}

/* Dark Mode */
[data-theme="dark"] {
    --color-bg: #0f1714;
    --color-bg-card: #1a2420;
    --color-bg-warm: #1f2d28;
    --color-bg-hover: rgba(45, 157, 120, 0.15);
    
    --color-text: #e8f0ed;
    --color-text-secondary: #a8b8b2;
    --color-text-muted: #6a7a74;
    
    --color-border: #2d3d36;
    --color-border-light: #243029;
    
    --color-primary-pale: rgba(45, 157, 120, 0.2);
}

/* Reset */
*, *::before, *::after {
    box-sizing: border-box;
    margin: 0;
    padding: 0;
}

html {
    font-size: 16px;
    -webkit-text-size-adjust: 100%;
}

body {
    font-family: var(--font-body);
    font-size: var(--text-base);
    line-height: 1.6;
    color: var(--color-text);
    background: var(--color-bg);
    min-height: 100vh;
    min-height: 100dvh;
}

/* ============================================
   LAYOUT
   ============================================ */
.app-container {
    min-height: 100vh;
    min-height: 100dvh;
    display: flex;
    flex-direction: column;
}

.app-header {
    background: linear-gradient(135deg, var(--color-primary-dark) 0%, var(--color-primary) 100%);
    color: var(--color-text-inverse);
    padding: var(--space-4) var(--space-5);
    position: sticky;
    top: 0;
    z-index: 100;
}

.header-content {
    max-width: 1000px;
    margin: 0 auto;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-3);
    flex-wrap: wrap;
}

.app-title {
    font-family: var(--font-display);
    font-size: var(--text-xl);
    font-weight: 700;
    display: flex;
    align-items: center;
    gap: var(--space-2);
}

.app-subtitle {
    font-size: var(--text-sm);
    opacity: 0.9;
    font-weight: 400;
}

.header-actions {
    display: flex;
    align-items: center;
    gap: var(--space-2);
}

.header-btn {
    background: rgba(255, 255, 255, 0.15);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: var(--color-text-inverse);
    padding: var(--space-2) var(--space-3);
    border-radius: var(--radius-md);
    cursor: pointer;
    font-size: var(--text-sm);
    transition: all var(--transition-fast);
}

.header-btn:hover {
    background: rgba(255, 255, 255, 0.25);
}

.main-content {
    flex: 1;
    max-width: 1000px;
    width: 100%;
    margin: 0 auto;
    padding: var(--space-5);
}

/* ============================================
   CARDS & SECTIONS
   ============================================ */
.card {
    background: var(--color-bg-card);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--space-5);
    margin-bottom: var(--space-4);
}

.card-header {
    margin-bottom: var(--space-4);
}

.card-title {
    font-family: var(--font-display);
    font-size: var(--text-lg);
    font-weight: 700;
    color: var(--color-text);
    display: flex;
    align-items: center;
    gap: var(--space-2);
}

.card-description {
    font-size: var(--text-sm);
    color: var(--color-text-muted);
    margin-top: var(--space-2);
}

.section-divider {
    height: 1px;
    background: var(--color-border);
    margin: var(--space-5) 0;
}

/* ============================================
   FORMS
   ============================================ */
.form-row {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: var(--space-4);
    margin-bottom: var(--space-4);
}

.form-group {
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
}

.form-group.full-width {
    grid-column: 1 / -1;
}

.form-label {
    font-size: var(--text-sm);
    font-weight: 600;
    color: var(--color-text);
}

.form-label-hint {
    font-weight: 400;
    color: var(--color-text-muted);
}

.form-input,
.form-select,
.form-textarea {
    padding: var(--space-3);
    font-size: var(--text-sm);
    font-family: var(--font-body);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    background: var(--color-bg-card);
    color: var(--color-text);
    transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
}

.form-input:focus,
.form-select:focus,
.form-textarea:focus {
    outline: none;
    border-color: var(--color-primary);
    box-shadow: 0 0 0 3px var(--color-primary-pale);
}

.form-select {
    cursor: pointer;
    appearance: none;
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%236b7280' d='M2 4l4 4 4-4'/%3E%3C/svg%3E");
    background-repeat: no-repeat;
    background-position: right 12px center;
    padding-right: var(--space-6);
}

.form-textarea {
    resize: vertical;
    min-height: 150px;
    line-height: 1.5;
}

.form-textarea.large {
    min-height: 250px;
}

.form-hint {
    font-size: var(--text-xs);
    color: var(--color-text-muted);
}

.char-count {
    font-size: var(--text-xs);
    color: var(--color-text-muted);
    text-align: right;
}

/* ============================================
   BUTTONS
   ============================================ */
.btn {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    gap: var(--space-2);
    padding: var(--space-3) var(--space-5);
    font-size: var(--text-sm);
    font-weight: 600;
    font-family: var(--font-body);
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: all var(--transition-fast);
    border: none;
}

.btn-primary {
    background: var(--color-primary);
    color: var(--color-text-inverse);
}

.btn-primary:hover {
    background: var(--color-primary-dark);
}

.btn-primary:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.btn-secondary {
    background: var(--color-bg-warm);
    color: var(--color-text);
    border: 1px solid var(--color-border);
}

.btn-secondary:hover {
    background: var(--color-bg-hover);
    border-color: var(--color-primary);
}

.btn-large {
    padding: var(--space-4) var(--space-6);
    font-size: var(--text-base);
}

.btn-icon {
    font-size: 1.1em;
}

/* ============================================
   OUTPUT SECTION
   ============================================ */
.output-section {
    background: var(--color-bg-warm);
    border: 2px dashed var(--color-border);
    border-radius: var(--radius-lg);
    padding: var(--space-5);
}

.output-section.has-content {
    border-style: solid;
    border-color: var(--color-primary);
    background: var(--color-bg-card);
}

.output-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--space-3);
    margin-bottom: var(--space-4);
    flex-wrap: wrap;
}

.output-title {
    font-size: var(--text-lg);
    font-weight: 700;
    color: var(--color-text);
    display: flex;
    align-items: center;
    gap: var(--space-2);
}

.output-actions {
    display: flex;
    gap: var(--space-2);
}

.output-preview {
    background: var(--color-bg-warm);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    padding: var(--space-4);
    font-family: var(--font-mono);
    font-size: var(--text-xs);
    line-height: 1.6;
    white-space: pre-wrap;
    word-break: break-word;
    max-height: 500px;
    overflow-y: auto;
    color: var(--color-text-secondary);
}

.output-placeholder {
    text-align: center;
    color: var(--color-text-muted);
    padding: var(--space-6);
}

.output-placeholder-icon {
    font-size: 48px;
    margin-bottom: var(--space-3);
    opacity: 0.5;
}

/* ============================================
   TOAST NOTIFICATIONS
   ============================================ */
.toast-container {
    position: fixed;
    bottom: var(--space-5);
    right: var(--space-5);
    z-index: 1000;
    display: flex;
    flex-direction: column;
    gap: var(--space-2);
}

.toast {
    background: var(--color-bg-card);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    padding: var(--space-3) var(--space-4);
    box-shadow: var(--shadow-lg);
    display: flex;
    align-items: center;
    gap: var(--space-3);
    animation: slideIn 0.3s ease;
}

@keyframes slideIn {
    from { transform: translateX(100%); opacity: 0; }
    to { transform: translateX(0); opacity: 1; }
}

.toast-success { border-left: 3px solid var(--color-success); }
.toast-error { border-left: 3px solid var(--color-error); }
.toast-info { border-left: 3px solid var(--color-primary); }

.toast-message {
    font-size: var(--text-sm);
    color: var(--color-text);
}

.toast-close {
    background: none;
    border: none;
    color: var(--color-text-muted);
    cursor: pointer;
    padding: var(--space-1);
    font-size: var(--text-lg);
    line-height: 1;
}

/* ============================================
   INSTRUCTIONS PANEL
   ============================================ */
.instructions {
    background: var(--color-primary-pale);
    border: 1px solid var(--color-primary);
    border-radius: var(--radius-lg);
    padding: var(--space-4);
    margin-bottom: var(--space-5);
}

.instructions-title {
    font-weight: 600;
    color: var(--color-primary-dark);
    margin-bottom: var(--space-2);
    display: flex;
    align-items: center;
    gap: var(--space-2);
}

.instructions-list {
    font-size: var(--text-sm);
    color: var(--color-text-secondary);
    padding-left: var(--space-5);
}

.instructions-list li {
    margin-bottom: var(--space-1);
}

/* ============================================
   RESPONSIVE
   ============================================ */
@media (max-width: 768px) {
    .main-content {
        padding: var(--space-3);
    }
    
    .card {
        padding: var(--space-4);
    }
    
    .form-row {
        grid-template-columns: 1fr;
    }
    
    .output-header {
        flex-direction: column;
        align-items: stretch;
    }
    
    .output-actions {
        justify-content: stretch;
    }
    
    .output-actions .btn {
        flex: 1;
    }
    
    .header-content {
        flex-direction: column;
        text-align: center;
    }
}

/* ============================================
   PRINT
   ============================================ */
@media print {
    .app-header, .header-actions, .toast-container, .btn { display: none; }
    .card { break-inside: avoid; }
}
    </style>
</head>
<body>
    <div class="app-container">
        <header class="app-header">
            <div class="header-content">
                <div>
                    <h1 class="app-title">
                        <span>üõ†Ô∏è</span>
                        <span>Topic Builder</span>
                    </h1>
                    <p class="app-subtitle">Create prompts for Dynamic Learning Check-in topics</p>
                </div>
                <div class="header-actions">
                    <button class="header-btn" id="theme-toggle" title="Toggle dark mode">üåô</button>
                    <button class="header-btn" id="clear-all-btn" title="Clear all fields">üóëÔ∏è Clear</button>
                </div>
            </div>
        </header>
        
        <main class="main-content">
            
            <!-- Instructions -->
            <div class="instructions">
                <div class="instructions-title">üìã How to use this tool</div>
                <ol class="instructions-list">
                    <li>Fill in the topic metadata (Year Level, Subject, etc.)</li>
                    <li>Paste your teaching content and curriculum specifications</li>
                    <li>Click "Generate Prompt" to create an AI-ready prompt</li>
                    <li>Copy the prompt and paste it into Claude (or your chosen AI)</li>
                    <li>The AI will output a JSON file ready for Dynamic Learning Check-in</li>
                </ol>
            </div>
            
            <!-- Metadata Card -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">
                        <span>üìù</span>
                        <span>Topic Details</span>
                    </h2>
                    <p class="card-description">Basic information about the topic. These can be edited, or left for the AI to infer from your content.</p>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="year-level">Year Level</label>
                        <select class="form-select" id="year-level">
                            <option value="">-- Select or type below --</option>
                            <option value="Year 7">Year 7</option>
                            <option value="Year 8">Year 8</option>
                            <option value="Year 9">Year 9</option>
                            <option value="Year 10">Year 10</option>
                            <option value="Year 11">Year 11</option>
                            <option value="Year 12">Year 12</option>
                            <option value="VCE Unit 1">VCE Unit 1</option>
                            <option value="VCE Unit 2">VCE Unit 2</option>
                            <option value="VCE Unit 3">VCE Unit 3</option>
                            <option value="VCE Unit 4">VCE Unit 4</option>
                            <option value="custom">Custom...</option>
                        </select>
                        <input type="text" class="form-input" id="year-level-custom" placeholder="Enter custom year level" style="display: none;">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="subject">Subject</label>
                        <select class="form-select" id="subject">
                            <option value="">-- Select or type below --</option>
                            <option value="Mathematics">Mathematics</option>
                            <option value="English">English</option>
                            <option value="Science">Science</option>
                            <option value="Biology">Biology</option>
                            <option value="Chemistry">Chemistry</option>
                            <option value="Physics">Physics</option>
                            <option value="Psychology">Psychology</option>
                            <option value="History">History</option>
                            <option value="Geography">Geography</option>
                            <option value="Economics">Economics</option>
                            <option value="Business Management">Business Management</option>
                            <option value="Legal Studies">Legal Studies</option>
                            <option value="Health and Physical Education">Health and Physical Education</option>
                            <option value="Digital Technologies">Digital Technologies</option>
                            <option value="custom">Custom...</option>
                        </select>
                        <input type="text" class="form-input" id="subject-custom" placeholder="Enter custom subject" style="display: none;">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="topic-name">Topic Name <span class="form-label-hint">(optional - AI can infer)</span></label>
                        <input type="text" class="form-input" id="topic-name" placeholder="e.g., Linear Equations and Graphs">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="class-code">Class Code <span class="form-label-hint">(optional)</span></label>
                        <input type="text" class="form-input" id="class-code" placeholder="e.g., 9A Mathematics">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label" for="curriculum-code">Curriculum Code <span class="form-label-hint">(optional)</span></label>
                        <input type="text" class="form-input" id="curriculum-code" placeholder="e.g., VCMNA315">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label" for="ai-target">AI Target</label>
                        <select class="form-select" id="ai-target">
                            <option value="claude" selected>Claude (Anthropic)</option>
                            <option value="chatgpt">ChatGPT (OpenAI)</option>
                            <option value="gemini">Gemini (Google)</option>
                            <option value="generic">Generic / Other</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <!-- Content Card -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">
                        <span>üìö</span>
                        <span>Teaching Content</span>
                    </h2>
                    <p class="card-description">Paste your teaching notes, lesson content, examples, and any material you want the AI to use when creating learning intentions.</p>
                </div>
                
                <div class="form-group full-width">
                    <label class="form-label" for="teacher-content">Your Teaching Content</label>
                    <textarea class="form-textarea large" id="teacher-content" placeholder="Paste your teaching notes, lesson plans, explanations, examples, assessment criteria, etc.

The more detail you provide, the better the AI can create relevant 'I can...' statements and explanations."></textarea>
                    <div class="char-count" id="teacher-content-count">0 characters</div>
                </div>
            </div>
            
            <!-- Curriculum Card -->
            <div class="card">
                <div class="card-header">
                    <h2 class="card-title">
                        <span>üìã</span>
                        <span>Curriculum Specifications</span>
                    </h2>
                    <p class="card-description">Paste the VCE or Victorian Curriculum specifications for this topic. Include Area of Study (AOS), Strand, and any elaborations.</p>
                </div>
                
                <div class="form-group full-width">
                    <label class="form-label" for="curriculum-content">Curriculum Specifications</label>
                    <textarea class="form-textarea large" id="curriculum-content" placeholder="Paste the curriculum content here. This typically includes:

‚Ä¢ Area of Study (AOS) or Strand name
‚Ä¢ Key knowledge points
‚Ä¢ Key skills
‚Ä¢ Elaborations
‚Ä¢ Content descriptions
‚Ä¢ Achievement standards

Copy directly from the VCAA website or curriculum documents."></textarea>
                    <div class="char-count" id="curriculum-content-count">0 characters</div>
                </div>
            </div>
            
            <!-- Generate Button -->
            <div style="text-align: center; margin: var(--space-5) 0;">
                <button class="btn btn-primary btn-large" id="generate-btn">
                    <span class="btn-icon">‚ú®</span>
                    <span>Generate Prompt</span>
                </button>
            </div>
            
            <!-- Output Section -->
            <div class="output-section" id="output-section">
                <div class="output-header">
                    <h2 class="output-title">
                        <span>üì§</span>
                        <span>Generated Prompt</span>
                    </h2>
                    <div class="output-actions" id="output-actions" style="display: none;">
                        <button class="btn btn-primary" id="copy-btn">
                            <span class="btn-icon">üìã</span>
                            <span>Copy to Clipboard</span>
                        </button>
                    </div>
                </div>
                
                <div id="output-content">
                    <div class="output-placeholder">
                        <div class="output-placeholder-icon">üìù</div>
                        <p>Fill in the fields above and click "Generate Prompt" to create your AI prompt.</p>
                    </div>
                </div>
            </div>
            
        </main>
    </div>
    
    <!-- Toast Container -->
    <div class="toast-container" id="toast-container"></div>
    
    <script>
// ============================================
// STATE
// ============================================
let currentTheme = 'light';

// ============================================
// INITIALIZATION
// ============================================
function init() {
    // Theme
    if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
        setTheme('dark');
    }
    
    // Event listeners
    document.getElementById('theme-toggle').addEventListener('click', toggleTheme);
    document.getElementById('clear-all-btn').addEventListener('click', clearAll);
    document.getElementById('generate-btn').addEventListener('click', generatePrompt);
    document.getElementById('copy-btn').addEventListener('click', copyToClipboard);
    
    // Custom field toggles
    document.getElementById('year-level').addEventListener('change', handleCustomSelect);
    document.getElementById('subject').addEventListener('change', handleCustomSelect);
    
    // Character counts
    document.getElementById('teacher-content').addEventListener('input', updateCharCount);
    document.getElementById('curriculum-content').addEventListener('input', updateCharCount);
}

// ============================================
// THEME
// ============================================
function setTheme(theme) {
    currentTheme = theme;
    document.documentElement.setAttribute('data-theme', theme);
    document.getElementById('theme-toggle').textContent = theme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
}

function toggleTheme() {
    setTheme(currentTheme === 'dark' ? 'light' : 'dark');
}

// ============================================
// UI HELPERS
// ============================================
function handleCustomSelect(e) {
    const select = e.target;
    const customInput = document.getElementById(select.id + '-custom');
    
    if (select.value === 'custom') {
        customInput.style.display = 'block';
        customInput.focus();
    } else {
        customInput.style.display = 'none';
        customInput.value = '';
    }
}

function updateCharCount(e) {
    const textarea = e.target;
    const countEl = document.getElementById(textarea.id + '-count');
    if (countEl) {
        const count = textarea.value.length;
        countEl.textContent = `${count.toLocaleString()} characters`;
    }
}

function showToast(message, type = 'info') {
    const container = document.getElementById('toast-container');
    const toast = document.createElement('div');
    toast.className = `toast toast-${type}`;
    
    const icons = { success: '‚úÖ', error: '‚ùå', info: '‚ÑπÔ∏è' };
    
    toast.innerHTML = `
        <span>${icons[type] || icons.info}</span>
        <span class="toast-message">${message}</span>
        <button class="toast-close">√ó</button>
    `;
    
    container.appendChild(toast);
    toast.querySelector('.toast-close').addEventListener('click', () => toast.remove());
    setTimeout(() => toast.remove(), 4000);
}

function clearAll() {
    document.getElementById('year-level').value = '';
    document.getElementById('year-level-custom').value = '';
    document.getElementById('year-level-custom').style.display = 'none';
    document.getElementById('subject').value = '';
    document.getElementById('subject-custom').value = '';
    document.getElementById('subject-custom').style.display = 'none';
    document.getElementById('topic-name').value = '';
    document.getElementById('class-code').value = '';
    document.getElementById('curriculum-code').value = '';
    document.getElementById('teacher-content').value = '';
    document.getElementById('curriculum-content').value = '';
    document.getElementById('teacher-content-count').textContent = '0 characters';
    document.getElementById('curriculum-content-count').textContent = '0 characters';
    
    // Reset output
    document.getElementById('output-section').classList.remove('has-content');
    document.getElementById('output-actions').style.display = 'none';
    document.getElementById('output-content').innerHTML = `
        <div class="output-placeholder">
            <div class="output-placeholder-icon">üìù</div>
            <p>Fill in the fields above and click "Generate Prompt" to create your AI prompt.</p>
        </div>
    `;
    
    showToast('All fields cleared', 'info');
}

// ============================================
// GET FIELD VALUES
// ============================================
function getFieldValue(selectId) {
    const select = document.getElementById(selectId);
    const customInput = document.getElementById(selectId + '-custom');
    
    if (select.value === 'custom' && customInput) {
        return customInput.value.trim();
    }
    return select.value;
}

// ============================================
// GENERATE PROMPT
// ============================================
function generatePrompt() {
    const yearLevel = getFieldValue('year-level');
    const subject = getFieldValue('subject');
    const topicName = document.getElementById('topic-name').value.trim();
    const classCode = document.getElementById('class-code').value.trim();
    const curriculumCode = document.getElementById('curriculum-code').value.trim();
    const aiTarget = document.getElementById('ai-target').value;
    const teacherContent = document.getElementById('teacher-content').value.trim();
    const curriculumContent = document.getElementById('curriculum-content').value.trim();
    
    // Validation
    if (!teacherContent && !curriculumContent) {
        showToast('Please provide either teaching content or curriculum specifications', 'error');
        return;
    }
    
    // Build metadata section
    let metadataHints = [];
    if (yearLevel) metadataHints.push(`Year Level: ${yearLevel}`);
    if (subject) metadataHints.push(`Subject: ${subject}`);
    if (topicName) metadataHints.push(`Topic Name: ${topicName}`);
    if (classCode) metadataHints.push(`Class Code: ${classCode}`);
    if (curriculumCode) metadataHints.push(`Curriculum Code: ${curriculumCode}`);
    
    const metadataSection = metadataHints.length > 0 
        ? `The teacher has provided the following metadata (use these values, or infer appropriate values if not provided):
${metadataHints.join('\n')}`
        : `The teacher has not provided specific metadata. Please infer appropriate values for yearLevel, subject, name, and class from the content provided.`;
    
    // AI-specific instructions
    let aiInstructions = '';
    if (aiTarget === 'claude') {
        aiInstructions = `You are an expert curriculum designer helping a teacher create learning materials.`;
    } else if (aiTarget === 'chatgpt') {
        aiInstructions = `You are an expert curriculum designer helping a teacher create learning materials. Please follow the instructions carefully and output only the JSON with no additional commentary.`;
    } else if (aiTarget === 'gemini') {
        aiInstructions = `You are an expert curriculum designer helping a teacher create learning materials. Output only valid JSON with no markdown formatting or code blocks.`;
    } else {
        aiInstructions = `You are an expert curriculum designer. Output only valid JSON.`;
    }
    
    // Build the prompt
    const prompt = `${aiInstructions}

Your task is to create a comprehensive JSON file for a student learning check-in application. This application helps students self-assess their understanding of learning outcomes before an assessment.

${metadataSection}

---

## TEACHER'S CONTENT

${teacherContent || '(No teacher content provided - rely on curriculum specifications)'}

---

## CURRICULUM SPECIFICATIONS

${curriculumContent || '(No curriculum specifications provided - rely on teacher content)'}

---

## OUTPUT REQUIREMENTS

Generate a single, valid JSON object with the following structure. The output should be ONLY the JSON, with no additional text, explanation, or markdown code blocks.

### JSON Structure:

{
  "id": "unique-topic-id-in-kebab-case",
  "name": "Topic Name",
  "subject": "Subject Name",
  "yearLevel": "Year X",
  "class": "Class code like 9A Mathematics",
  "curriculumCode": "Curriculum reference codes",
  "description": "Brief 1-2 sentence description of the topic",
  "subtopics": [
    {
      "id": "subtopic-id",
      "name": "Subtopic Name",
      "icon": "üìä",
      "what": "Explanation of what this subtopic covers (2-3 sentences)",
      "why": "Why this subtopic matters and how it connects to real applications (2-3 sentences)",
      "items": [
        {
          "id": 1,
          "title": "I can [specific measurable skill]",
          "code": "Reference code",
          "what": "Clear explanation of what this means (1-2 sentences)",
          "why": "Why this skill matters (1-2 sentences)",
          "example": "A concrete, specific example demonstrating this concept"
        }
      ]
    }
  ]
}

### Critical Requirements:

1. **Learning intentions (items)**: Each must start with "I can" followed by a specific, measurable skill
2. **Quantity**: Aim for approximately 15-30 learning items total, grouped into 2-5 logical subtopics. Use more if the content genuinely requires it, fewer if the topic is narrow.
3. **IDs**: 
   - Topic and subtopic IDs should be kebab-case strings
   - Item IDs must be unique integers starting from 1
4. **Icons**: Use relevant emoji for subtopic icons (üìê üìä üìà üî¢ üìù üí° üßÆ üî¨ üìñ etc.)
5. **Code references**: Include curriculum codes where available, or use logical numbering (1.1, 1.2, 2.1, etc.)

### Tone and Style:

- **Calm and factual**: No exclamation marks, no false positivity, no "You've got this" style encouragement
- **Student-friendly**: Clear, simple language appropriate for the year level
- **Practical focus**: This is a checklist for assessment preparation - be direct about what students need to know
- **Helpful explanations**: The "what", "why", and "example" fields should genuinely help a confused student understand
- **Examples should be concrete**: Use specific numbers, scenarios, or worked examples where possible

### What NOT to do:

- Do not include any text before or after the JSON
- Do not wrap the JSON in markdown code blocks
- Do not use exclamation marks
- Do not use overly enthusiastic or patronizing language
- Do not create vague or unmeasurable learning intentions
- Do not skip the "what", "why", or "example" fields - every item needs all three

Now generate the JSON:`;

    // Display the prompt
    document.getElementById('output-section').classList.add('has-content');
    document.getElementById('output-actions').style.display = 'flex';
    document.getElementById('output-content').innerHTML = `<pre class="output-preview">${escapeHtml(prompt)}</pre>`;
    
    // Scroll to output
    document.getElementById('output-section').scrollIntoView({ behavior: 'smooth', block: 'start' });
    
    showToast('Prompt generated successfully', 'success');
}

// ============================================
// COPY TO CLIPBOARD
// ============================================
async function copyToClipboard() {
    const outputPreview = document.querySelector('.output-preview');
    if (!outputPreview) {
        showToast('No prompt to copy', 'error');
        return;
    }
    
    const text = outputPreview.textContent;
    
    try {
        await navigator.clipboard.writeText(text);
        showToast('Copied to clipboard', 'success');
        
        // Visual feedback
        const btn = document.getElementById('copy-btn');
        const originalText = btn.innerHTML;
        btn.innerHTML = '<span class="btn-icon">‚úÖ</span><span>Copied</span>';
        setTimeout(() => {
            btn.innerHTML = originalText;
        }, 2000);
    } catch (err) {
        // Fallback for older browsers
        const textarea = document.createElement('textarea');
        textarea.value = text;
        textarea.style.position = 'fixed';
        textarea.style.opacity = '0';
        document.body.appendChild(textarea);
        textarea.select();
        
        try {
            document.execCommand('copy');
            showToast('Copied to clipboard', 'success');
        } catch (e) {
            showToast('Failed to copy - please select and copy manually', 'error');
        }
        
        document.body.removeChild(textarea);
    }
}

// ============================================
// UTILITIES
// ============================================
function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}

// ============================================
// INIT
// ============================================
document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
