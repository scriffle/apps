<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Kinematics Calculator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 10px;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 15px;
            text-align: center;
        }

        .header h1 {
            font-size: 1.8em;
            margin-bottom: 5px;
            font-weight: 300;
        }

        .header p {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            padding: 15px;
        }

        .input-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #e9ecef;
        }

        .input-section h2 {
            color: #495057;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .input-group {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
            gap: 10px;
        }

        .input-group label {
            flex: 1;
            font-weight: 600;
            color: #495057;
            font-size: 0.9em;
            min-width: 150px;
        }

        .input-group input {
            flex: 0 0 120px;
            padding: 8px 10px;
            border: 2px solid #dee2e6;
            border-radius: 6px;
            font-size: 0.9em;
            transition: all 0.3s ease;
            background: white;
        }

        .input-group input:focus {
            border-color: #4CAF50;
            outline: none;
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
        }

        .input-group input.calculated {
            background: #e8f5e8;
            border-color: #4CAF50;
        }

        .input-group input.adjusted {
            background: #fff3cd;
            border-color: #ffc107;
        }

        .equations-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #e9ecef;
        }

        .equation {
            background: white;
            padding: 8px;
            margin: 5px 0;
            border-radius: 6px;
            border-left: 4px solid #dee2e6;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            transition: all 0.3s ease;
        }

        .equation.active {
            border-left-color: #4CAF50;
            background: linear-gradient(90deg, #e8f5e8, white);
            transform: scale(1.02);
            box-shadow: 0 3px 10px rgba(76, 175, 80, 0.2);
        }

        .graph-container {
            grid-column: 1 / -1;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #e9ecef;
            margin-top: 10px;
        }

        .graph-container h2 {
            color: #495057;
            margin-bottom: 10px;
            text-align: center;
            font-size: 1.2em;
        }

        .graphs {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 12px;
        }

        .graph {
            background: white;
            border-radius: 6px;
            padding: 10px;
            text-align: center;
            border: 2px solid #e9ecef;
        }

        .graph h3 {
            margin-bottom: 8px;
            color: #495057;
            font-size: 0.9em;
        }

        canvas {
            border: 1px solid #dee2e6;
            border-radius: 5px;
        }

        .status {
            grid-column: 1 / -1;
            background: #17a2b8;
            color: white;
            padding: 8px;
            border-radius: 6px;
            text-align: center;
            font-weight: 600;
            margin-bottom: 10px;
            font-size: 0.9em;
        }

        .status.success {
            background: #28a745;
        }

        .status.warning {
            background: #ffc107;
            color: #333;
        }

        .clear-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            font-size: 0.85em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 10px;
        }

        .clear-btn:hover {
            background: #c82333;
            transform: translateY(-1px);
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .graphs {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Dynamic Kinematics Calculator</h1>
            <p>Enter any values and the system will adapt others to maintain valid physics</p>
        </div>

        <div class="main-content">
            <div id="status" class="status">Enter any 3 values to calculate the missing variables</div>

            <div class="input-section">
                <h2>Variables</h2>
                <div style="background: #e9ecef; padding: 6px; border-radius: 4px; margin-bottom: 8px; font-size: 0.8em;">
                    <strong>Color Guide:</strong> 
                    <span style="background: white; padding: 1px 4px; border-radius: 2px; margin: 0 3px;">Normal</span>
                    <span style="background: #e8f5e8; padding: 1px 4px; border-radius: 2px; margin: 0 3px;">Calculated</span>
                    <span style="background: #fff3cd; padding: 1px 4px; border-radius: 2px; margin: 0 3px;">Auto-adjusted</span>
                </div>
                <div class="input-group">
                    <label for="u">Initial Velocity (u) - m/s</label>
                    <input type="number" id="u" step="any" placeholder="Enter initial velocity">
                </div>
                <div class="input-group">
                    <label for="v">Final Velocity (v) - m/s</label>
                    <input type="number" id="v" step="any" placeholder="Enter final velocity">
                </div>
                <div class="input-group">
                    <label for="a">Acceleration (a) - m/s²</label>
                    <input type="number" id="a" step="any" placeholder="Enter acceleration">
                </div>
                <div class="input-group">
                    <label for="t">Time (t) - s</label>
                    <input type="number" id="t" step="any" placeholder="Enter time">
                </div>
                <div class="input-group">
                    <label for="s">Displacement (s) - m</label>
                    <input type="number" id="s" step="any" placeholder="Enter displacement">
                </div>
                <button class="clear-btn" onclick="clearAll()">Clear All</button>
            </div>

            <div class="equations-section">
                <h2>Equations of Motion</h2>
                <div class="equation" id="eq1">v = u + at</div>
                <div class="equation" id="eq2">s = ut + ½at²</div>
                <div class="equation" id="eq3">v² = u² + 2as</div>
                <div class="equation" id="eq4">s = (u + v)t/2</div>
                <div class="equation" id="eq5">s = vt - ½at²</div>
            </div>

            <div class="graph-container">
                <h2>Motion Graphs</h2>
                <div class="graphs">
                    <div class="graph">
                        <h3>Displacement vs Time</h3>
                        <canvas id="displacementGraph" width="250" height="160"></canvas>
                    </div>
                    <div class="graph">
                        <h3>Velocity vs Time</h3>
                        <canvas id="velocityGraph" width="250" height="160"></canvas>
                    </div>
                    <div class="graph">
                        <h3>Acceleration vs Time</h3>
                        <canvas id="accelerationGraph" width="250" height="160"></canvas>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let values = { u: null, v: null, a: null, t: null, s: null };
        let calculated = new Set();
        let userEntered = new Set();
        let lastEntered = null;

        function updateStatus(message, type = 'info') {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = `status ${type}`;
        }

        function clearAll() {
            values = { u: null, v: null, a: null, t: null, s: null };
            calculated.clear();
            userEntered.clear();
            lastEntered = null;
            
            ['u', 'v', 'a', 't', 's'].forEach(id => {
                const input = document.getElementById(id);
                input.value = '';
                input.classList.remove('calculated', 'adjusted');
            });
            
            clearEquationHighlights();
            clearGraphs();
            updateStatus('Enter any values - the system will adjust others to find valid acceleration');
        }

        function clearEquationHighlights() {
            document.querySelectorAll('.equation').forEach(eq => eq.classList.remove('active'));
        }

        function highlightEquation(eqId) {
            clearEquationHighlights();
            document.getElementById(eqId).classList.add('active');
        }

        function isValidNumber(value) {
            return value !== null && value !== '' && !isNaN(value) && isFinite(value);
        }

        function countValidInputs() {
            return Object.values(values).filter(isValidNumber).length;
        }

        function solve() {
            const { u, v, a, t, s } = values;
            calculated.clear();

            // Clear previous styling
            ['u', 'v', 'a', 't', 's'].forEach(id => {
                document.getElementById(id).classList.remove('calculated', 'adjusted');
            });

            const validCount = countValidInputs();

            if (validCount === 0) {
                updateStatus('Enter any values - the system will adjust others to find valid acceleration', 'info');
                clearEquationHighlights();
                return;
            }

            if (validCount === 1 || validCount === 2) {
                updateStatus(`Enter ${3 - validCount} more value(s) to start calculations`, 'warning');
                clearEquationHighlights();
                return;
            }

            // If we have exactly 3 values, solve normally
            if (validCount === 3) {
                solveStandard();
                return;
            }

            // If we have 4+ values, use adaptive solving
            solveAdaptive();
        }

        function solveStandard() {
            const { u, v, a, t, s } = values;

            // Standard solving logic (same as before)
            if (isValidNumber(u) && isValidNumber(v) && isValidNumber(t)) {
                values.a = (v - u) / t;
                values.s = u * t + 0.5 * values.a * t * t;
                calculated.add('a').add('s');
                highlightEquation('eq1');
            }
            else if (isValidNumber(u) && isValidNumber(a) && isValidNumber(t)) {
                values.v = u + a * t;
                values.s = u * t + 0.5 * a * t * t;
                calculated.add('v').add('s');
                highlightEquation('eq2');
            }
            else if (isValidNumber(v) && isValidNumber(a) && isValidNumber(t)) {
                values.u = v - a * t;
                values.s = values.u * t + 0.5 * a * t * t;
                calculated.add('u').add('s');
                highlightEquation('eq1');
            }
            else if (isValidNumber(u) && isValidNumber(v) && isValidNumber(a)) {
                if (a !== 0) {
                    values.t = (v - u) / a;
                    values.s = (u + v) * values.t / 2;
                    calculated.add('t').add('s');
                    highlightEquation('eq3');
                }
            }
            else if (isValidNumber(u) && isValidNumber(v) && isValidNumber(s)) {
                if (u + v !== 0) {
                    values.t = 2 * s / (u + v);
                    values.a = (v - u) / values.t;
                    calculated.add('a').add('t');
                    highlightEquation('eq4');
                }
            }
            else if (isValidNumber(u) && isValidNumber(a) && isValidNumber(s)) {
                const discriminant = u * u + 2 * a * s;
                if (discriminant >= 0) {
                    values.v = Math.sqrt(discriminant);
                    if (a !== 0) {
                        values.t = (values.v - u) / a;
                        calculated.add('v').add('t');
                        highlightEquation('eq3');
                    }
                }
            }
            else if (isValidNumber(v) && isValidNumber(a) && isValidNumber(s)) {
                const discriminant = v * v - 2 * a * s;
                if (discriminant >= 0) {
                    values.u = Math.sqrt(discriminant);
                    if (a !== 0) {
                        values.t = (v - values.u) / a;
                        calculated.add('u').add('t');
                        highlightEquation('eq3');
                    }
                }
            }
            else if (isValidNumber(a) && isValidNumber(t) && isValidNumber(s)) {
                values.u = (s - 0.5 * a * t * t) / t;
                values.v = values.u + a * t;
                calculated.add('u').add('v');
                highlightEquation('eq2');
            }
            else if (isValidNumber(u) && isValidNumber(t) && isValidNumber(s)) {
                values.v = 2 * s / t - u;
                values.a = (values.v - u) / t;
                calculated.add('v').add('a');
                highlightEquation('eq4');
            }
            else if (isValidNumber(v) && isValidNumber(t) && isValidNumber(s)) {
                values.u = 2 * s / t - v;
                values.a = (v - values.u) / t;
                calculated.add('u').add('a');
                highlightEquation('eq4');
            }

            updateDisplay();
        }

        function solveAdaptive() {
            // Priority order: t (time), a (acceleration), u, v, s
            const priority = ['t', 'a', 'u', 'v', 's'];
            
            // Always keep the last entered value
            const toKeep = new Set([lastEntered]);
            
            // Add values by priority until we have 3
            for (const variable of priority) {
                if (toKeep.size >= 3) break;
                if (isValidNumber(values[variable]) && !toKeep.has(variable)) {
                    toKeep.add(variable);
                }
            }

            // Store the kept values
            const keptValues = {};
            const adjustedValues = new Set();
            
            for (const variable of toKeep) {
                keptValues[variable] = values[variable];
            }

            // Clear values not being kept
            for (const variable in values) {
                if (!toKeep.has(variable)) {
                    values[variable] = null;
                    adjustedValues.add(variable);
                }
            }

            // Restore kept values
            Object.assign(values, keptValues);

            // Now solve with the 3 kept values
            solveStandard();

            // Mark adjusted values
            for (const variable of adjustedValues) {
                if (calculated.has(variable)) {
                    const input = document.getElementById(variable);
                    input.classList.add('adjusted');
                }
            }

            const adjustedList = Array.from(adjustedValues).filter(v => calculated.has(v));
            if (adjustedList.length > 0) {
                updateStatus(`Kept ${lastEntered} and adjusted ${adjustedList.join(', ')} to maintain valid physics`, 'success');
            }
        }

        function updateDisplay() {
            // Update the input fields
            ['u', 'v', 'a', 't', 's'].forEach(id => {
                if (calculated.has(id)) {
                    const input = document.getElementById(id);
                    input.value = values[id].toFixed(3);
                    if (!input.classList.contains('adjusted')) {
                        input.classList.add('calculated');
                    }
                }
            });

            if (calculated.size > 0 && !document.querySelector('.status.success')) {
                updateStatus(`Calculated ${calculated.size} missing variables successfully`, 'success');
                drawGraphs();
            }
            
            if (calculated.size > 0) {
                drawGraphs();
            }
        }

        function drawGraphs() {
            if (!isValidNumber(values.t) || values.t <= 0) return;

            const timePoints = [];
            const displacements = [];
            const velocities = [];
            const accelerations = [];

            const maxTime = values.t;
            const steps = 50;

            for (let i = 0; i <= steps; i++) {
                const t = (i / steps) * maxTime;
                timePoints.push(t);
                
                const disp = values.u * t + 0.5 * values.a * t * t;
                const vel = values.u + values.a * t;
                const acc = values.a;
                
                displacements.push(disp);
                velocities.push(vel);
                accelerations.push(acc);
            }

            drawGraph('displacementGraph', timePoints, displacements, '#4CAF50');
            drawGraph('velocityGraph', timePoints, velocities, '#2196F3');
            drawGraph('accelerationGraph', timePoints, accelerations, '#FF9800');
        }

        function drawGraph(canvasId, xData, yData, color) {
            const canvas = document.getElementById(canvasId);
            const ctx = canvas.getContext('2d');
            
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            if (xData.length === 0 || yData.length === 0) return;

            const padding = 30;
            const width = canvas.width - 2 * padding;
            const height = canvas.height - 2 * padding;

            const xMin = Math.min(...xData);
            const xMax = Math.max(...xData);
            const yDataMin = Math.min(...yData);
            const yDataMax = Math.max(...yData);
            
            // Always ensure both positive and negative regions are visible
            const yAbsMax = Math.max(Math.abs(yDataMin), Math.abs(yDataMax), 1); // Minimum range of 1
            const yMin = -yAbsMax;
            const yMax = yAbsMax;

            // Draw axes
            ctx.strokeStyle = '#666';
            ctx.lineWidth = 1;
            ctx.beginPath();
            // Vertical axis
            ctx.moveTo(padding, padding);
            ctx.lineTo(padding, canvas.height - padding);
            // Horizontal axis
            ctx.moveTo(padding, canvas.height - padding);
            ctx.lineTo(canvas.width - padding, canvas.height - padding);
            // Zero line (horizontal)
            const zeroY = padding + ((0 - yMin) / (yMax - yMin || 1)) * height;
            ctx.moveTo(padding, zeroY);
            ctx.lineTo(canvas.width - padding, zeroY);
            ctx.stroke();

            // Draw grid
            ctx.strokeStyle = '#e0e0e0';
            ctx.lineWidth = 0.5;
            for (let i = 0; i <= 10; i++) {
                const x = padding + (i / 10) * width;
                const y = padding + (i / 10) * height;
                
                ctx.beginPath();
                ctx.moveTo(x, padding);
                ctx.lineTo(x, canvas.height - padding);
                ctx.stroke();
                
                ctx.beginPath();
                ctx.moveTo(padding, y);
                ctx.lineTo(canvas.width - padding, y);
                ctx.stroke();
            }

            // Draw data
            ctx.strokeStyle = color;
            ctx.lineWidth = 2;
            ctx.beginPath();

            for (let i = 0; i < xData.length; i++) {
                const x = padding + ((xData[i] - xMin) / (xMax - xMin || 1)) * width;
                const y = canvas.height - padding - ((yData[i] - yMin) / (yMax - yMin || 1)) * height;
                
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            }
            ctx.stroke();

            // Add labels
            ctx.fillStyle = '#333';
            ctx.font = '10px Arial';
            ctx.fillText(`0`, padding - 8, canvas.height - padding + 12);
            ctx.fillText(`${xMax.toFixed(1)}`, canvas.width - padding - 15, canvas.height - padding + 12);
            ctx.fillText(`${yMax.toFixed(1)}`, padding - 25, padding + 3);
            ctx.fillText(`${yMin.toFixed(1)}`, padding - 25, canvas.height - padding + 3);
        }

        function clearGraphs() {
            ['displacementGraph', 'velocityGraph', 'accelerationGraph'].forEach(id => {
                const canvas = document.getElementById(id);
                const ctx = canvas.getContext('2d');
                ctx.clearRect(0, 0, canvas.width, canvas.height);
            });
        }

        // Event listeners
        ['u', 'v', 'a', 't', 's'].forEach(id => {
            document.getElementById(id).addEventListener('input', function() {
                const value = parseFloat(this.value);
                const wasEmpty = values[id] === null;
                
                values[id] = isNaN(value) ? null : value;
                
                if (isValidNumber(values[id])) {
                    userEntered.add(id);
                    lastEntered = id;
                } else {
                    userEntered.delete(id);
                    if (lastEntered === id) {
                        // Find the most recent non-null entry
                        lastEntered = Array.from(userEntered).pop() || null;
                    }
                }
                
                solve();
            });
        });

        // Initialize
        updateStatus('Enter any values - the system will adjust others to find valid acceleration');
    </script>
</body>
</html>