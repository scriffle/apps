<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Voltage & Electrical Breakdown Simulator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            background: #1a1a2e;
            color: #eee;
            overflow: hidden;
        }
        
        #canvas {
            display: block;
            background: #0f0f1e;
            cursor: default;
            touch-action: none;
        }
        
        .controls {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(26, 26, 46, 0.95);
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #4a4a6a;
            max-width: 320px;
            pointer-events: auto;
            z-index: 100;
        }
        
        .controls.collapsed .control-content {
            display: none;
        }
        
        .controls-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            cursor: pointer;
        }
        
        .controls.collapsed .controls-header {
            margin-bottom: 0;
        }
        
        .collapse-btn {
            background: #4a4a6a;
            border: none;
            color: #66d9ff;
            width: 28px;
            height: 28px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1.2em;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s;
        }
        
        .collapse-btn:hover {
            background: #5a5a7a;
        }
        
        h2 {
            color: #66d9ff;
            margin-bottom: 0;
            font-size: 1.3em;
        }
        
        .control-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            color: #aaa;
            font-size: 0.95em;
        }
        
        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 5px;
            background: #2a2a4a;
            outline: none;
            -webkit-appearance: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: #66d9ff;
            cursor: pointer;
        }
        
        input[type="range"]::-moz-range-thumb {
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: #66d9ff;
            cursor: pointer;
            border: none;
        }
        
        .value-display {
            color: #66d9ff;
            font-weight: bold;
            font-size: 1.1em;
            margin-top: 5px;
        }
        
        .info {
            background: rgba(102, 217, 255, 0.1);
            padding: 12px;
            border-radius: 5px;
            font-size: 0.85em;
            line-height: 1.5;
            border-left: 3px solid #66d9ff;
            margin-top: 15px;
        }
        
        .stats-panel {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(26, 26, 46, 0.95);
            padding: 20px;
            border-radius: 10px;
            border: 2px solid #4a4a6a;
            min-width: 200px;
            pointer-events: auto;
            z-index: 100;
        }
        
        .pump-btn {
            background: #66d9ff;
            color: #1a1a2e;
            border: none;
            padding: 15px 20px;
            border-radius: 5px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            transition: all 0.3s;
            margin-bottom: 10px;
        }
        
        .pump-btn:hover {
            background: #88e5ff;
        }
        
        .pump-btn.active {
            background: #4dabf7;
        }
        
        .reset-btn {
            background: #ff6464;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 5px;
            font-size: 0.95em;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin-bottom: 15px;
            transition: all 0.3s;
        }
        
        .reset-btn:hover {
            background: #ff4444;
        }
        
        .stat-item {
            margin-bottom: 10px;
        }
        
        .stat-label {
            color: #aaa;
            font-size: 0.9em;
        }
        
        .stat-value {
            color: #66d9ff;
            font-size: 1.3em;
            font-weight: bold;
        }
        
        .stat-value.danger {
            color: #ff6464;
        }
        
        .breakdown-warning {
            background: rgba(255, 100, 100, 0.2);
            padding: 8px;
            border-radius: 5px;
            font-size: 0.85em;
            margin-top: 10px;
        }
        
        .legend {
            position: absolute;
            bottom: 20px;
            left: 20px;
            background: rgba(26, 26, 46, 0.9);
            padding: 15px;
            border-radius: 10px;
            border: 2px solid #4a4a6a;
            pointer-events: auto;
            z-index: 100;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            margin: 8px 0;
            font-size: 0.9em;
        }
        
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 10px;
            border: 2px solid #333;
        }
        
        .legend-line {
            width: 20px;
            height: 4px;
            margin-right: 10px;
        }
    </style>
</head>
<body>
    <canvas id="canvas"></canvas>
    
    <div class="controls" id="controls">
        <div class="controls-header" onclick="toggleCollapse()">
            <h2>‚ö° Voltage Simulator</h2>
            <button class="collapse-btn" id="collapseBtn">‚àí</button>
        </div>
        
        <div class="control-content">
            <div class="control-group">
                <label for="temperature">Temperature (Brownian motion)</label>
                <input type="range" id="temperature" min="1" max="1000" value="300" step="1">
                <div class="value-display" id="tempDisplay">300¬∞C</div>
            </div>
            
            <div class="control-group">
                <label for="separation">Plate Separation</label>
                <input type="range" id="separation" min="150" max="500" value="300" step="10">
                <div class="value-display" id="sepDisplay">300 pixels (3.0m scale)</div>
            </div>
            
            <div class="info">
                <strong>üí° How it works:</strong><br>
                ‚Ä¢ Pump moves electrons from + to ‚àí plate<br>
                ‚Ä¢ More electrons = more work required<br>
                ‚Ä¢ Voltage increases with charge & distance<br>
                ‚Ä¢ Spark occurs at breakdown voltage<br>
                ‚Ä¢ Closer plates = lower spark voltage
            </div>
        </div>
    </div>
    
    <div class="stats-panel">
        <button class="pump-btn" id="pumpBtn" onmousedown="startPump()" onmouseup="stopPump()" onmouseleave="stopPump()" ontouchstart="startPump()" ontouchend="stopPump()">
            üîå PUMP ELECTRONS
        </button>
        
        <button class="reset-btn" onclick="resetSimulation()">üîÑ RESET</button>
        
        <div style="border-top: 2px solid #4a4a6a; padding-top: 15px;">
            <div class="stat-item">
                <span class="stat-label">Electrons:</span>
                <div class="stat-value" id="electronCount">0</div>
            </div>
            
            <div class="stat-item">
                <span class="stat-label">Work Done:</span>
                <div class="stat-value" id="workDisplay">0.0 J</div>
            </div>
            
            <div class="stat-item">
                <span class="stat-label">Voltage:</span>
                <div class="stat-value" id="voltageDisplay">0.0 V</div>
            </div>
            
            <div class="breakdown-warning">
                <strong>‚ö†Ô∏è Breakdown:</strong> <span id="breakdownDisplay">360 V</span>
            </div>
        </div>
    </div>
    
    <div class="legend">
        <div class="legend-item">
            <div class="legend-color" style="background: #4dabf7;"></div>
            <span>Electrons (e‚Åª)</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #ff9640;"></div>
            <span>Positive holes (fixed)</span>
        </div>
        <div class="legend-item">
            <div class="legend-line" style="background: #66d9ff;"></div>
            <span>Electric field lines</span>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        
        let temperature = 300;
        let separation = 300;
        let isPumping = false;
        
        const sim = {
            leftPlate: { x: 0, y: 0, width: 40, height: 400, electrons: [] },
            rightPlate: { x: 0, y: 0, width: 40, height: 400, holes: [] },
            wire: [],
            totalWork: 0,
            electronCount: 0,
            sparking: false,
            sparkProgress: 0,
            sparkPath: []
        };
        
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            
            // Update plate positions
            sim.leftPlate.x = canvas.width / 2 - separation / 2 - 20;
            sim.rightPlate.x = canvas.width / 2 + separation / 2 - 20;
            sim.leftPlate.y = canvas.height / 2 - 200;
            sim.rightPlate.y = canvas.height / 2 - 200;
            
            initializePlates();
        }
        
        function initializePlates() {
            // Create fixed positive charges (holes) in right plate
            sim.rightPlate.holes = [];
            const holeSpacing = 25;
            const rows = Math.floor(sim.rightPlate.height / holeSpacing);
            const cols = Math.floor(sim.rightPlate.width / holeSpacing);
            
            for (let row = 0; row < rows; row++) {
                for (let col = 0; col < cols; col++) {
                    sim.rightPlate.holes.push({
                        x: sim.rightPlate.x + col * holeSpacing + holeSpacing / 2,
                        y: sim.rightPlate.y + row * holeSpacing + holeSpacing / 2
                    });
                }
            }
        }
        
        function addElectron() {
            if (sim.sparking) return;
            
            // Calculate work required (increases with each electron)
            const existingCharge = sim.leftPlate.electrons.length;
            const workRequired = 0.5 + existingCharge * 0.3;
            sim.totalWork += workRequired;
            sim.electronCount++;
            
            // Start electron at right plate
            const wireElectron = {
                x: sim.rightPlate.x + sim.rightPlate.width / 2,
                y: sim.rightPlate.y + Math.random() * sim.rightPlate.height,
                vx: 0,
                vy: 0,
                inWire: true,
                progress: 0
            };
            
            sim.wire.push(wireElectron);
        }
        
        function updateElectrons() {
            const brownianIntensity = Math.sqrt(temperature) * 0.02;
            
            // Update wire electrons
            sim.wire = sim.wire.filter(e => {
                e.progress += 0.02;
                
                if (e.progress >= 1) {
                    // Electron reaches left plate
                    const newElectron = {
                        x: sim.leftPlate.x + sim.leftPlate.width / 2,
                        y: sim.leftPlate.y + Math.random() * sim.leftPlate.height,
                        vx: 0,
                        vy: 0,
                        radius: 5
                    };
                    sim.leftPlate.electrons.push(newElectron);
                    return false;
                }
                
                // Move along wire path
                const startX = sim.rightPlate.x + sim.rightPlate.width / 2;
                const startY = e.y;
                const topY = sim.rightPlate.y - 80;
                const leftX = sim.leftPlate.x + sim.leftPlate.width / 2;
                const endY = e.y;
                
                if (e.progress < 0.33) {
                    const p = e.progress / 0.33;
                    e.x = startX;
                    e.y = startY + (topY - startY) * p;
                } else if (e.progress < 0.66) {
                    const p = (e.progress - 0.33) / 0.33;
                    e.x = startX + (leftX - startX) * p;
                    e.y = topY;
                } else {
                    const p = (e.progress - 0.66) / 0.34;
                    e.x = leftX;
                    e.y = topY + (endY - topY) * p;
                }
                
                return true;
            });
            
            // Update electrons on left plate with Coulomb repulsion
            sim.leftPlate.electrons.forEach((e, i) => {
                // Brownian motion
                e.vx += (Math.random() - 0.5) * brownianIntensity;
                e.vy += (Math.random() - 0.5) * brownianIntensity;
                
                // Electron-electron repulsion (Coulomb's law)
                sim.leftPlate.electrons.forEach((other, j) => {
                    if (i === j) return;
                    
                    const dx = e.x - other.x;
                    const dy = e.y - other.y;
                    const distSq = dx * dx + dy * dy;
                    const dist = Math.sqrt(distSq);
                    
                    if (dist > 0 && dist < 100) {
                        const force = 400 / (distSq + 50);
                        e.vx += (dx / dist) * force;
                        e.vy += (dy / dist) * force;
                    }
                });
                
                // Keep electrons within plate bounds
                const margin = 5;
                if (e.x < sim.leftPlate.x + margin) {
                    e.x = sim.leftPlate.x + margin;
                    e.vx = Math.abs(e.vx) * 0.5;
                }
                if (e.x > sim.leftPlate.x + sim.leftPlate.width - margin) {
                    e.x = sim.leftPlate.x + sim.leftPlate.width - margin;
                    e.vx = -Math.abs(e.vx) * 0.5;
                }
                if (e.y < sim.leftPlate.y + margin) {
                    e.y = sim.leftPlate.y + margin;
                    e.vy = Math.abs(e.vy) * 0.5;
                }
                if (e.y > sim.leftPlate.y + sim.leftPlate.height - margin) {
                    e.y = sim.leftPlate.y + sim.leftPlate.height - margin;
                    e.vy = -Math.abs(e.vy) * 0.5;
                }
                
                // Apply damping
                e.vx *= 0.9;
                e.vy *= 0.9;
                
                // Update position
                e.x += e.vx;
                e.y += e.vy;
            });
        }
        
        function calculateVoltage() {
            const charge = sim.leftPlate.electrons.length;
            const distance = separation / 100;
            
            // Voltage increases with charge and distance
            const voltage = charge * distance * 8;
            
            return voltage;
        }
        
        function checkBreakdown() {
            const voltage = calculateVoltage();
            const distance = separation / 100;
            
            // Breakdown field strength for air (scaled for simulation)
            const breakdownVoltage = distance * 120;
            
            return voltage >= breakdownVoltage;
        }
        
        function createSpark() {
            if (sim.leftPlate.electrons.length === 0) return;
            
            sim.sparking = true;
            sim.sparkProgress = 0;
            
            // Calculate center of mass for electrons
            let electronCenterX = 0, electronCenterY = 0;
            sim.leftPlate.electrons.forEach(e => {
                electronCenterX += e.x;
                electronCenterY += e.y;
            });
            electronCenterX /= sim.leftPlate.electrons.length;
            electronCenterY /= sim.leftPlate.electrons.length;
            
            // Calculate center of mass for holes
            let holeCenterX = 0, holeCenterY = 0;
            sim.rightPlate.holes.forEach(h => {
                holeCenterX += h.x;
                holeCenterY += h.y;
            });
            holeCenterX /= sim.rightPlate.holes.length;
            holeCenterY /= sim.rightPlate.holes.length;
            
            // Create jagged spark path
            sim.sparkPath = [];
            const steps = 20;
            for (let i = 0; i <= steps; i++) {
                const t = i / steps;
                const baseX = electronCenterX + (holeCenterX - electronCenterX) * t;
                const baseY = electronCenterY + (holeCenterY - electronCenterY) * t;
                
                const jitter = (Math.random() - 0.5) * 30;
                sim.sparkPath.push({
                    x: baseX + jitter,
                    y: baseY + jitter * 0.5
                });
            }
        }
        
        function updateSpark() {
            if (!sim.sparking) return;
            
            sim.sparkProgress += 0.05;
            
            if (sim.sparkProgress >= 1.2) {
                // Spark complete - discharge
                sim.sparking = false;
                sim.leftPlate.electrons = [];
                sim.wire = [];
                sim.totalWork = 0;
                sim.electronCount = 0;
            }
        }
        
        function draw() {
            ctx.fillStyle = '#0f0f1e';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            const voltage = calculateVoltage();
            const breakdownVoltage = (separation / 100) * 120;
            
            // Draw electric field lines if there are electrons
            if (sim.leftPlate.electrons.length > 0) {
                const fieldIntensity = Math.min(voltage / breakdownVoltage, 1);
                ctx.strokeStyle = `rgba(100, 200, 255, ${0.2 + fieldIntensity * 0.3})`;
                ctx.lineWidth = 2;
                
                const numLines = 8;
                for (let i = 0; i < numLines; i++) {
                    const y = sim.leftPlate.y + (i + 1) * (sim.leftPlate.height / (numLines + 1));
                    
                    ctx.beginPath();
                    ctx.moveTo(sim.leftPlate.x + sim.leftPlate.width, y);
                    ctx.lineTo(sim.rightPlate.x, y);
                    ctx.stroke();
                    
                    // Arrow
                    ctx.beginPath();
                    ctx.moveTo(sim.rightPlate.x - 10, y - 5);
                    ctx.lineTo(sim.rightPlate.x, y);
                    ctx.lineTo(sim.rightPlate.x - 10, y + 5);
                    ctx.stroke();
                }
            }
            
            // Draw wire path
            ctx.strokeStyle = '#888';
            ctx.lineWidth = 3;
            ctx.beginPath();
            const wireY = sim.rightPlate.y - 80;
            ctx.moveTo(sim.rightPlate.x + sim.rightPlate.width / 2, sim.rightPlate.y);
            ctx.lineTo(sim.rightPlate.x + sim.rightPlate.width / 2, wireY);
            ctx.lineTo(sim.leftPlate.x + sim.leftPlate.width / 2, wireY);
            ctx.lineTo(sim.leftPlate.x + sim.leftPlate.width / 2, sim.leftPlate.y);
            ctx.stroke();
            
            // Draw left plate (negative)
            const electronDensity = sim.leftPlate.electrons.length / 50;
            const blueTint = Math.min(100 + electronDensity * 30, 200);
            ctx.fillStyle = `rgb(50, 50, ${blueTint})`;
            ctx.fillRect(sim.leftPlate.x, sim.leftPlate.y, sim.leftPlate.width, sim.leftPlate.height);
            ctx.strokeStyle = '#4dabf7';
            ctx.lineWidth = 3;
            ctx.strokeRect(sim.leftPlate.x, sim.leftPlate.y, sim.leftPlate.width, sim.leftPlate.height);
            
            // Draw right plate (positive)
            const redTint = Math.min(100 + electronDensity * 30, 200);
            ctx.fillStyle = `rgb(${redTint}, 50, 50)`;
            ctx.fillRect(sim.rightPlate.x, sim.rightPlate.y, sim.rightPlate.width, sim.rightPlate.height);
            ctx.strokeStyle = '#ff6464';
            ctx.lineWidth = 3;
            ctx.strokeRect(sim.rightPlate.x, sim.rightPlate.y, sim.rightPlate.width, sim.rightPlate.height);
            
            // Draw holes (positive charges) in right plate
            ctx.fillStyle = '#ff9640';
            ctx.strokeStyle = '#ffb366';
            ctx.lineWidth = 1.5;
            ctx.font = 'bold 12px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';
            
            sim.rightPlate.holes.forEach(hole => {
                ctx.beginPath();
                ctx.arc(hole.x, hole.y, 6, 0, Math.PI * 2);
                ctx.fill();
                ctx.stroke();
                
                ctx.fillStyle = '#fff';
                ctx.fillText('+', hole.x, hole.y);
                ctx.fillStyle = '#ff9640';
            });
            
            // Draw electrons in wire
            sim.wire.forEach(e => {
                const gradient = ctx.createRadialGradient(e.x, e.y, 0, e.x, e.y, 10);
                gradient.addColorStop(0, '#4dabf7');
                gradient.addColorStop(0.5, 'rgba(77, 171, 247, 0.5)');
                gradient.addColorStop(1, 'rgba(77, 171, 247, 0)');
                
                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.arc(e.x, e.y, 10, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.fillStyle = '#4dabf7';
                ctx.beginPath();
                ctx.arc(e.x, e.y, 5, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.fillStyle = '#0f0f1e';
                ctx.font = 'bold 10px Arial';
                ctx.fillText('‚àí', e.x, e.y);
            });
            
            // Draw electrons on left plate
            sim.leftPlate.electrons.forEach(e => {
                const gradient = ctx.createRadialGradient(e.x, e.y, 0, e.x, e.y, e.radius * 2);
                gradient.addColorStop(0, '#4dabf7');
                gradient.addColorStop(0.5, 'rgba(77, 171, 247, 0.5)');
                gradient.addColorStop(1, 'rgba(77, 171, 247, 0)');
                
                ctx.fillStyle = gradient;
                ctx.beginPath();
                ctx.arc(e.x, e.y, e.radius * 2, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.fillStyle = '#4dabf7';
                ctx.beginPath();
                ctx.arc(e.x, e.y, e.radius, 0, Math.PI * 2);
                ctx.fill();
                
                ctx.fillStyle = '#0f0f1e';
                ctx.font = 'bold 10px Arial';
                ctx.textAlign = 'center';
                ctx.textBaseline = 'middle';
                ctx.fillText('‚àí', e.x, e.y);
            });
            
            // Draw spark
            if (sim.sparking && sim.sparkProgress < 1) {
                const visiblePoints = Math.floor(sim.sparkPath.length * sim.sparkProgress);
                
                // Main spark bolt
                ctx.strokeStyle = '#ffffff';
                ctx.lineWidth = 4;
                ctx.shadowBlur = 20;
                ctx.shadowColor = '#66d9ff';
                
                ctx.beginPath();
                for (let i = 0; i < visiblePoints; i++) {
                    const p = sim.sparkPath[i];
                    if (i === 0) ctx.moveTo(p.x, p.y);
                    else ctx.lineTo(p.x, p.y);
                }
                ctx.stroke();
                
                // Glow
                ctx.strokeStyle = '#66d9ff';
                ctx.lineWidth = 8;
                ctx.globalAlpha = 0.5;
                ctx.beginPath();
                for (let i = 0; i < visiblePoints; i++) {
                    const p = sim.sparkPath[i];
                    if (i === 0) ctx.moveTo(p.x, p.y);
                    else ctx.lineTo(p.x, p.y);
                }
                ctx.stroke();
                
                ctx.shadowBlur = 0;
                ctx.globalAlpha = 1;
            }
            
            // Draw plate labels
            ctx.fillStyle = '#fff';
            ctx.font = 'bold 16px Arial';
            ctx.textAlign = 'center';
            
            ctx.fillText('‚àí', sim.leftPlate.x + sim.leftPlate.width / 2, sim.leftPlate.y - 20);
            ctx.fillText('NEGATIVE', sim.leftPlate.x + sim.leftPlate.width / 2, sim.leftPlate.y + sim.leftPlate.height + 25);
            
            ctx.fillText('+', sim.rightPlate.x + sim.rightPlate.width / 2, sim.rightPlate.y - 20);
            ctx.fillText('POSITIVE', sim.rightPlate.x + sim.rightPlate.width / 2, sim.rightPlate.y + sim.rightPlate.height + 25);
            
            // Update stats display
            updateStatsDisplay();
        }
        
        function updateStatsDisplay() {
            const voltage = calculateVoltage();
            const breakdownVoltage = (separation / 100) * 120;
            
            document.getElementById('electronCount').textContent = sim.electronCount;
            document.getElementById('workDisplay').textContent = sim.totalWork.toFixed(1) + ' J';
            document.getElementById('voltageDisplay').textContent = voltage.toFixed(1) + ' V';
            document.getElementById('breakdownDisplay').textContent = breakdownVoltage.toFixed(0) + ' V';
            
            const voltageEl = document.getElementById('voltageDisplay');
            if (voltage > breakdownVoltage * 0.9) {
                voltageEl.classList.add('danger');
            } else {
                voltageEl.classList.remove('danger');
            }
        }
        
        function animate() {
            if (isPumping && !sim.sparking) {
                addElectron();
            }
            
            updateElectrons();
            updateSpark();
            
            if (checkBreakdown() && !sim.sparking) {
                createSpark();
            }
            
            draw();
            requestAnimationFrame(animate);
        }
        
        function startPump() {
            isPumping = true;
            document.getElementById('pumpBtn').classList.add('active');
            document.getElementById('pumpBtn').textContent = '‚ö° PUMPING...';
        }
        
        function stopPump() {
            isPumping = false;
            document.getElementById('pumpBtn').classList.remove('active');
            document.getElementById('pumpBtn').textContent = 'üîå PUMP ELECTRONS';
        }
        
        function resetSimulation() {
            sim.leftPlate.electrons = [];
            sim.wire = [];
            sim.totalWork = 0;
            sim.electronCount = 0;
            sim.sparking = false;
        }
        
        function toggleCollapse() {
            const controls = document.getElementById('controls');
            const btn = document.getElementById('collapseBtn');
            controls.classList.toggle('collapsed');
            btn.textContent = controls.classList.contains('collapsed') ? '+' : '‚àí';
        }
        
        // Event listeners
        document.getElementById('temperature').addEventListener('input', (e) => {
            temperature = parseInt(e.target.value);
            document.getElementById('tempDisplay').textContent = temperature + '¬∞C';
        });
        
        document.getElementById('separation').addEventListener('input', (e) => {
            separation = parseInt(e.target.value);
            document.getElementById('sepDisplay').textContent = separation + ' pixels (' + (separation / 100).toFixed(1) + 'm scale)';
            resizeCanvas();
        });
        
        window.addEventListener('resize', resizeCanvas);
        
        // Initialize
        resizeCanvas();
        animate();
    </script>
</body>
</html>