<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>You Shall Not Die</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            background: linear-gradient(135deg, #1a1a1a 0%, #363636 100%);
            color: #fff;
        }
        .container {
            background: rgba(255, 255, 255, 0.1);
            padding: 2rem;
            border-radius: 1rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3);
            text-align: center;
            min-width: 400px;
            backdrop-filter: blur(10px);
        }
        h2 {
            margin: 0 0 1.5rem 0;
            font-size: 2rem;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: #ffffff;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
        }
        .names {
            font-size: 2rem;
            margin: 1.5rem 0;
            min-height: 4rem;
            line-height: 1.5;
            color: #ffffff;
        }
        .culture {
            color: #cccccc;
            font-style: italic;
            margin-bottom: 1.5rem;
        }
        .controls {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 1rem;
            align-items: center;
            flex-wrap: wrap;
        }
        .control-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            background: rgba(255, 255, 255, 0.1);
            padding: 0.5rem 1rem;
            border-radius: 1rem;
        }
        .switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }
        .switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.2);
            transition: .4s;
            border-radius: 30px;
        }
        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .slider {
            background-color: #4CAF50;
        }
        input:checked + .slider:before {
            transform: translateX(30px);
        }
        .switch-label {
            font-size: 0.9rem;
            color: #fff;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        button {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 0.5rem;
            cursor: pointer;
            padding: 0.7rem 1.2rem;
            font-size: 1rem;
            transition: all 0.3s ease;
            min-width: 100px;
        }
        button:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }
        button:active {
            transform: translateY(0);
        }
        button.active {
            background: rgba(255, 255, 255, 0.3);
        }
        .stats {
            font-size: 0.8rem;
            color: #999;
            margin-top: 1rem;
        }
        .voice-status {
            color: #999;
            margin: 1rem 0;
            font-size: 0.9rem;
            font-style: italic;
        }
        #initVoiceButton {
            background: #4CAF50;
            margin-bottom: 1rem;
        }
        #initVoiceButton:hover {
            background: #45a049;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>You Shall Not Die</h2>
        <div class="names" id="nameDisplay"></div>
        <div class="culture" id="cultureDisplay"></div>
        <div class="voice-status" id="voiceStatus">Click Initialize Voice to begin speaking</div>
        <div class="stats" id="statsDisplay"></div>
        <div class="controls">
            <button id="initVoiceButton">Initialize Voice</button>
            <button id="toggleButton">Pause</button>
            <div class="control-group">
                <span class="switch-label">Slow</span>
                <label class="switch">
                    <input type="checkbox" id="speedToggle">
                    <span class="slider"></span>
                </label>
                <span class="switch-label">Fast</span>
            </div>
            <div class="control-group">
                <span class="switch-label">Random</span>
                <label class="switch">
                    <input type="checkbox" id="weightedToggle">
                    <span class="slider"></span>
                </label>
                <span class="switch-label">Weighted</span>
            </div>
            <button id="speakButton">Speak</button>
        </div>
    </div>

    <script>
        const namesDatabase = {
            indo_european: {
                metadata: {
                    family: "Indo-European",
                    population_percentage: 46,
                    writing_systems: ["Latin", "Cyrillic", "Devanagari", "Bengali", "Greek"],
                    major_languages: ["English", "Hindi", "Spanish", "Portuguese", "Russian", "Bengali", "Persian"],
                    name_order: "given_name_first",
                    preferred_voices: ["en-US", "hi-IN", "es-ES", "pt-PT", "ru-RU"]
                },
                male_names: [
                    "Alexander", "Mohammed", "James", "John", "William", "Raj", "Michael",
                    "David", "Robert", "Joseph", "Daniel", "Ivan", "Dmitri", "Vladimir",
                    "Mohammad", "Ali", "Reza", "Amit", "Rahul", "Rajesh", "Carlos",
                    "Juan", "Antonio", "José", "Miguel", "Pedro", "Francisco", "Manuel",
                    "Sergei", "Andrei", "Pavel", "Viktor", "Nikolai", "Boris", "Arjun",
                    "Arun", "Vijay", "Rajiv", "Suresh", "Alessandro", "Marco", "Giuseppe",
                    "Giovanni", "Pierre", "Jean", "Louis", "François", "Hans", "Heinrich",
                    "Wilhelm", "Thomas"
                ],
                female_names: [
                    "Maria", "Anna", "Sofia", "Emma", "Elena", "Olga", "Tatiana",
                    "Irina", "Svetlana", "Ekaterina", "Ana", "Isabella", "Victoria",
                    "Priya", "Anjali", "Deepa", "Sunita", "Anita", "Laura", "Carmen",
                    "Isabel", "Patricia", "Marie", "Catherine", "Elizabeth", "Sarah",
                    "Emily", "Olivia", "Ava", "Charlotte", "Sophia", "Amelia", "Pooja",
                    "Neha", "Divya", "Ritu", "Aisha", "Fatima", "Maryam", "Zahra",
                    "Chiara", "Francesca", "Giulia", "Martina", "Alice", "Julie",
                    "Louise", "Sophie", "Anna-Maria", "Helga"
                ],
                family_names: [
                    "Smith", "Johnson", "Williams", "Brown", "Jones", "Garcia", "Miller",
                    "Davis", "Rodriguez", "Martinez", "Hernandez", "Lopez", "Gonzalez",
                    "Wilson", "Anderson", "Thomas", "Taylor", "Moore", "Jackson", "Martin",
                    "Lee", "Perez", "Thompson", "White", "Harris", "Sanchez", "Clark",
                    "Ramirez", "Lewis", "Robinson", "Walker", "Young", "Allen", "King",
                    "Wright", "Scott", "Torres", "Nguyen", "Hill", "Flores", "Green",
                    "Adams", "Nelson", "Baker", "Hall", "Rivera", "Campbell", "Mitchell",
                    "Carter", "Roberts", "Ivanov", "Petrov", "Smirnov", "Kuznetsov", 
                    "Popov", "Sokolov", "Lebedev", "Kozlov", "Novikov", "Morozov",
                    "Volkov", "Kowalski", "Wiśniewski", "Dąbrowski", "Lewandowski",
                    "Wójcik", "Kamiński", "Kowalczyk", "Zieliński", "Szymański",
                    "Kumar", "Singh", "Patel", "Shah", "Sharma", "Verma", "Gupta",
                    "Rossi", "Russo", "Ferrari", "Esposito", "Bianchi", "Romano",
                    "Colombo", "Bernard", "Robert", "Richard", "Dubois", "Thomas",
                    "Petit", "Müller", "Schmidt", "Schneider", "Fischer", "Weber",
                    "Meyer", "Wagner", "Becker", "Schulz", "Hoffmann", "Schäfer",
                    "Koch", "Bauer", "Richter", "Klein", "Wolf", "Schröder"
                ]
            },
            sino_tibetan: {
                metadata: {
                    family: "Sino-Tibetan",
                    population_percentage: 20,
                    writing_systems: ["Chinese Characters", "Latin", "Tibetan"],
                    major_languages: ["Mandarin", "Wu", "Cantonese", "Min", "Tibetan"],
                    name_order: "family_name_first",
                    preferred_voices: ["zh-CN", "zh-TW", "zh-HK", "zh"]
                },
                male_names: [
                    "Wei", "Ming", "Jun", "Hao", "Yi", "Jian", "Lei", "Gang", "Xiong", "Tao",
                    "Cheng", "Feng", "Hong", "Long", "Ping", "Ting", "Wen", "Xiang", "Yang", "Zhi",
                    "Bin", "De", "Fu", "Guo", "Hui", "Jing", "Kai", "Li", "Nan", "Peng",
                    "Qiang", "Rui", "Sheng", "Tian", "Wei", "Xin", "Yong", "Zheng", "Bo", "Chang",
                    "Dong", "En", "Fei", "Guang", "Han", "Jin", "Kang", "Liang", "Min", "Ning"
                ],
                female_names: [
                    "Xia", "Ying", "Mei", "Lan", "Hui", "Xue", "Juan", "Yan", "Qing", "Na",
                    "Hong", "Lin", "Zhen", "Yue", "Jing", "Hua", "Xin", "Yu", "Feng", "Li",
                    "Ming", "Ping", "Qi", "Rong", "Shan", "Ting", "Wei", "Xiang", "Yi", "Zhi",
                    "Ai", "Bao", "Chen", "Dan", "E", "Fang", "Guo", "Han", "Juan", "Kun",
                    "Lei", "Min", "Ning", "Ou", "Pei", "Qian", "Ru", "Shu", "Tao", "Wen"
                ],
                family_names: [
                    "Wang", "Li", "Zhang", "Liu", "Chen", "Yang", "Huang", "Zhao", "Wu", "Zhou",
                    "Xu", "Sun", "Ma", "Zhu", "Hu", "Guo", "He", "Gao", "Lin", "Luo",
                    "Zheng", "Liang", "Xie", "Song", "Tang", "Xu", "Han", "Feng", "Deng", "Cao",
                    "Peng", "Zeng", "Xiao", "Tian", "Dong", "Pan", "Yuan", "Cai", "Jiang", "Yu",
                    "Du", "Ye", "Cheng", "Su", "Wei", "Lv", "Ding", "Ren", "Yao", "Shen",
                    "Zhong", "Jiang", "Cui", "Zheng", "He", "Xu", "Fan", "Shi", "Jin", "Wei",
                    "Feng", "Deng", "Cao", "Peng", "Zeng", "Xiao", "Tian", "Dong", "Pan", "Yuan",
                    "Lu", "Mao", "Qian", "Dai", "Fu", "Kong", "Bai", "Hao", "Yan", "Shi",
                    "Qin", "Zou", "Xiong", "Cui", "Tao", "Lu", "Mao", "Qian", "Dai", "Fu",
                    "Jia", "Xue", "Lei", "Fang", "Chang", "Hou", "Gu", "Yan", "Han", "Qiu"
                ]
            },
austronesian: {
    metadata: {
        family: "Austronesian",
        population_percentage: 5,
        writing_systems: ["Latin", "Arabic"],
        major_languages: ["Indonesian", "Malay", "Javanese", "Tagalog", "Filipino"],
        name_order: "given_name_first",
        preferred_voices: ["id-ID", "ms-MY", "fil-PH"]
    },
    male_names: [
        "Muhammad", "Ahmad", "Suharto", "Bambang", "Dimas", "Eko", "Firman", "Gede", "Hendra", "Irwan",
        "Juan", "Kevin", "Luis", "Marco", "Nilo", "Oscar", "Pedro", "Renzo", "Santiago", "Carlos",
        "Putra", "Rizki", "Satria", "Taufik", "Umar", "Wahyu", "Yusuf", "Zain", "Aditya", "Bayu",
        "Carlo", "David", "Eduardo", "Fernando", "Gabriel", "Henry", "Ivan", "Jose", "Kenneth", "Lorenzo",
        "Made", "Nyoman", "Oka", "Putu", "Qadir", "Rahmat", "Surya", "Tulus", "Utama", "Vino"
    ],
    female_names: [
        "Siti", "Ani", "Dewi", "Fitri", "Indah", "Kartini", "Linda", "Maria", "Nina", "Putri",
        "Ana", "Belle", "Clara", "Diana", "Elena", "Faith", "Grace", "Hannah", "Isabel", "Jane",
        "Ratna", "Sri", "Tari", "Utami", "Vina", "Wati", "Yani", "Zahra", "Ayu", "Bunga",
        "Catherine", "Dian", "Esti", "Fara", "Gita", "Hani", "Ika", "Julia", "Karina", "Lisa",
        "Maya", "Nadia", "Olivia", "Paula", "Queen", "Rosa", "Sarah", "Tina", "Uma", "Vita"
    ],
    family_names: [
        "Tan", "Lee", "Wong", "Lim", "Ng", "Chen", "Yang", "Cruz", "Santos", "Reyes",
        "Garcia", "Torres", "Lopez", "Perez", "Ramirez", "Flores", "Rivera", "Aquino", "Ramos", "Castro",
        "Sukarno", "Suharto", "Widodo", "Kusuma", "Wijaya", "Setiawan", "Hidayat", "Santoso", "Susanto", "Hermawan",
        "De Guzman", "Del Rosario", "Fernandez", "Gonzales", "Martinez", "Rodriguez", "Sanchez", "Villanueva", "Dela Cruz", "Mendoza",
        "Abdullah", "Ibrahim", "Hassan", "Ali", "Rahman", "Shah", "Khan", "Ahmad", "Ismail", "Mohamed",
        "Lim", "Tan", "Wong", "Lee", "Ng", "Goh", "Ong", "Koh", "Teo", "Chua",
        "bin Said", "bin Abdullah", "bin Ahmad", "bin Hassan", "bin Ibrahim", "binti Ali", "binti Rahman", "binti Shah", "binti Khan", "binti Ismail",
        "Wijaya", "Sanjaya", "Irawan", "Gunawan", "Kusuma", "Putra", "Pratama", "Saputra", "Nugraha", "Wicaksono",
        "dela Torre", "del Mundo", "delos Santos", "delos Reyes", "San Jose", "San Juan", "Santa Maria", "Santa Ana", "Santa Rosa", "San Pedro",
        "Suryanto", "Hartono", "Sutanto", "Wirawan", "Budiman", "Suherman", "Tjandra", "Winata", "Hadijaya", "Tanuwijaya"
    ]
},
arabic: {
    metadata: {
        family: "Arabic/Afroasiatic",
        population_percentage: 5,
        writing_systems: ["Arabic", "Latin"],
        major_languages: ["Arabic", "Hebrew", "Amharic", "Hausa"],
        name_order: "given_name_first",
        preferred_voices: ["ar-SA", "ar-EG", "ar-AE", "he-IL"]
    },
    male_names: [
        "Mohammed", "Ahmad", "Ali", "Hassan", "Hussein", "Ibrahim", "Yusuf", "Omar", "Khalid", "Mahmoud",
        "Abdullah", "Abdulrahman", "Saeed", "Mustafa", "Abdulaziz", "Nasser", "Salah", "Hamza", "Zaid", "Waleed",
        "Tariq", "Bilal", "Jamal", "Karim", "Rashid", "Sami", "Talal", "Yousef", "Zakariya", "Badr",
        "Fahad", "Hani", "Idris", "Jamil", "Kareem", "Lutfi", "Malik", "Nabil", "Osama", "Qasim",
        "Rami", "Samir", "Tamer", "Umar", "Wael", "Yasir", "Ziyad", "Adel", "Bassam", "Faisal"
    ],
    female_names: [
        "Fatima", "Aisha", "Maryam", "Zaynab", "Khadija", "Noor", "Amira", "Layla", "Hana", "Sara",
        "Reem", "Noura", "Asma", "Dina", "Eman", "Farah", "Ghada", "Hala", "Iman", "Jasmine",
        "Karima", "Leila", "Manal", "Nada", "Omnia", "Rania", "Safiya", "Tahira", "Uma", "Wafa",
        "Abeer", "Basma", "Dalal", "Esraa", "Fadwa", "Ghalia", "Heba", "Ibtisam", "Jamila", "Kawther",
        "Lubna", "Maha", "Najat", "Omaima", "Perihan", "Qismah", "Rasha", "Samira", "Tahani", "Zainab"
    ],
    family_names: [
        "Al-Sayed", "Al-Hassan", "Al-Ahmed", "Al-Ali", "Al-Mohammed", "Al-Ibrahim", "Al-Abdullah", "Al-Rahman", "Al-Khalil", "Al-Mansour",
        "El-Din", "El-Sayed", "El-Masri", "El-Sherif", "El-Khoury", "El-Amin", "El-Husseini", "El-Hadad", "El-Saeed", "El-Najjar",
        "Ben Ali", "Ben Salem", "Ben Ahmed", "Ben Youssef", "Ben Ibrahim", "Ben Hassan", "Ben Mohammed", "Ben Abdullah", "Ben Rahman", "Ben Khalil",
        "Al-Qahtani", "Al-Ghamdi", "Al-Harbi", "Al-Dossari", "Al-Zahrani", "Al-Shehri", "Al-Otaibi", "Al-Malki", "Al-Shamrani", "Al-Ruwaili",
        "Al-Qurashi", "Al-Sulaiman", "Al-Jaber", "Al-Malik", "Al-Rashid", "Al-Sultan", "Al-Tamimi", "Al-Watani", "Al-Yousef", "Al-Zaydi",
        "Abdul Rahman", "Abdul Aziz", "Abdul Malik", "Abdul Karim", "Abdul Ghani", "Abdul Hamid", "Abdul Latif", "Abdul Majid", "Abdul Nasser", "Abdul Qadir",
        "Al-Hashimi", "Al-Rashidi", "Al-Mutairi", "Al-Mazrouei", "Al-Nuaimi", "Al-Qassimi", "Al-Sharqi", "Al-Dhaheri", "Al-Falasi", "Al-Ketbi",
        "Al-Nasser", "Al-Jabri", "Al-Farsi", "Al-Balushi", "Al-Hinai", "Al-Ismaili", "Al-Kindi", "Al-Maskari", "Al-Rawahi", "Al-Siyabi",
        "Al-Hakim", "Al-Saqqaf", "Al-Attas", "Al-Amoudi", "Al-Bar", "Al-Sarraf", "Al-Ahdal", "Al-Yafei", "Al-Kathiri", "Al-Awlaki",
        "Al-Hashemi", "Al-Zarooni", "Al-Shamsi", "Al-Mansoori", "Al-Qubaisi", "Al-Suwaidi", "Al-Mehairbi", "Al-Hameli", "Al-Ameri", "Al-Marzooqi"
    ]
},
dravidian: {
    metadata: {
        family: "Dravidian",
        population_percentage: 3,
        writing_systems: ["Tamil", "Telugu", "Kannada", "Malayalam"],
        major_languages: ["Tamil", "Telugu", "Kannada", "Malayalam"],
        name_order: "given_name_first",
        preferred_voices: ["ta-IN", "te-IN", "kn-IN", "ml-IN"]
    },
    male_names: [
        "Ravi", "Krishna", "Raju", "Venkat", "Suresh", "Ramesh", "Prakash", "Mohan", "Ganesh", "Kumar",
        "Shankar", "Raj", "Karthik", "Vijay", "Satya", "Prasad", "Narayana", "Reddy", "Murthy", "Babu",
        "Anand", "Bhaskar", "Chandra", "Devi", "Eswar", "Gopal", "Hari", "Iyer", "Jayaram", "Kalyan",
        "Lakshmi", "Madhu", "Naga", "Om", "Pavan", "Raghu", "Sai", "Tamil", "Uma", "Venu",
        "Arun", "Balaji", "Chandran", "Deepak", "Ezhil", "Guru", "Hari", "Inba", "Jaya", "Kannan"
    ],
    female_names: [
        "Lakshmi", "Priya", "Devi", "Saroja", "Padma", "Meena", "Sita", "Radha", "Uma", "Shanti",
        "Vani", "Rani", "Saraswati", "Parvati", "Nirmala", "Maya", "Kala", "Indira", "Geetha", "Fathima",
        "Anjali", "Bhavani", "Chitra", "Divya", "Eswari", "Gayatri", "Hema", "Indumathi", "Jaya", "Kamala",
        "Lalitha", "Malathi", "Nandini", "Omana", "Preetha", "Radhika", "Savitha", "Thangam", "Usha", "Vanaja",
        "Amala", "Bala", "Chandra", "Deepa", "Ezhil", "Gowri", "Hari", "Indhu", "Jothi", "Kavya"
    ],
    family_names: [
        "Iyer", "Iyengar", "Pillai", "Naidu", "Reddy", "Nair", "Menon", "Raju", "Rao", "Krishna",
        "Sharma", "Varma", "Patel", "Chetty", "Mudaliar", "Gounder", "Nadar", "Thevar", "Chettiar", "Pandian",
        "Acharya", "Bhatt", "Char", "Dutta", "Easwaran", "Gupta", "Hegde", "Iyenger", "Joshi", "Kamath",
        "Lal", "Mani", "Nambiar", "Pai", "Rai", "Sastri", "Thakur", "Uppadhyaya", "Varkey", "Warrior",
        "Achari", "Bhat", "Chakravarthy", "Das", "Eashwaran", "Ganesh", "Hariharan", "Iyer", "Jain", "Kumar",
        "Lakshmanan", "Madhavan", "Nair", "Panicker", "Ramachandran", "Swamy", "Thampi", "Unni", "Varghese", "Warrier",
        "Anand", "Balan", "Chandran", "Devan", "Ezhil", "Gopalan", "Hari", "Illayaraja", "Jayaraman", "Kannan",
        "Lakshman", "Mohan", "Natesan", "Oommen", "Parthiban", "Raman", "Sankar", "Thangaraj", "Udayan", "Vasu",
        "Appan", "Babu", "Chandrasekhar", "Dhanraj", "Ekambaram", "Govindan", "Hari", "Iyappan", "Jayapal", "Kannappan",
        "Lingam", "Muthu", "Narayanan", "Ottappan", "Palani", "Rajesh", "Senthil", "Thangavel", "Udhayakumar", "Velan"
    ]
},
japanese: {
    metadata: {
        family: "Japonic",
        population_percentage: 1.6,
        writing_systems: ["Kanji", "Hiragana", "Katakana"],
        major_languages: ["Japanese"],
        name_order: "family_name_first",
        preferred_voices: ["ja-JP"]
    },
    male_names: [
        "Hiroto", "Yuto", "Haruto", "Sota", "Yuki", "Kento", "Takumi", "Riku", "Tsubasa", "Kaito",
        "Shota", "Yuta", "Koki", "Sho", "Ren", "Yuma", "Sosuke", "Ryota", "Keita", "Daiki",
        "Akira", "Daisuke", "Eiji", "Fumio", "Goro", "Hideo", "Ichiro", "Jiro", "Kenji", "Masashi",
        "Naoki", "Osamu", "Ryuji", "Shinji", "Takashi", "Umeji", "Wataru", "Yoshio", "Zen", "Akio",
        "Bunzo", "Chikara", "Daizo", "Eizo", "Fujio", "Genki", "Hiroshi", "Isamu", "Junzo", "Katashi"
    ],
    female_names: [
        "Yui", "Aoi", "Yuna", "Rio", "Hina", "Koharu", "Mei", "Mio", "Sana", "Yuna",
        "Akane", "Haruka", "Hinata", "Kaori", "Maki", "Nana", "Rin", "Sakura", "Yuki", "Airi",
        "Asuka", "Chieko", "Emi", "Fumiko", "Hanako", "Izumi", "Junko", "Keiko", "Mariko", "Naoko",
        "Reiko", "Sachiko", "Tomoko", "Yoko", "Ayumi", "Chika", "Erika", "Harumi", "Kanna", "Mayumi",
        "Noriko", "Rika", "Sayuri", "Tomomi", "Yayoi", "Yukiko", "Megumi", "Misaki", "Natsuki", "Yumiko"
    ],
    family_names: [
        "Sato", "Suzuki", "Takahashi", "Tanaka", "Watanabe", "Ito", "Yamamoto", "Nakamura", "Kobayashi", "Kato",
        "Yoshida", "Yamada", "Sasaki", "Yamaguchi", "Saito", "Matsumoto", "Inoue", "Kimura", "Hayashi", "Shimizu",
        "Abe", "Mori", "Ikeda", "Hashimoto", "Ishikawa", "Yamashita", "Ogawa", "Ishii", "Hasegawa", "Goto",
        "Okada", "Kondo", "Maeda", "Fujita", "Endo", "Aoki", "Sakamoto", "Murakami", "Ota", "Kaneko",
        "Fujii", "Fukuda", "Nishimura", "Miura", "Takeuchi", "Nakajima", "Okamoto", "Matsuda", "Harada", "Nakagawa",
        "Kawasaki", "Kojima", "Matsui", "Takada", "Fujiwara", "Higashi", "Imai", "Ishida", "Kudo", "Kinoshita",
        "Noguchi", "Onishi", "Sugiyama", "Ueda", "Wada", "Yokoyama", "Zushi", "Arai", "Baba", "Chiba",
        "Domon", "Eguchi", "Fukushima", "Goda", "Hara", "Ichikawa", "Jinnai", "Kagawa", "Kubo", "Masuda",
        "Nitta", "Ochi", "Doi", "Ezaki", "Furuya", "Goto", "Higa", "Inaba", "Jitsukata", "Kamei",
        "Machida", "Nagano", "Okubo", "Ryuzaki", "Sekiguchi", "Tezuka", "Uchida", "Wakabayashi", "Yasuda", "Zenko"
    ]
},
korean: {
    metadata: {
        family: "Koreanic",
        population_percentage: 1,
        writing_systems: ["Hangul"],
        major_languages: ["Korean"],
        name_order: "family_name_first",
        preferred_voices: ["ko-KR"]
    },
    male_names: [
        "Min-jun", "Seo-jun", "Do-yoon", "Ji-ho", "Ha-joon", "Dong-hyun", "Jun-seo", "Min-seok", "Ju-won", "Ye-jun",
        "Seung-hyun", "Ji-hoon", "Min-ho", "Sung-min", "Hyun-woo", "Tae-hyung", "Joon-ho", "Young-ho", "Sang-woo", "Kwang-ho",
        "Byung-hun", "Chan-woo", "Dae-hyun", "Eun-ho", "Gun-woo", "Hee-chul", "In-ho", "Jin-woo", "Ki-hyun", "Lee-min",
        "Moon-soo", "Nam-kyu", "Oh-sung", "Pil-sung", "Ryong-ho", "Sang-hyuk", "Tae-suk", "Un-jong", "Won-shik", "Yong-sun",
        "Bo-hyun", "Chang-min", "Do-hyun", "Eun-sung", "Gi-tae", "Ho-seok", "Il-sung", "Jung-hoon", "Kyung-soo", "Min-ki"
    ],
    female_names: [
        "Ji-yu", "Seo-yeon", "Ha-eun", "Eun-seo", "Ye-rin", "Min-seo", "Su-jin", "Yu-jin", "Ji-min", "Da-yeon",
        "Hye-jin", "Ji-eun", "Min-ji", "Soo-jin", "Yoon-ah", "Eun-ji", "Hae-won", "Ji-hye", "Mi-young", "Seung-ah",
        "Bo-ra", "Chae-won", "Da-hee", "Eun-bi", "Ga-in", "Ha-na", "In-ah", "Jin-ah", "Ki-ra", "Lee-seo",
        "Mi-na", "Na-young", "Oh-jung", "Park-min", "Ra-mi", "So-yi", "Tae-hee", "Woo-ri", "Ye-jin", "Young-mi",
        "Bin-na", "Cho-hee", "Do-yeon", "Eun-hye", "Geum-ji", "Hee-jin", "Il-sun", "Jung-hwa", "Kyung-mi", "Min-ah"
    ],
    family_names: [
        "Kim", "Lee", "Park", "Choi", "Jung", "Kang", "Cho", "Yoon", "Jang", "Lim",
        "Han", "Oh", "Seo", "Kwon", "Hong", "Song", "Yoo", "Chung", "Ryu", "Bae",
        "Ahn", "Baek", "Cha", "Do", "Eom", "Go", "Ha", "Im", "Jo", "Ko",
        "Moon", "Nam", "Ok", "Pyo", "Ro", "Shin", "Tak", "Um", "Won", "Yang",
        "Bak", "Chang", "Dok", "Eum", "Gong", "Ham", "In", "Joo", "Kong", "Ma",
        "No", "On", "Pak", "Rhee", "Sim", "Tang", "Woo", "Yim", "Ban", "Byun",
        "Chae", "Dan", "Eun", "Gu", "Heo", "Il", "Jin", "Kwak", "Min", "Na",
        "Om", "Paeng", "Ra", "Sa", "Shim", "Sun", "Wang", "Yu", "Bong", "Chi",
        "Dam", "Ee", "Gang", "Hahm", "Hyun", "Jeon", "Kyung", "Mun", "Noh", "Pae",
        "Rang", "Seok", "Suh", "Tae", "Wi", "Yun", "Bok", "Chu", "Dang", "En"
    ]
},
turkic: {
    metadata: {
        family: "Turkic",
        population_percentage: 2.5,
        writing_systems: ["Latin", "Cyrillic", "Arabic"],
        major_languages: ["Turkish", "Uzbek", "Kazakh", "Azerbaijani", "Turkmen"],
        name_order: "given_name_first",
        preferred_voices: ["tr-TR", "uz-UZ", "kk-KZ"]
    },
    male_names: [
        "Ahmet", "Mehmet", "Mustafa", "Ali", "Ibrahim", "Hasan", "Hüseyin", "Ismail", "Osman", "Yusuf",
        "Murat", "Ömer", "Selim", "Orhan", "Cemal", "Kemal", "Halil", "Serkan", "Volkan", "Can",
        "Alihan", "Berk", "Cihan", "Deniz", "Eren", "Furkan", "Gökhan", "Hakan", "İlhan", "Kaan",
        "Levent", "Mesut", "Nazim", "Orkun", "Polat", "Recep", "Sinan", "Tahir", "Umut", "Veli",
        "Yaşar", "Zafer", "Alp", "Burak", "Cem", "Demir", "Erol", "Faruk", "Güven", "Han"
    ],
    female_names: [
        "Ayşe", "Fatma", "Emine", "Hatice", "Zeynep", "Meryem", "Elif", "Sultan", "Özlem", "Sevgi",
        "Nisa", "Derya", "Esra", "Filiz", "Gül", "Hülya", "İrem", "Jale", "Kader", "Leyla",
        "Melek", "Nur", "Oyku", "Pinar", "Rabia", "Sema", "Tülay", "Ümit", "Vildan", "Yasemin",
        "Asli", "Betül", "Ceyda", "Damla", "Ebru", "Figen", "Gözde", "Hande", "İdil", "Kevser",
        "Lale", "Mine", "Nalan", "Özge", "Pembe", "Rüya", "Selma", "Tuğçe", "Ufuk", "Yıldız"
    ],
    family_names: [
        "Yılmaz", "Kaya", "Demir", "Şahin", "Çelik", "Yıldız", "Yıldırım", "Öztürk", "Aydın", "Özdemir",
        "Arslan", "Doğan", "Kılıç", "Aslan", "Çetin", "Kara", "Koç", "Kurt", "Özkan", "Şimşek",
        "Polat", "Özcan", "Korkmaz", "Erdoğan", "Şen", "Yalçın", "Güler", "Aktaş", "Kaplan", "Tekin",
        "Demirci", "Bakır", "Tuncer", "Keskin", "Bulut", "Türk", "Güneş", "Yavuz", "Alkan", "Taş",
        "Sarı", "Ateş", "Avcı", "Aksoy", "Altun", "Yüksel", "Gül", "Işık", "Turan", "Karahan",
        "Gündüz", "Erdem", "Akın", "Çakır", "Alp", "Eryılmaz", "Coşkun", "Köse", "Genç", "Keleş",
        "Altuğ", "Bozkurt", "Candemir", "Durmuş", "Ergin", "Fidan", "Gümüş", "Hacıoğlu", "İnan", "Kartal",
        "Levent", "Mutlu", "Namlı", "Oktay", "Peker", "Rüzgar", "Sadık", "Tanrıverdi", "Uğur", "Vural",
        "Yaman", "Zengin", "Akbaş", "Başaran", "Candan", "Demirtaş", "Eroğlu", "Fırat", "Güven", "Han",
        "İlhan", "Kara", "Levent", "Mercan", "Narin", "Oğuz", "Poyraz", "Rüzgar", "Sağlam", "Tan"
    ]
},
austroasiatic: {
    metadata: {
        family: "Austroasiatic",
        population_percentage: 1.5,
        writing_systems: ["Latin", "Khmer"],
        major_languages: ["Vietnamese", "Khmer", "Mon", "Santali"],
        name_order: "given_name_first",
        preferred_voices: ["vi-VN", "km-KH"]
    },
    male_names: [
        "Minh", "Duc", "Hung", "Tuan", "Thanh", "Dat", "Quan", "Hai", "Long", "Nam",
        "Vinh", "Phuc", "Anh", "Duy", "Khai", "Tien", "Son", "Trung", "Quoc", "Hieu",
        "Vuong", "Bao", "Khoa", "Phong", "Tam", "Thang", "Hoang", "Khang", "Manh", "Nguyen",
        "Phuoc", "Quang", "Sang", "Thai", "Van", "Xuan", "Yen", "Dang", "Khiem", "Lam",
        "Phong", "Quyen", "Sinh", "Toan", "Uy", "Viet", "Khoi", "Luan", "Nhan", "Phu"
    ],
    female_names: [
        "Lan", "Huong", "Mai", "Hoa", "Thuy", "Trang", "Linh", "Hong", "Nga", "Van",
        "Anh", "Dao", "Em", "Giang", "Ha", "Kim", "Lien", "My", "Ngoc", "Oanh",
        "Phuong", "Quynh", "Son", "Thu", "Uyen", "Van", "Xuan", "Yen", "Bich", "Chi",
        "Diem", "Hai", "Khanh", "Le", "Minh", "Nguyet", "Phi", "Quyen", "Suong", "Thao",
        "Trinh", "Tuyet", "Ut", "Vi", "Xuan", "Yen", "Dao", "Hien", "Kieu", "Ly"
    ],
    family_names: [
        "Nguyen", "Tran", "Le", "Pham", "Hoang", "Phan", "Vu", "Dang", "Bui", "Do",
        "Ho", "Ngo", "Duong", "Ly", "Dao", "Dinh", "Truong", "Mai", "Cao", "Vo",
        "Tang", "Chau", "Chu", "Ha", "Huynh", "Kim", "Lam", "Luong", "Mac", "Phung",
        "Son", "Thai", "Trinh", "Van", "Vuong", "Au", "Bach", "Cam", "Danh", "Doan",
        "Khuu", "Luu", "Ma", "Nam", "Quach", "To", "Trieu", "Vang", "Vinh", "Diep",
        "Han", "Kong", "La", "Man", "Nghiem", "Sam", "Thach", "Ton", "Ung", "Yan",
        "Banh", "Bao", "Binh", "Chan", "Diem", "Dong", "Giang", "Hang", "Hong", "Khong",
        "Lac", "Lai", "Loi", "Mach", "Nghe", "Nhan", "Quang", "Su", "Tap", "Thang",
        "Thi", "Thoi", "Tieu", "Tong", "Trang", "Trung", "Tu", "Ty", "Ut", "Vi",
        "Xa", "Xuan", "Bang", "Chi", "Dai", "Dan", "Du", "Duyen", "Em", "Giao"
    ]
},
tai_kadai: {
    metadata: {
        family: "Tai-Kadai",
        population_percentage: 1.2,
        writing_systems: ["Thai", "Lao", "Latin"],
        major_languages: ["Thai", "Lao", "Shan", "Zhuang"],
        name_order: "given_name_first",
        preferred_voices: ["th-TH", "lo-LA"]
    },
    male_names: [
        "Somchai", "Suchart", "Ananda", "Bancha", "Chaiya", "Decha", "Ekachai", "Kiet", "Mongkut", "Naris",
        "Panya", "Ratana", "Samart", "Somdet", "Thaksin", "Udom", "Vichai", "Wirote", "Yuttha", "Arthit",
        "Boon", "Chaisai", "Dang", "Eakkachai", "Anurak", "Kamon", "Manop", "Nattapong", "Pairat", "Rung",
        "Sakchai", "Tanet", "Uthai", "Wan", "Yod", "Apirak", "Bunjong", "Chalerm", "Duang", "Ekapong",
        "Kamol", "Montri", "Nikom", "Phaiboon", "Rit", "Sanit", "Thawi", "Veera", "Wirat", "Yos"
    ],
    female_names: [
        "Somying", "Malee", "Anchalee", "Busaba", "Chalita", "Duangdao", "Kannika", "Malai", "Noi", "Pen",
        "Ratree", "Saisuni", "Sunee", "Thida", "Usa", "Wandee", "Yupa", "Achara", "Benja", "Chandra",
        "Dara", "Ing", "Kamala", "Lawan", "Mali", "Naowarat", "Orawan", "Pimchan", "Rampai", "Siriporn",
        "Thapthim", "Ubon", "Varee", "Wilai", "Yada", "Anong", "Boonsri", "Chanida", "Darin", "Kanda",
        "Ladda", "Mayuree", "Napa", "Panita", "Ratchada", "Sirina", "Thanyarat", "Ubonrat", "Wanida", "Yupin"
    ],
    family_names: [
        "Srisai", "Chaiprasit", "Saetang", "Wongsawat", "Thongchai", "Sombun", "Rattanapong", "Naruemon", "Kaewkham", "Prasongsuk",
        "Thawornwong", "Chaisuwan", "Kaewmanee", "Sornprasit", "Wattanasin", "Sangsorn", "Khamphang", "Nualyong", "Phongam", "Kumpa",
        "Charoensuk", "Thepsiri", "Phanprasit", "Suwanchai", "Thongprasert", "Chokwiwat", "Buaphan", "Yooyen", "Kaewbunruang", "Srithong",
        "Namwong", "Thongdee", "Suwanchote", "Panyawong", "Sornsin", "Chaichana", "Wongwian", "Sawaengsuk", "Phuangthong", "Phankhian",
        "Sombat", "Thongsuk", "Chaiwong", "Phromma", "Rattanasak", "Srichot", "Khamlao", "Wongkham", "Sriwichai", "Bunsong",
        "Charoenrat", "Thongkham", "Saelee", "Wongprasert", "Saengsawang", "Buakhao", "Saelim", "Phankham", "Suwannapum", "Kaewrak",
        "Thongon", "Chaichomphu", "Srimuang", "Wongsa", "Saengthong", "Phanwilai", "Buakaew", "Charoenwat", "Sornkhunnatham", "Wongsri",
        "Thongphak", "Suwanmanee", "Phanprom", "Sriwarakorn", "Buasaeng", "Charoensap", "Suwannaphan", "Phuangphet", "Wongtrakul", "Saelao",
        "Thongkum", "Srichana", "Phanpheng", "Suwannarat", "Bunsuk", "Charoentham", "Suwannarit", "Phuangphrom", "Wongthong", "Saengsai",
        "Thongsang", "Srichan", "Phanpak", "Suwannawong", "Bunsueb", "Charoenthong", "Suwannasit", "Phuangpruk", "Wongthai", "Saengsuwan"
    ]
}

        };

        let isRunning = true;
        let isFast = false;
        let isWeighted = false;
        let intervalId = null;
        let synth = window.speechSynthesis;
        let voices = [];
        let currentCulture = null;
        let currentGender = null;
        let isVoiceInitialized = false;
        const SLOW_SPEED = 10000;
        const FAST_SPEED = 5000;

        async function initializeVoice() {
            try {
                updateVoiceStatus("Initializing voice system...");
                
                synth.cancel();
                voices = await loadVoices();
                
                if (!voices || voices.length === 0) {
                    throw new Error("No voices available");
                }

                voices.forEach(voice => {
                    voice.gender = (voice.name.toLowerCase().includes('female') ||
                                  voice.name.toLowerCase().includes('woman')) ? 'female' : 'male';
                });

                const testUtterance = new SpeechSynthesisUtterance("Voice initialized");
                testUtterance.volume = 0.1;
                
                return new Promise((resolve, reject) => {
                    testUtterance.onend = () => {
                        isVoiceInitialized = true;
                        updateVoiceStatus("Voice system ready");
                        document.getElementById('initVoiceButton').style.display = 'none';
                        resolve();
                    };
                    
                    testUtterance.onerror = (e) => {
                        reject(new Error(`Speech test failed: ${e.error}`));
                    };

                    synth.speak(testUtterance);
                });

            } catch (error) {
                console.error("Voice initialization error:", error);
                updateVoiceStatus(`Voice initialization failed: ${error.message}. Please try again.`);
                throw error;
            }
        }

        function loadVoices() {
            return new Promise((resolve, reject) => {
                const maxAttempts = 10;
                let attempts = 0;

                function tryGetVoices() {
                    attempts++;
                    let voiceList = synth.getVoices();
                    
                    if (voiceList.length > 0) {
                        resolve(voiceList);
                    } else if (attempts < maxAttempts) {
                        setTimeout(tryGetVoices, 500);
                    } else {
                        reject(new Error("Could not load voices after multiple attempts"));
                    }
                }

                if (synth.onvoiceschanged !== undefined) {
                    synth.onvoiceschanged = () => {
                        let voiceList = synth.getVoices();
                        if (voiceList.length > 0) {
                            resolve(voiceList);
                        }
                    };
                    tryGetVoices();
                } else {
                    tryGetVoices();
                }
            });
        }

        function updateVoiceStatus(message) {
            const status = document.getElementById('voiceStatus');
            status.textContent = message;
        }

        document.getElementById('initVoiceButton').addEventListener('click', async () => {
            try {
                await initializeVoice();
                generateAndSpeak();
            } catch (error) {
                console.error("Failed to initialize voice:", error);
            }
        });

        const toggleButton = document.getElementById('toggleButton');
        const speedToggle = document.getElementById('speedToggle');
        const weightedToggle = document.getElementById('weightedToggle');
        const speakButton = document.getElementById('speakButton');

        toggleButton.addEventListener('click', () => {
            isRunning = !isRunning;
            toggleButton.textContent = isRunning ? 'Pause' : 'Resume';
            if (isRunning) {
                generateAndSpeak();
                startInterval();
            } else {
                clearInterval(intervalId);
                synth.cancel();
            }
        });

        speedToggle.addEventListener('change', () => {
            isFast = speedToggle.checked;
            if (isRunning) {
                startInterval();
            }
        });

        weightedToggle.addEventListener('change', () => {
            isWeighted = weightedToggle.checked;
            updateStats();
        });

        speakButton.addEventListener('click', () => {
            if (!isVoiceInitialized) {
                updateVoiceStatus("Please initialize voice system first");
                return;
            }
            
            if (currentCulture) {
                const nameDisplay = document.getElementById('nameDisplay');
                speakNames(nameDisplay.textContent, currentCulture, currentGender);
            }
        });

        function getRandomName(array) {
            return array[Math.floor(Math.random() * array.length)];
        }

        function weightedRandomCulture() {
            if (!isWeighted) {
                return Object.keys(namesDatabase)[Math.floor(Math.random() * Object.keys(namesDatabase).length)];
            }

            const totalPercentage = Object.values(namesDatabase).reduce((sum, family) => 
                sum + family.metadata.population_percentage, 0);
            
            let random = Math.random() * totalPercentage;
            let currentSum = 0;

            for (const [culture, data] of Object.entries(namesDatabase)) {
                currentSum += data.metadata.population_percentage;
                if (random <= currentSum) {
                    return culture;
                }
            }

            return Object.keys(namesDatabase)[0];
        }

        function findBestVoice(preferredVoices, gender) {
            if (!voices || voices.length === 0) {
                return null;
            }

            for (const lang of preferredVoices) {
                const exactMatch = voices.find(v => 
                    v.lang === lang && 
                    v.gender === gender
                );
                if (exactMatch) return exactMatch;
            }

            for (const lang of preferredVoices) {
                const langPrefix = lang.split('-')[0];
                const familyMatch = voices.find(v => 
                    v.lang.startsWith(langPrefix) && 
                    v.gender === gender
                );
                if (familyMatch) return familyMatch;
            }

            const genderMatch = voices.find(v => v.gender === gender);
            if (genderMatch) return genderMatch;

            return voices[0];
        }

        function speakNames(text, culture, gender) {
            if (!isVoiceInitialized) {
                updateVoiceStatus("Please initialize voice system first");
                return;
            }

            try {
                synth.cancel();
                const utterance = new SpeechSynthesisUtterance(text);
                const familyData = namesDatabase[culture];
                const voice = findBestVoice(familyData.metadata.preferred_voices, gender);

                if (voice) {
                    utterance.voice = voice;
                }

                utterance.rate = 0.9;
                utterance.pitch = gender === 'female' ? 1.2 : 0.9;
                
                utterance.onerror = (e) => {
                    updateVoiceStatus(`Speech error: ${e.error}`);
                };

                synth.speak(utterance);
            } catch (error) {
                updateVoiceStatus(`Speech error: ${error.message}`);
            }
        }

        function updateStats() {
            const statsDisplay = document.getElementById('statsDisplay');
            if (isWeighted) {
                const currentFamily = namesDatabase[currentCulture];
                if (currentFamily) {
                    statsDisplay.textContent = 
                        `Using population weighting (${currentFamily.metadata.family}: ${currentFamily.metadata.population_percentage}%)`;
                }
            } else {
                statsDisplay.textContent = 'Random selection (equal probability)';
            }
        }

        function startInterval() {
            clearInterval(intervalId);
            intervalId = setInterval(generateAndSpeak, isFast ? FAST_SPEED : SLOW_SPEED);
        }

        function generateAndSpeak() {
            if (!isVoiceInitialized) {
                updateVoiceStatus("Please initialize voice system first");
                return;
            }

            const culture = weightedRandomCulture();
            currentCulture = culture;
            const familyData = namesDatabase[culture];
            
            currentGender = Math.random() < 0.5 ? 'male' : 'female';
            const givenName = getRandomName(familyData[`${currentGender}_names`]);
            const familyName = getRandomName(familyData.family_names);

            const nameDisplay = document.getElementById('nameDisplay');
            const cultureDisplay = document.getElementById('cultureDisplay');
            
            nameDisplay.classList.remove('fade-in');
            cultureDisplay.classList.remove('fade-in');
            void nameDisplay.offsetWidth;
            nameDisplay.classList.add('fade-in');
            cultureDisplay.classList.add('fade-in');

            const fullName = familyData.metadata.name_order === "given_name_first" ? 
                `${givenName} ${familyName}` : 
                `${familyName} ${givenName}`;

            nameDisplay.textContent = fullName;
            cultureDisplay.textContent = `(${familyData.metadata.family})`;
            
            if (isRunning) {
                speakNames(fullName, culture, currentGender);
            }
            
            updateStats();
        }

        window.onerror = function(msg, url, lineNo, columnNo, error) {
            updateVoiceStatus(`An error occurred: ${msg}`);
            return false;
        };

        async function init() {
            try {
                updateVoiceStatus("Click 'Initialize Voice' to begin");
                updateStats();
                const nameDisplay = document.getElementById('nameDisplay');
                if (!nameDisplay.textContent) {
                    generateAndSpeak();
                }
                startInterval();
            } catch (error) {
                updateVoiceStatus(`Initialization error: ${error.message}`);
            }
        }

        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }
    </script>
</body>
</html>