<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Assembly Index Calculator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    input, button {
      margin: 10px 0;
    }
  </style>
</head>
<body>
  <h1>Assembly Index Calculator</h1>
  <p>Enter any string below to calculate its Assembly Index, or generate a random string:</p>
  <input type="text" id="inputString" placeholder="Enter string here" />
  <button onclick="calculateAssemblyIndex()">Calculate</button>
  <button onclick="generateRandomString()">Generate Random String</button>
  <h2>Result:</h2>
  <p id="result"></p>

  <script>
    // Assembly Index Calculation
    function calculateAssemblyIndex() {
      const input = document.getElementById('inputString').value;
      if (!input) {
        alert('Please enter a string!');
        return;
      }

      // Compute Assembly Index and Compression
      function computeAssemblyIndex(str) {
        const n = str.length;
        const memo = new Array(n + 1).fill(Infinity); // Steps to assemble
        const compressedParts = new Array(n + 1).fill(""); // Compressed parts
        memo[0] = 0;

        for (let i = 1; i <= n; i++) {
          for (let j = 0; j < i; j++) {
            const substring = str.substring(j, i);
            const length = i - j;

            // Look for repeated patterns
            const earlierIndex = str.substring(0, j).indexOf(substring);

            let steps, candidate;

            // Case 1: Reuse substring
            if (earlierIndex !== -1) {
              steps = memo[j] + 1; // Add one step for reusing
              candidate = substring;
            } else {
              // Case 2: New substring
              steps = memo[j] + length;
              candidate = substring;
            }

            if (steps < memo[i]) {
              memo[i] = steps;
              compressedParts[i] = compressedParts[j] + "+" + candidate;
            }
          }
        }

        const compressedString = compressedParts[n].replace(/^\+/, ""); // Cleanup
        return { assemblyIndex: memo[n], compressedString };
      }

      // Compute results
      const originalLength = input.length;
      const { assemblyIndex, compressedString } = computeAssemblyIndex(input);
      const ratio = (assemblyIndex / originalLength).toFixed(2);

      // Display results
      document.getElementById('result').innerHTML = `
        <strong>Input String:</strong> "${input}"<br>
        <strong>Original Length:</strong> ${originalLength}<br>
        <strong>Assembly Index:</strong> ${assemblyIndex}<br>
        <strong>Ratio (Index / Length):</strong> ${ratio}<br>
        <strong>Compressed Version:</strong> ${compressedString}
      `;
    }

    // Random String Generator
    function generateRandomString() {
      const length = prompt("Enter the length of the random string:", "20");
      if (!length || isNaN(length) || length <= 0) {
        alert('Please enter a valid number!');
        return;
      }

      const characters = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ";
      let randomString = "";

      for (let i = 0; i < length; i++) {
        const randomIndex = Math.floor(Math.random() * characters.length);
        randomString += characters[randomIndex];
      }

      // Set generated string into input box
      document.getElementById('inputString').value = randomString;

      // Automatically calculate Assembly Index for generated string
      calculateAssemblyIndex();
    }
  </script>
</body>
</html>