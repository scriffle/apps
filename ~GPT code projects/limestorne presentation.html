<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Cool‑Water Limestone — Interactive Slideshow</title>
<style>
  :root{
    --bg:#0f172a;      /* slate-900 */
    --panel:#0b1226;   /* deep navy */
    --text:#e5e7eb;    /* zinc-200 */
    --muted:#9ca3af;   /* gray-400 */
    --accent:#22d3ee;  /* cyan-400 */
    --accent2:#a78bfa; /* violet-400 */
    --ok:#34d399;      /* green */
    --bad:#f87171;     /* red */
    --card:#111827;    /* slate-800 */
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0;background:linear-gradient(180deg,var(--bg),#060a17 60%);color:var(--text);
    font:16px/1.55 system-ui,Segoe UI,Roboto,Helvetica,Arial,sans-serif;
  }
  .wrap{max-width:1100px;margin:0 auto;padding:20px 16px}
  header{display:flex;gap:16px;align-items:center;justify-content:space-between;position:sticky;top:0;background:linear-gradient(180deg,#0e152e,rgba(14,21,46,.6));backdrop-filter:blur(8px);z-index:5;border-bottom:1px solid rgba(255,255,255,.06)}
  header h1{font-size:clamp(18px,3vw,26px);margin:10px 0;font-weight:700;letter-spacing:.2px}
  header .controls{display:flex;flex-wrap:wrap;gap:10px;align-items:center}
  button, .btn{
    background:linear-gradient(180deg,#1f2937,#0f172a);color:#fff;border:1px solid rgba(255,255,255,.1);
    padding:8px 12px;border-radius:12px;cursor:pointer;transition:all .2s ease;box-shadow:0 0 0 1px rgba(255,255,255,.04) inset
  }
  button:hover{transform:translateY(-1px);box-shadow:0 6px 18px rgba(0,0,0,.35),0 0 0 1px rgba(255,255,255,.08) inset}
  .ghost{background:transparent;border-color:rgba(255,255,255,.16)}
  .progress{flex:1;display:flex;gap:6px;align-items:center;padding:0 10px}
  .dot{width:10px;height:10px;border-radius:50%;background:#2a3657;box-shadow:0 0 0 1px rgba(255,255,255,.08) inset}
  .dot.active{background:linear-gradient(180deg,var(--accent),var(--accent2));}

  .slides{position:relative;margin-top:16px}
  .slide{display:none;}
  .slide.active{display:block;animation:fade .4s ease}
  @keyframes fade{from{opacity:.2;transform:translateY(4px)}to{opacity:1;transform:none}}

  .card{background:linear-gradient(180deg,#0b1120,#0a1020);border:1px solid rgba(255,255,255,.06);border-radius:16px;padding:18px;box-shadow:0 10px 24px rgba(0,0,0,.35)}
  .grid{display:grid;gap:14px}
  .grid.cols-2{grid-template-columns:repeat(2,minmax(0,1fr))}
  .grid.cols-3{grid-template-columns:repeat(3,minmax(0,1fr))}
  @media (max-width:900px){.grid.cols-2,.grid.cols-3{grid-template-columns:1fr}}
  h2{font-size:clamp(20px,3.2vw,28px);margin:0 0 10px}
  h3{font-size:clamp(16px,2.4vw,20px);margin:12px 0 6px;color:#c7d2fe}
  p{margin:8px 0}
  ul{margin:10px 0 10px 20px}
  li{margin:4px 0}
  details{background:#0c142b;border:1px solid rgba(255,255,255,.08);padding:10px 12px;border-radius:12px}
  details[open]{box-shadow:0 6px 18px rgba(0,0,0,.3)}

  .hero{display:grid;grid-template-columns:1.2fr .8fr;gap:16px;align-items:center}
  .hero img{width:100%;height:auto;border-radius:14px;border:1px solid rgba(255,255,255,.06)}
  .imgcap{font-size:12px;color:var(--muted);margin-top:6px}
  .imgcap a{color:#93c5fd}
  figure{margin:0}

  .kbd{display:inline-block;padding:3px 7px;border-radius:8px;border:1px solid rgba(255,255,255,.2);background:#0c1226;color:#e2e8f0;font-size:12px}

  .compare{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  .compare .panel{background:#0c1328;border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:12px}
  .compare h4{margin:0 0 6px 0;color:#7dd3fc}
  .compare ul{margin-left:18px}

  .sliderbox{background:#0b1226;border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:12px}
  input[type=range]{width:100%}
  .facies{display:flex;gap:10px;flex-wrap:wrap}
  .badge{border:1px solid rgba(255,255,255,.1);padding:6px 10px;border-radius:999px;background:#0a1222}

  .gallery{display:grid;grid-template-columns:repeat(2, 1fr);gap:12px}
  .gallery img{width:100%;height:260px;object-fit:cover;border-radius:12px;border:1px solid rgba(255,255,255,.08);cursor:zoom-in}
  @media (max-width:900px){.hero{grid-template-columns:1fr}.gallery{grid-template-columns:1fr}}

  .zoom{position:fixed;inset:0;background:rgba(0,0,0,.7);backdrop-filter:blur(2px);display:none;align-items:center;justify-content:center;z-index:50}
  .zoom img{max-width:90vw;max-height:84vh;border-radius:14px;border:1px solid rgba(255,255,255,.2)}

  .quiz{display:grid;gap:10px}
  .q{background:#0c142b;border:1px solid rgba(255,255,255,.08);border-radius:12px;padding:12px}
  .q h4{margin:0 0 8px 0}
  .opt{display:block;margin:6px 0;padding:8px;border-radius:10px;border:1px solid rgba(255,255,255,.1);cursor:pointer}
  .opt:hover{background:#0f1a36}
  .opt.correct{border-color:var(--ok)}
  .opt.wrong{border-color:var(--bad)}
  .notice{font-size:13px;color:var(--muted)}

  footer{margin:24px 0 80px;color:var(--muted)}
  footer a{color:#93c5fd}
[data-theme="light"]{--bg:#f8fafc;--panel:#ffffff;--text:#0b1226;--muted:#4b5563;--accent:#0891b2;--accent2:#6366f1;--ok:#059669;--bad:#dc2626;--card:#ffffff}
body[data-theme="light"] .card{background:linear-gradient(180deg,#ffffff,#f7fafc);border-color:rgba(0,0,0,.08)}
body[data-theme="light"] header{background:linear-gradient(180deg,#ffffffcc,#ffffff80);border-bottom-color:rgba(0,0,0,.08)}
body[data-theme="light"] .ghost{border-color:rgba(0,0,0,.16)}
body[data-theme="light"] .compare .panel{background:#f3f4f6;border-color:rgba(0,0,0,.08)}
body[data-theme="light"] details{background:#f3f4f6;border-color:rgba(0,0,0,.12)}
body[data-theme="light"] .sliderbox{background:#f3f4f6;border-color:rgba(0,0,0,.12)}
body[data-theme="light"] .badge{background:#eef2ff;border-color:rgba(0,0,0,.12)}
body[data-theme="light"] .dot{background:#cbd5e1}
body[data-theme="light"] .imgcap a, footer a{color:#1d4ed8}
</style>
</head>
<body data-theme="dark">
  <header class="wrap">
    <h1>Cool‑Water Limestone (Temperate Carbonates)</h1>
    <div class="controls">
      <button id="prev" class="ghost" title="Previous (←)">Prev</button>
      <div class="progress" aria-label="Slide progress"></div>
      <button id="next" title="Next (→)">Next</button>
      <label class="btn ghost" style="display:flex;gap:8px;align-items:center"><input id="autoplay" type="checkbox"/> Auto‑advance</label>
      <button id="themeBtn" class="ghost" title="Toggle theme">Theme: Dark</button>
      <a class="btn" href="#refs">References</a>
    </div>
  </header>

  <main class="wrap slides" id="deck" aria-live="polite">

    <!-- 0. Title / keyboard help -->
    <section class="slide active">
      <div class="card hero">
        <div>
          <h2>What makes cool‑water limestone different?</h2>
          <p>Unlike tropical, coral‑rich carbonates, cool‑water limestones form on temperate shelves dominated by <strong>heterozoan</strong> skeletons (bryozoans, echinoids, molluscs, foraminifera). Production is lower, storms are frequent, and siliciclastic input and nutrients are often higher. The result is a factory that builds <em>skeletal sands and gravels</em> rather than massive reefs.</p>
          <details>
            <summary>Keyboard & navigation</summary>
            <p>Use <span class="kbd">→</span>/<span class="kbd">←</span> to move, <span class="kbd">A</span> to toggle auto‑advance, and click images to zoom.</p>
          </details>
          <p class="explain">In short, this talk compares temperate carbonate seas with tropical ones and shows how broken shells and algae can build limestone over long times.</p>
        </div>
        <figure>
          <img alt="Bunda Cliffs, Eucla Basin — limestone sea cliffs" loading="lazy" src="https://commons.wikimedia.org/wiki/Special:FilePath/Bunda%20Cliffs%2C%202017%20(05).jpg"/>
          <figcaption class="imgcap">Bunda Cliffs (Eucla Basin, southern Australia). Image: Wikimedia Commons (<a href="https://commons.wikimedia.org/wiki/Category:Bunda_Cliffs" target="_blank" rel="noopener">source & license</a>).</figcaption>
        </figure>
      </div>
    </section>

    <!-- 1. Factory concept -->
    <section class="slide">
      <div class="card">
        <h2>Carbonate factory: <span style="color:#7dd3fc">Heterozoan</span> vs <span style="color:#fde68a">Photozoan</span></h2>
        <div class="compare">
          <div class="panel">
            <h4>Cool‑water (heterozoan)</h4>
            <ul>
              <li>Latitudes typically ~30–60°, temperate shelves and ramps.</li>
              <li>Producers: bryozoans, echinoids, crinoids, molluscs, small benthic forams; coralline red algae (rhodoliths/maerl) where light allows.</li>
              <li>Products: skeletal <em>packstones–grainstones</em>, shell gravel, tempestites, bryozoan mounds; mud often from micritised bioclasts.</li>
              <li>Marine cements are sparse; aragonite less abundant than low‑Mg calcite.</li>
            </ul>
          </div>
          <div class="panel">
            <h4>Warm‑water (photozoan)</h4>
            <ul>
              <li>Tropics & subtropics, clear oligotrophic water.</li>
              <li>Producers: corals, large benthic forams, green & red algae.</li>
              <li>Products: reefs, ooids, peloids, lime mud generated by photo‑induced precipitation.</li>
              <li>Early aragonite cements common; rapid syndepositional lithification.</li>
            </ul>
          </div>
        </div>
        <p class="explain">In short: cooler, nutrient‑richer seas favour filter‑feeding animals and red algae. They make shell sand and gravel rather than tall coral reefs.</p>
      </div>
    </section>

    <!-- 2. Key controls -->
    <section class="slide">
      <div class="card">
        <h2>Environmental controls</h2>
        <div class="sliderbox">
          <label for="energy">Wave/Storm energy</label>
          <input id="energy" type="range" min="0" max="100" value="65"/>
          <div id="facies" class="facies" aria-live="polite"></div>
        </div>
        <ul>
          <li><strong>Temperature & light:</strong> lower temps & seasonal light favour heterozoans; corals/ooids are minor.</li>
          <li><strong>Nutrients & upwelling:</strong> fertilise filter‑feeders (bryozoans, bivalves) but suppress photozoan carbonates.</li>
          <li><strong>Storms:</strong> frequent shelf‑wide reworking → <em>hummocky cross‑stratification</em>, graded tempestites.</li>
          <li><strong>Siliciclastics:</strong> mixed systems are common; carbonates dominate where terrigenous flux is low.</li>
        </ul>
        <p class="explain">What this means: on wide, cool shelves with regular storms and some nutrients, broken shells are made and moved often, building beds of carbonate sand.</p>
      </div>
    </section>

    <!-- 3. Skeletal producers gallery -->
    <section class="slide">
      <div class="card">
        <h2>Who builds cool‑water limestone?</h2>
        <div class="gallery">
          <figure>
            <img alt="Bryozoans in fossiliferous limestone" loading="lazy" src="https://commons.wikimedia.org/wiki/Special:FilePath/Bryozoans%20in%20fossiliferous%20limestone%20(Lower%20Mercer%20Limestone%2C%20Middle%20Pennsylvanian%3B%20Route%2016%20roadcut%20near%20Trinway%2C%20Ohio%2C%20USA)%201%20(39880154333).jpg"/>
            <figcaption class="imgcap">Bryozoan fragments in limestone. Photo by James St. John (CC BY 2.0, Wikimedia Commons).</figcaption>
          </figure>
          <figure>
            <img alt="Echinoid spines in fossiliferous limestone" loading="lazy" src="https://commons.wikimedia.org/wiki/Special:FilePath/Echinoid%20spines%20in%20fossiliferous%20limestone%20(Putnam%20Hill%20Limestone%2C%20Middle%20Pennsylvanian%3B%20Rt.%2079%20roadcut%2C%20Perry%20Township%2C%20Coshocton%20County%2C%20Ohio%2C%20USA)%20(33076207185).jpg"/>
            <figcaption class="imgcap">Echinoid bioclasts in limestone. Photo by James St. John (CC BY 2.0, Wikimedia Commons).</figcaption>
          </figure>
          <figure>
            <img alt="Crinoid columnals and brachiopod in Kaibab Limestone" loading="lazy" src="https://commons.wikimedia.org/wiki/Special:FilePath/Kaibab%20Formation%20-%20fossil%20brachiopod%20and%20crinoid%20columnals.jpg"/>
            <figcaption class="imgcap">Crinoid columnals & brachiopod (Kaibab Limestone). Image: NPS (Public Domain via Wikimedia Commons).</figcaption>
          </figure>
          <figure>
            <img alt="Calcarenite at Lord Howe Island" loading="lazy" src="https://commons.wikimedia.org/wiki/Special:FilePath/Calcarenite%20MiddleBeach%20LordHoweIsland%205June2011.jpg"/>
            <figcaption class="imgcap">Calcarenite outcrop (Lord Howe Island). Wikimedia Commons.</figcaption>
          </figure>
        </div>
        <p class="notice">These taxa typify the <em>heterozoan association</em> — low‑Mg calcite rich. Larger benthic forams & corals dominate tropics, not here.</p>
        <p class="explain">Put simply: most grains in these rocks are pieces of once‑living animals such as bryozoans and sea urchins, with only a minor role for corals.</p>
      </div>
    </section>

    <!-- 4. Rhodoliths -->
    <section class="slide">
      <div class="card hero">
        <div>
          <h2>Coralline red algae (rhodoliths/maerl)</h2>
        <div>
          <p>Where light reaches the seabed, coralline algae form nodules (<em>rhodoliths</em> / <em>maerl</em>) that contribute sand‑to‑gravel grade sediment to cool‑water systems.</p>
          <ul>
            <li>High‑Mg calcite skeletons; fragile, easily reworked.</li>
            <li>Common on mid‑ to outer‑ramp floors; important microhabitats.</li>
          </ul>
          <p class="explain">Around southern Australia, similar beds occur where the water is clear enough for light to reach the bottom, adding pink, gritty sand to the shelf.</p>
        </div>
        <figure>
          <img alt="Rhodoliths (maerl)" loading="lazy" src="https://commons.wikimedia.org/wiki/Special:FilePath/Messinian%20rhodolith.JPG"/>
          <figcaption class="imgcap">Rhodoliths (Messinian). Wikimedia Commons.</figcaption>
        </figure>
      </div>
    </section>

    <!-- 5. Storm beds / HCS -->
    <section class="slide">
      <div class="card hero">
        <div>
          <h2>Storm‑dominated structures</h2>
        <div>
          <p>Frequent shelf storms generate <strong>hummocky cross‑stratification</strong> and graded shell‑rich tempestites, key indicators of temperate carbonate ramps.</p>
          <details>
            <summary>Why it matters</summary>
            <p>HCS pinpoints deposition between fair‑weather and storm wave base and helps place facies on a ramp profile.</p>
          </details>
          <p class="explain">Big storms move sand back and forth. This movement carves low mounds and swales, leaving a distinctive wavy layering pattern.</p>
        </div>
        <figure>
          <img alt="Hummocky cross‑stratification" loading="lazy" src="https://commons.wikimedia.org/wiki/Special:FilePath/Hummocky%20cross-stratification.JPG"/>
          <figcaption class="imgcap">Hummocky cross‑stratification (CC BY‑SA, Wikimedia Commons).</figcaption>
        </figure>
      </div>
    </section>

    <!-- 6. Facies belts (interactive badges) -->
    <section class="slide">
      <div class="card">
        <h2>Typical facies belts on a cool‑water ramp</h2>
        <div id="faciesBadges" class="facies"></div>
        <ul>
          <li><strong>Inner ramp:</strong> shell gravel & skeletal sands; cross‑bedding, ripples; frequent tempestites.</li>
          <li><strong>Mid‑ramp:</strong> bryozoan pack‑/grainstones; rip‑up clasts; rhodolith lenses; bioturbation.</li>
          <li><strong>Outer ramp:</strong> muddy skeletal wacke/packstones; low energy; contourite influence possible.</li>
        </ul>
        <p class="explain">Think of walking from the beach out to sea: coarse shell gravel near shore, then cleaner shell sand, then finer, muddier shells in deeper water.</p>
      </div>
    </section>

    <!-- 7. Diagenesis & geochemistry -->
    <section class="slide">
      <div class="card grid cols-2">
        <div>
          <h2>Diagenesis & geochemistry</h2>
        <ul>
          <li>Lower saturation & temperature → slower marine cementation; fibrous/aragonitic cements less common.</li>
          <li>Frameworks are rarely rigid; early lithification mainly from micrite infill & calcite cements during meteoric/burial stages.</li>
          <li>Common: compaction, stylolites, neomorphism of aragonite → calcite; patchy dolomitisation in mixed systems.</li>
          <li>Geochemistry: generally higher δ<sup>18</sup>O than tropical analogues (cooler waters) but overprinted by diagenesis; Sr/Mg reflect mineralogy.</li>
        </ul>
        <p class="explain">Over time, loose shell sand turns into rock as grains are squeezed and cement grows. In temperate settings, much of this cement forms later, not right on the sea floor.</p>
      </div>
        <div>
          <h3>Case evidence</h3>
          <p>Southern Australia (Gambier, Wilson Bluff, Abrakurrie Limestones) — extensive Eocene–Miocene bryozoan calcarenites with limited early marine cements; long exposure to meteoric diagenesis on the Nullarbor uplift.</p>
          <p>Danian bryozoan mounds at Stevns Klint (Denmark) — bryozoan‑rich chalk/limestone with flint bands.</p>
        </div>
      </div>
    </section>

    <!-- 8. Case study: Southern Australia -->
    <section class="slide">
      <div class="card hero">
        <div>
          <h2>Case study: Southern Australia shelf (Eucla & Otway)</h2>
        <p>World‑class cool‑water carbonate province. Outer‑shelf bryozoan sands and calcarenites form spectacular cliffs and extensive aquifers.</p>
        <ul>
          <li>Wilson Bluff & Nullarbor Limestones (Eucla Basin)</li>
          <li>Gambier Limestone (Otway Basin)</li>
        </ul>
        <p class="explain">Along the Great Australian Bight, these limestones record temperate seas building layer upon layer of shell sand that later became major water‑bearing rocks.</p>
      </div>
        <figure>
          <img alt="Bunda Cliffs along the Great Australian Bight" loading="lazy" src="https://commons.wikimedia.org/wiki/Special:FilePath/Bunda%20Cliffs%2C%202017%20(08).jpg"/>
          <figcaption class="imgcap">Bunda Cliffs, Great Australian Bight. Wikimedia Commons (various CC licenses).</figcaption>
        </figure>
      </div>
    </section>

    <!-- 9. Case study: Ōamaru stone (NZ) -->
    <section class="slide">
      <div class="card hero">
        <div>
          <h2>Case study: Ōamaru Stone (New Zealand)</h2>
        <p>A Late Oligocene–Miocene <strong>bryozoan limestone</strong> quarried as a building stone. Even texture, high calcite content, easy to carve, widely used in heritage architecture.</p>
        <p class="explain">Across the Tasman, this rock formed in a similar cool‑water setting to southern Australia. Its uniform grain size makes it a workable building stone.</p>
        <figure>
          <img alt="Oamaru historic precinct buildings in limestone" loading="lazy" src="https://commons.wikimedia.org/wiki/Special:FilePath/Oamaru%20Historic%20Precinct%20(1).jpg"/>
          <figcaption class="imgcap">Ōamaru Historic Precinct. Wikimedia Commons (<a href="https://commons.wikimedia.org/wiki/Category:Oamaru_stone" target="_blank" rel="noopener">image set & licence</a>).</figcaption>
        </figure>
      </div>
    </section>

    <!-- 10. Case study: Stevns Klint (Denmark) -->
    <section class="slide">
      <div class="card hero">
        <div>
          <h2>Case study: Stevns Klint (Denmark)</h2>
        <p>UNESCO site exposing the K–Pg boundary overlain by <strong>Danian bryozoan limestone</strong> and chalk mounds with flint bands.</p>
        <p class="explain">This European site shows the same temperate carbonate style that we see in the Southern Hemisphere, which helps geologists compare patterns across the globe.</p>
        <figure>
          <img alt="Stevns Klint coastal cliff" loading="lazy" src="https://commons.wikimedia.org/wiki/Special:FilePath/Stevns%20Klint%204525692589%20da98ffd5a6%20o.jpg"/>
          <figcaption class="imgcap">Stevns Klint. Wikimedia Commons (<a href="https://en.wikipedia.org/wiki/Stevns_Klint" target="_blank" rel="noopener">overview</a>).</figcaption>
        </figure>
      </div>
    </section>

    <!-- 11. Applications / significance -->
    <section class="slide">
      <div class="card grid cols-2">
        <div>
          <h2>Why it matters</h2>
          <ul>
            <li><strong>Aquifers & karst:</strong> extensive potable water resources; sinkhole hazard on uplifted platforms.</li>
            <li><strong>Reservoirs:</strong> skeletal grainstones with storm reworking can have excellent porosity/permeability; diagenesis is key.</li>
            <li><strong>Geoheritage & building stone:</strong> iconic cliffs (Bunda) and stones (Ōamaru).</li>
          </ul>
          <p class="explain">For Australian land and water planning, recognising these limestones helps with groundwater supply and with managing karst hazards such as sinkholes.</p>
        </div>
        <div>
          <h3>Field checklist</h3>
          <ul>
            <li>Bioclast suite: bryozoans ≫ corals; echinoids, molluscs, crinoids common.</li>
            <li>Structures: HCS, tempestites, shell lags; ramp geometry rather than rimmed platform.</li>
            <li>Cements: scarce early marine; look for meteoric overprint (isopachous calcite, neomorphosed aragonite).</li>
          </ul>
        </div>
      </div>
    </section>

    <!-- 12. Quick quiz -->
    <section class="slide">
      <div class="card">
        <h2>Quick check</h2>
        <p class="explain">Answer these to see how well the main ideas have landed. You can revisit any slide and try again.</p>
        <div class="quiz" id="quiz"></div>
        <button id="check">Check answers</button>
        <div id="score" class="notice" role="status" aria-live="polite"></div>
      </div>
    </section>

    <!-- 13. References & credits -->
    <section class="slide" id="refs">
      <div class="card">
        <h2>References & image credits</h2>
        <ul>
          <li>James, N.P. & Clarke, J.A.D. (eds.) <em>Neritic Carbonate Sediments in a Temperate Realm</em>. Springer. (Overview of southern Australian cool‑water carbonates.)</li>
          <li>Springer Encyclopedia entry: “Carbonates, Cool Water.”</li>
          <li>Stevns Klint (UNESCO/Denmark) — Danian bryozoan limestone case studies.</li>
          <li>Ōamaru Stone (NZ): Te Ara / Science Learning Hub resources.</li>
        </ul>
        <p class="notice">All photos load directly from Wikimedia Commons under their stated licences. Captions link back to source pages for author and licence details.</p>
      </div>
    </section>
  </main>

  <div class="zoom" id="zoom" role="dialog" aria-modal="true" aria-label="Zoomed image">
    <img alt="Zoomed"/>
  </div>

<script>
(function(){
  // Theme handling
  const themeBtn = document.getElementById('themeBtn');
  function applyTheme(t){document.body.setAttribute('data-theme',t); if(themeBtn){themeBtn.textContent = 'Theme: ' + (t==='dark'?'Dark':'Light');}}
  let saved = localStorage.getItem('theme');
  if(!saved){saved = (window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches)?'light':'dark';}
  applyTheme(saved);
  if(themeBtn){themeBtn.addEventListener('click',()=>{const current=document.body.getAttribute('data-theme');const next=current==='dark'?'light':'dark';applyTheme(next);localStorage.setItem('theme',next);});}

  const deck = document.getElementById('deck');
  const slides = [...deck.querySelectorAll('.slide')];
  const progress = document.querySelector('.progress');
  const prev = document.getElementById('prev');
  const next = document.getElementById('next');
  const autoplay = document.getElementById('autoplay');
  const dots = slides.map((_,i)=>{
    const d=document.createElement('div');d.className='dot'+(i===0?' active':'');d.title='Slide '+(i+1);d.addEventListener('click',()=>go(i));return d;
  });
  dots.forEach(d=>progress.appendChild(d));

  let idx=0, timer=null;
  function show(i){slides.forEach((s,j)=>{s.classList.toggle('active',j===i);dots[j].classList.toggle('active',j===i);});}
  function go(i){idx=(i+slides.length)%slides.length;show(idx);ensurePaused();}
  function nextSlide(){go(idx+1)}
  function prevSlide(){go(idx-1)}
  next.onclick=nextSlide; prev.onclick=prevSlide;
  document.addEventListener('keydown',e=>{
    if(e.key==='ArrowRight') nextSlide();
    if(e.key==='ArrowLeft') prevSlide();
    if(e.key.toLowerCase()==='a'){autoplay.checked=!autoplay.checked;toggleAuto();}
  });
  function toggleAuto(){
    if(autoplay.checked){timer=setInterval(nextSlide,6000);} else {clearInterval(timer);timer=null;}
  }
  autoplay.addEventListener('change',toggleAuto);
  function ensurePaused(){if(autoplay.checked){clearInterval(timer);timer=setInterval(nextSlide,6000)}}

  // Energy slider → dynamic facies chips
  const energy=document.getElementById('energy');
  const facies=document.getElementById('facies');
  const chips=[
    {min:0,max:30,text:'Outer ramp mud‑rich wacke/packstone'},
    {min:20,max:65,text:'Mid‑ramp bryozoan pack/grainstone'},
    {min:50,max:85,text:'Inner ramp skeletal sand & shell gravel'},
    {min:70,max:100,text:'Tempestite beds with HCS & shell lags'}
  ];
  function renderFacies(val){
    facies.innerHTML='';
    chips.filter(c=>val>=c.min && val<=c.max).forEach(c=>{
      const b=document.createElement('span');b.className='badge';b.textContent=c.text;facies.appendChild(b);
    });
  }
  energy.addEventListener('input',e=>renderFacies(+e.target.value));
  renderFacies(+energy.value);

  // Static facies badges panel
  const fb=document.getElementById('faciesBadges');
  ['Shell‑gravel shoals','Bryozoan sand waves','Rhodolith lenses','Mud‑rich outer ramp','Contourite drifts (optional)']
    .forEach(t=>{const b=document.createElement('span');b.className='badge';b.textContent=t;fb.appendChild(b)});

  // Click‑to‑zoom for all gallery/figure images
  const zoom=document.getElementById('zoom');
  const zimg=zoom.querySelector('img');
  deck.querySelectorAll('img').forEach(img=>{
    img.addEventListener('click',()=>{zimg.src=img.src;zoom.style.display='flex'});
  });
  zoom.addEventListener('click',()=>{zoom.style.display='none';zimg.removeAttribute('src')});

  // Quiz
  const questions=[
    {q:'Dominant skeletal producers in cool‑water limestones are…',
     a:['Corals, ooids, and green algae','Bryozoans, echinoids, molluscs, small benthic forams','Archaeocyaths and stromatoporoids'],
     correct:1},
    {q:'A hallmark storm‑generated structure on temperate shelves is…',
     a:['Hummocky cross‑stratification','Polygonal cracking','Large ooid shoals'],
     correct:0},
    {q:'Compared to tropical carbonates, early marine cements in cool‑water settings are…',
     a:['More abundant and mostly aragonitic','Sparse; calcite dominates and much lithification is meteoric/burial','Non‑existent under any circumstances'],
     correct:1}
  ];
  const quizEl=document.getElementById('quiz');
  const scoreEl=document.getElementById('score');
  questions.forEach((qq,i)=>{
    const q=document.createElement('div');q.className='q';
    const h=document.createElement('h4');h.textContent=(i+1)+'. '+qq.q;q.appendChild(h);
    qq.a.forEach((opt,oi)=>{
      const lab=document.createElement('label');lab.className='opt';
      const input=document.createElement('input');input.type='radio';input.name='q'+i;input.value=oi;input.style.marginRight='8px';
      lab.appendChild(input);lab.appendChild(document.createTextNode(opt));q.appendChild(lab);
    });
    quizEl.appendChild(q);
  });
  document.getElementById('check').addEventListener('click',()=>{
    let right=0,total=questions.length;
    [...quizEl.querySelectorAll('.q')].forEach((qEl,i)=>{
      const chosen=qEl.querySelector('input[type=radio]:checked');
      qEl.querySelectorAll('.opt').forEach(o=>o.classList.remove('correct','wrong'));
      if(!chosen)return;
      const idx=+chosen.value;const correct=questions[i].correct;
      const labs=[...qEl.querySelectorAll('.opt')];
      labs[idx].classList.add(idx===correct?'correct':'wrong');
      labs[correct].classList.add('correct');
      if(idx===correct) right++;
    });
    scoreEl.textContent=`Score: ${right}/${total}`;
  });
})();
</script>
</body>
</html>
