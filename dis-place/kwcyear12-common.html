<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Year 12 Common Room Display</title>
  <style>
    :root {
      --bg-primary: #1a1a2e;
      --bg-secondary: #16213e;
      --bg-card: #1f2940;
      --text-primary: #f0f0f0;
      --text-secondary: #f0f0f0;
      --text-muted: #d0d0e0;
      --accent: #4a90d9;
      --accent-glow: rgba(74, 144, 217, 0.3);
      --progress-bg: #2a2a4a;
      --progress-fill: linear-gradient(90deg, #4a90d9, #64b5f6);
      --success: #4caf50;
      --warning: #ff9800;
      --marker-color: #ff9800;

      --font-main: 'Segoe UI', system-ui, -apple-system, sans-serif;
      --transition-smooth: 0.5s ease-in-out;
      --text-scale: 1.8;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      width: 100%;
      height: 100%;
      overflow: hidden;
      background: var(--bg-primary);
      color: var(--text-primary);
      font-family: var(--font-main);
    }

    body {
      display: flex;
      flex-direction: column;
      padding: clamp(1rem, 3vmin, 2rem);
      gap: clamp(0.5rem, 2vmin, 1.5rem);
    }

    /* Header - Room name and date */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-shrink: 0;
    }

    .room-name {
      font-size: calc(clamp(1.5rem, 5vmin, 3rem) * var(--text-scale));
      font-weight: 300;
      letter-spacing: 0.05em;
      color: var(--text-primary);
    }

    .date-display {
      text-align: right;
    }

    .date-text {
      font-size: calc(clamp(1.3rem, 4vmin, 2.4rem) * var(--text-scale));
      font-weight: 300;
      color: var(--text-secondary);
    }

    .season-text {
      font-size: calc(clamp(1rem, 3vmin, 1.8rem) * var(--text-scale));
      color: var(--accent);
      margin-top: 0.25em;
      font-style: italic;
    }

    /* Weather display */
    .weather-display {
      font-size: calc(clamp(1rem, 2.5vmin, 1.6rem) * var(--text-scale));
      color: var(--text-muted);
      margin-top: 0.5em;
      opacity: 0;
      transition: opacity 0.5s ease;
    }

    .weather-display.visible {
      opacity: 1;
    }

    .weather-display span {
      margin-left: 1em;
    }

    .weather-display span:first-child {
      margin-left: 0;
    }

    /* Year progress bar with markers */
    .year-progress-section {
      flex-shrink: 0;
    }

    .year-progress-label {
      font-size: calc(clamp(1rem, 2.5vmin, 1.6rem) * var(--text-scale));
      color: var(--text-muted);
      margin-bottom: 0.5em;
      display: flex;
      justify-content: space-between;
    }

    .progress-bar-container {
      position: relative;
      padding-top: 3.5em;
      padding-bottom: 1.5em;
    }

    .progress-bar {
      height: clamp(0.8rem, 2vmin, 1.4rem);
      background: var(--progress-bg);
      border-radius: 1rem;
      overflow: visible;
      position: relative;
    }

    .progress-fill {
      height: 100%;
      background: var(--progress-fill);
      border-radius: 1rem;
      transition: width 1s ease-out;
    }

    /* Sparkler canvas overlay */
    .sparkler-canvas {
      position: absolute;
      top: 50%;
      left: 0;
      transform: translateY(-50%);
      pointer-events: none;
      z-index: 10;
    }

    .progress-bar-large {
      height: clamp(1rem, 3vmin, 2rem);
    }

    .progress-bar-large .progress-fill {
      box-shadow: 0 0 20px var(--accent-glow);
    }

    /* Key date markers */
    .key-date-marker {
      position: absolute;
      top: 50%;
      transform: translateX(-50%);
      width: 4px;
      height: 150%;
      background: var(--marker-color);
      border-radius: 2px;
    }

    .key-date-label {
      position: absolute;
      left: 50%;
      transform: translateX(-50%);
      font-size: calc(clamp(0.6rem, 1.3vmin, 0.85rem) * var(--text-scale));
      color: var(--text-muted);
      white-space: nowrap;
      text-align: center;
      font-family: 'Arial Narrow', 'Helvetica Neue', Arial, sans-serif;
      font-stretch: condensed;
      letter-spacing: -0.02em;
    }

    .key-date-label.above {
      bottom: 100%;
      margin-bottom: 8px;
    }

    .key-date-label.above2 {
      bottom: 100%;
      margin-bottom: 28px;
    }

    .key-date-label.below {
      top: 100%;
      margin-top: 8px;
    }

    .key-date-label.below2 {
      top: 100%;
      margin-top: 28px;
    }

    .key-date-marker.past {
      opacity: 0.4;
    }

    .key-date-marker.today {
      background: var(--success);
      width: 6px;
    }

    .key-date-marker.today .key-date-label {
      color: var(--success);
      font-weight: 500;
    }

    /* Main content area */
    .main-content {
      flex: 1;
      display: flex;
      flex-direction: column;
      justify-content: flex-start;
      align-items: center;
      min-height: 0;
      position: relative;
      padding-top: 0.5em;
    }

    /* Current period display */
    .current-display {
      width: 100%;
      max-width: 90%;
      text-align: center;
      transition: opacity var(--transition-smooth);
    }

    .current-display.fade-out {
      opacity: 0;
    }

    .time-display {
      font-size: calc(clamp(2.2rem, 8vmin, 5rem) * var(--text-scale));
      font-weight: 200;
      letter-spacing: 0.02em;
      color: var(--text-primary);
      line-height: 1;
    }

    .period-name {
      font-size: calc(clamp(1rem, 3vmin, 2rem) * var(--text-scale));
      color: var(--text-secondary);
      margin-top: 0.15em;
      font-weight: 300;
    }

    .class-info {
      font-size: calc(clamp(1rem, 3vmin, 2rem) * var(--text-scale));
      color: var(--accent);
      margin-top: 0.2em;
      font-weight: 400;
    }

    .activity-display {
      font-size: calc(clamp(1.8rem, 6vmin, 4rem) * var(--text-scale));
      font-weight: 600;
      color: var(--text-primary);
      margin-top: 0.15em;
      line-height: 1.1;
      text-shadow: 0 0 40px var(--accent-glow);
    }

    /* Period progress section */
    .period-progress-section {
      width: 100%;
      max-width: 80%;
      margin-top: clamp(0.3rem, 1vmin, 0.8rem);
    }

    .period-progress-label {
      font-size: calc(clamp(0.8rem, 1.5vmin, 1.2rem) * var(--text-scale));
      color: var(--text-muted);
      margin-bottom: 0.2em;
      display: flex;
      justify-content: space-between;
    }

    /* Upcoming events overlay */
    .upcoming-overlay {
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      background: var(--bg-primary);
      opacity: 0;
      pointer-events: none;
      transition: opacity var(--transition-smooth);
      text-align: center;
      padding: clamp(1rem, 3vmin, 2rem);
    }

    .upcoming-overlay.visible {
      opacity: 1;
    }

    .upcoming-label {
      font-size: calc(clamp(1.3rem, 4vmin, 2.4rem) * var(--text-scale));
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.2em;
      margin-bottom: 1em;
    }

    .upcoming-description {
      font-size: calc(clamp(1.4rem, 4.5vmin, 3rem) * var(--text-scale));
      font-weight: 500;
      color: var(--text-primary);
      line-height: 1.2;
      max-width: 90%;
    }

    .upcoming-description.quote-medium {
      font-size: calc(clamp(1.1rem, 3.5vmin, 2.2rem) * var(--text-scale));
    }

    .upcoming-description.quote-small {
      font-size: calc(clamp(0.85rem, 2.5vmin, 1.6rem) * var(--text-scale));
    }

    .upcoming-date {
      font-size: calc(clamp(1.8rem, 6vmin, 3.5rem) * var(--text-scale));
      color: var(--accent);
      margin-top: 0.75em;
      font-weight: 300;
      font-style: italic;
    }

    /* Good news ticker */
    .news-section {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      background: var(--bg-secondary);
      border-top: 1px solid var(--accent-glow);
      padding: 0.5em 1em;
      display: flex;
      align-items: center;
      gap: 1em;
      opacity: 0;
      transition: opacity 0.5s ease;
    }

    .news-section.visible {
      opacity: 1;
    }

    .news-label {
      font-size: calc(clamp(1.2rem, 3vmin, 2rem) * var(--text-scale));
      color: var(--accent);
      font-weight: 500;
      white-space: nowrap;
    }

    .news-content {
      flex: 1;
      font-size: calc(clamp(1.2rem, 3vmin, 2rem) * var(--text-scale));
      color: var(--text-primary);
      overflow: hidden;
    }

    .news-item {
      opacity: 0;
      transition: opacity 0.5s ease;
    }

    .news-item.visible {
      opacity: 1;
    }

    /* Empty state - no class */
    .empty-state .activity-display,
    .empty-state .class-info {
      display: none;
    }

    .empty-state .time-display {
      font-size: calc(clamp(4rem, 15vmin, 12rem) * var(--text-scale));
    }

    .empty-state .period-name {
      color: var(--text-muted);
    }

    /* Outside school hours */
    .outside-hours .period-name {
      color: var(--text-muted);
    }

    /* Loading state */
    .loading {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100%;
      font-size: calc(clamp(1.5rem, 4vmin, 2.5rem) * var(--text-scale));
      color: var(--text-muted);
    }

    /* Error state */
    .error-message {
      color: var(--warning);
      font-size: calc(clamp(1.2rem, 3vmin, 2rem) * var(--text-scale));
      text-align: center;
      padding: 1rem;
    }

    /* Preview mode indicator */
    .preview-indicator {
      position: fixed;
      bottom: clamp(1rem, 3vmin, 2rem);
      left: 50%;
      transform: translateX(-50%);
      background: rgba(255, 152, 0, 0.9);
      color: #000;
      padding: 0.5em 1.5em;
      border-radius: 2rem;
      font-size: calc(clamp(1rem, 2.5vmin, 1.6rem) * var(--text-scale));
      font-weight: 500;
      opacity: 0;
      transition: opacity 0.3s ease;
      z-index: 100;
      display: flex;
      align-items: center;
      gap: 0.75em;
    }

    .preview-indicator.visible {
      opacity: 1;
    }

    .preview-indicator kbd {
      background: rgba(0, 0, 0, 0.2);
      padding: 0.2em 0.5em;
      border-radius: 0.25rem;
      font-family: inherit;
      font-size: 0.85em;
    }

    /* Smooth animations */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        transition-duration: 0.01ms !important;
        animation-duration: 0.01ms !important;
      }
    }

    /* High contrast for projector readability */
    @media (prefers-contrast: more) {
      :root {
        --text-primary: #ffffff;
        --text-secondary: #cccccc;
        --bg-primary: #000000;
      }
    }

    /* First run overlay */
    .first-run-overlay {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0, 0, 0, 0.95);
      z-index: 1000;
      display: flex;
      justify-content: center;
      align-items: center;
      opacity: 1;
      transition: opacity 0.5s ease;
    }

    .first-run-overlay.hidden {
      opacity: 0;
      pointer-events: none;
    }

    .first-run-content {
      max-width: 800px;
      max-height: 90vh;
      overflow-y: auto;
      padding: 2rem 3rem;
      background: var(--bg-secondary);
      border-radius: 1rem;
      color: var(--text-primary);
      font-size: 1rem;
      line-height: 1.6;
    }

    .first-run-content h1 {
      font-size: 1.8rem;
      font-weight: 300;
      margin-bottom: 1rem;
      color: var(--accent);
    }

    .first-run-content h2 {
      font-size: 1.2rem;
      font-weight: 500;
      margin-top: 1.5rem;
      margin-bottom: 0.5rem;
      color: var(--text-primary);
    }

    .first-run-content p {
      margin-bottom: 0.75rem;
      color: var(--text-muted);
    }

    .first-run-content code {
      background: var(--bg-card);
      padding: 0.15em 0.4em;
      border-radius: 0.25rem;
      font-family: 'SF Mono', 'Monaco', 'Consolas', monospace;
      font-size: 0.9em;
      color: var(--accent);
    }

    .first-run-content ul {
      margin: 0.5rem 0 1rem 1.5rem;
      color: var(--text-muted);
    }

    .first-run-content li {
      margin-bottom: 0.4rem;
    }

    .first-run-content kbd {
      display: inline-block;
      background: var(--bg-card);
      border: 1px solid var(--text-muted);
      border-radius: 0.25rem;
      padding: 0.1em 0.5em;
      font-family: inherit;
      font-size: 0.85em;
      color: var(--text-primary);
    }

    .first-run-buttons {
      display: flex;
      justify-content: flex-end;
      gap: 1rem;
      margin-top: 2rem;
    }

    .first-run-btn {
      background: var(--accent);
      color: #fff;
      border: none;
      padding: 0.75em 1.5em;
      border-radius: 0.5rem;
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.2s ease;
    }

    .first-run-btn:hover {
      background: #5a9fe9;
    }

    .first-run-btn.secondary {
      background: transparent;
      border: 1px solid var(--text-muted);
      color: var(--text-muted);
    }

    .first-run-btn.secondary:hover {
      border-color: var(--text-primary);
      color: var(--text-primary);
    }
  </style>
</head>
<body>
  <!-- First Run Admin Guide -->
  <div class="first-run-overlay" id="first-run-overlay">
    <div class="first-run-content">
      <h1>Welcome to Year 12 Common Room Display</h1>
      <p>This display shows the current time, period schedule, Year 12 progress toward final exams, and rotating inspirational quotes.</p>

      <h2>Data Configuration</h2>
      <p>The display reads from <code>data.json</code> in the same folder. You can edit this file to customise:</p>
      <ul>
        <li><strong>Room name</strong> &mdash; displayed in the header</li>
        <li><strong>Upcoming events</strong> &mdash; shown periodically as overlays</li>
        <li><strong>Key dates</strong> &mdash; marked on the Year 12 progress bar (hardcoded dates override these)</li>
      </ul>
      <p>Use the companion <code>editor.html</code> to edit <code>data.json</code> visually.</p>

      <h2>Keyboard Shortcuts</h2>
      <ul>
        <li><kbd>1</kbd> &ndash; <kbd>9</kbd> &mdash; Adjust text scale (1=smallest, 9=largest)</li>
        <li><kbd>&larr;</kbd> / <kbd>&rarr;</kbd> &mdash; Preview previous/next period</li>
        <li><kbd>Shift</kbd> + <kbd>&larr;</kbd> / <kbd>&rarr;</kbd> &mdash; Preview previous/next day</li>
        <li><kbd>Ctrl/Cmd</kbd> + <kbd>&larr;</kbd> / <kbd>&rarr;</kbd> &mdash; Preview previous/next week</li>
        <li><kbd>Esc</kbd> &mdash; Exit preview mode</li>
        <li><kbd>Q</kbd> &mdash; Show next quote</li>
        <li><kbd>D</kbd> &mdash; Show This Day in History (Australian focus)</li>
        <li><kbd>V</kbd> &mdash; Show Word of the Day (vocabulary)</li>
        <li><kbd>N</kbd> &mdash; Toggle good news ticker (off by default)</li>
        <li><kbd>?</kbd> &mdash; Show this guide again</li>
      </ul>

      <h2>Features</h2>
      <ul>
        <li><strong>Year 12 Progress Bar</strong> &mdash; Shows progress from start of school year to final exams with key date markers</li>
        <li><strong>Sparkler Effect</strong> &mdash; Animated sparks on the progress bar that pulse and intensify as exams approach</li>
        <li><strong>Wurundjeri Seasons</strong> &mdash; Displays the current Indigenous season for Naarm (Melbourne)</li>
        <li><strong>Weather</strong> &mdash; Shows current Melbourne weather conditions</li>
        <li><strong>Quotes</strong> &mdash; 106 inspirational quotes rotate automatically every few minutes</li>
        <li><strong>This Day in History</strong> &mdash; 366 historical events with Australian/positive focus (press D)</li>
        <li><strong>Word of the Day</strong> &mdash; 366 positive psychology and social vocabulary words (press V)</li>
        <li><strong>Good News</strong> &mdash; Positive news headlines from Good News Network (press N to enable)</li>
      </ul>

      <div class="first-run-buttons">
        <button class="first-run-btn secondary" id="first-run-later">Show Again Later</button>
        <button class="first-run-btn" id="first-run-dismiss">Got It</button>
      </div>
    </div>
  </div>

  <div class="loading" id="loading">Loading...</div>

  <header class="header" id="header" style="display: none;">
    <h1 class="room-name" id="room-name">Year 12 Common Room</h1>
    <div class="date-display">
      <div class="date-text" id="date-text"></div>
      <div class="season-text" id="season-text"></div>
      <div class="weather-display" id="weather-display"></div>
    </div>
  </header>

  <section class="year-progress-section" id="year-progress-section" style="display: none;">
    <div class="year-progress-label">
      <span>Year 12 Progress</span>
      <span id="year-progress-percent">0%</span>
    </div>
    <div class="progress-bar-container">
      <div class="progress-bar" id="progress-bar">
        <div class="progress-fill" id="year-progress-fill" style="width: 0%;"></div>
        <canvas class="sparkler-canvas" id="sparkler-canvas"></canvas>
      </div>
    </div>
  </section>

  <main class="main-content" id="main-content" style="display: none;">
    <div class="current-display" id="current-display">
      <div class="time-display" id="time-display">--:--</div>
      <div class="period-name" id="period-name"></div>
      <div class="class-info" id="class-info"></div>
      <div class="activity-display" id="activity-display"></div>

      <div class="period-progress-section" id="period-progress-section">
        <div class="period-progress-label">
          <span id="period-start-time"></span>
          <span id="period-end-time"></span>
        </div>
        <div class="progress-bar progress-bar-large">
          <div class="progress-fill" id="period-progress-fill" style="width: 0%;"></div>
        </div>
      </div>
    </div>

    <div class="upcoming-overlay" id="upcoming-overlay">
      <div class="upcoming-label" id="upcoming-label">Upcoming</div>
      <div class="upcoming-description" id="upcoming-description"></div>
      <div class="upcoming-date" id="upcoming-date"></div>
    </div>
  </main>

  <div class="news-section" id="news-section">
    <span class="news-label">GOOD NEWS:</span>
    <div class="news-content">
      <span class="news-item" id="news-item"></span>
    </div>
  </div>

  <div class="preview-indicator" id="preview-indicator">
    <span id="preview-text">Previewing</span>
    <kbd>Esc</kbd> to return
  </div>

  <script>
    'use strict';

    // ============================================
    // CONFIGURATION
    // ============================================
    const CONFIG = {
      dataUrl: 'data.json',
      refreshIntervalMs: 60 * 60 * 1000, // 1 hour
      updateIntervalMs: 1000, // Update display every second
      upcomingShowDurationMs: 10 * 1000, // 10 seconds
      upcomingIntervalMs: 3 * 60 * 1000, // Every 3 minutes
      morningRefreshHour: 8,
      morningRefreshMinute: 15,
      quoteShowDurationMs: 15 * 1000, // 15 seconds
      quoteIntervalMs: 5 * 60 * 1000, // Every 5 minutes (average)
      newsRefreshMs: 30 * 60 * 1000, // News refresh every 30 min
    };

    // ============================================
    // HARDCODED KEY DATES FOR YEAR 12
    // ============================================
    const HARDCODED_KEY_DATES = [
      { date: '2026-02-27', description: 'Formal', position: 'above' },
      { date: '2026-05-30', description: 'Free Day', position: 'below' },
      { date: '2026-06-16', description: 'GAT', position: 'above' },
      { date: '2026-10-01', description: 'Trials', position: 'below' },
      { date: '2026-10-05', description: 'Orals', position: 'above2' },
      { date: '2026-10-16', description: 'Last Day', position: 'above' },
      { date: '2026-10-19', description: 'Final', position: 'below' },
      { date: '2026-10-20', description: 'SWOT', position: 'below2' },
      { date: '2026-10-27', description: 'Exams', position: 'above' },
      { date: '2026-11-10', description: 'Exams', position: 'below' },
      { date: '2026-11-18', description: 'Done!', position: 'above' },
    ];

    // ============================================
    // SCHEDULE DEFINITION
    // ============================================
    const SCHEDULE = [
      { name: 'Morning Greeting', start: '08:20', end: '08:30', period: null },
      { name: 'Period 1', start: '08:30', end: '09:20', period: 'P1' },
      { name: 'Period 2', start: '09:20', end: '10:10', period: 'P2' },
      { name: 'Recess', start: '10:10', end: '10:30', period: null },
      { name: 'Period 3', start: '10:30', end: '11:20', period: 'P3' },
      { name: 'Period 4', start: '11:20', end: '12:10', period: 'P4' },
      { name: 'Period 12:10', start: '12:10', end: '12:50', period: 'P12:10' },
      { name: 'Lunch', start: '12:50', end: '13:30', period: null },
      { name: 'Period 5', start: '13:30', end: '14:20', period: 'P5' },
      { name: 'Period 6', start: '14:20', end: '15:10', period: 'P6' }
    ];

    // ============================================
    // WURUNDJERI SEASONS (Kulin Nation)
    // ============================================
    const WURUNDJERI_SEASONS = [
      { name: 'Biderap', meaning: 'Dry Season', startMonth: 1, startDay: 1, endMonth: 2, endDay: 14 },
      { name: 'Iuk', meaning: 'Eel Season', startMonth: 2, startDay: 15, endMonth: 3, endDay: 31 },
      { name: 'Waring', meaning: 'Wombat Season', startMonth: 4, startDay: 1, endMonth: 4, endDay: 30 },
      { name: 'Guling', meaning: 'Orchid Season', startMonth: 5, startDay: 1, endMonth: 7, endDay: 14 },
      { name: 'Poorneet', meaning: 'Tadpole Season', startMonth: 7, startDay: 15, endMonth: 9, endDay: 14 },
      { name: 'Buath Gurru', meaning: 'Grass Flowering Season', startMonth: 9, startDay: 15, endMonth: 11, endDay: 14 },
      { name: 'Kangaroo Apple Season', meaning: 'Kangaroo Apple Season', startMonth: 11, startDay: 15, endMonth: 12, endDay: 31 }
    ];

    // ============================================
    // DEFAULT THEME
    // ============================================
    const DEFAULT_THEME = {
      accent: '#4a90d9',
      glow: 'rgba(74, 144, 217, 0.3)'
    };

    // ============================================
    // STATE
    // ============================================
    let appData = null;
    let keyDates = [...HARDCODED_KEY_DATES];
    let currentUpcomingIndex = 0;
    let showingUpcoming = false;
    let lastRefreshDate = null;
    let currentTheme = DEFAULT_THEME;
    let newsHeadlines = [];

    // Preview mode state
    let previewMode = false;
    let previewDate = null;
    let previewPeriodIndex = 0;

    // Text scale: keys 1-9 map to scale factors 0.6 to 2.2
    const TEXT_SCALE_MAP = {
      '1': 0.6, '2': 0.8, '3': 1.0, '4': 1.2,
      '5': 1.4, '6': 1.6, '7': 1.8, '8': 2.0, '9': 2.2
    };

    // ============================================
    // DOM ELEMENTS
    // ============================================
    const elements = {
      loading: document.getElementById('loading'),
      header: document.getElementById('header'),
      roomName: document.getElementById('room-name'),
      dateText: document.getElementById('date-text'),
      seasonText: document.getElementById('season-text'),
      yearProgressSection: document.getElementById('year-progress-section'),
      yearProgressFill: document.getElementById('year-progress-fill'),
      yearProgressPercent: document.getElementById('year-progress-percent'),
      progressBar: document.getElementById('progress-bar'),
      sparklerCanvas: document.getElementById('sparkler-canvas'),
      mainContent: document.getElementById('main-content'),
      currentDisplay: document.getElementById('current-display'),
      timeDisplay: document.getElementById('time-display'),
      periodName: document.getElementById('period-name'),
      classInfo: document.getElementById('class-info'),
      activityDisplay: document.getElementById('activity-display'),
      periodProgressSection: document.getElementById('period-progress-section'),
      periodProgressFill: document.getElementById('period-progress-fill'),
      periodStartTime: document.getElementById('period-start-time'),
      periodEndTime: document.getElementById('period-end-time'),
      upcomingOverlay: document.getElementById('upcoming-overlay'),
      upcomingLabel: document.getElementById('upcoming-label'),
      upcomingDescription: document.getElementById('upcoming-description'),
      upcomingDate: document.getElementById('upcoming-date'),
      weatherDisplay: document.getElementById('weather-display'),
      previewIndicator: document.getElementById('preview-indicator'),
      previewText: document.getElementById('preview-text'),
      newsSection: document.getElementById('news-section'),
      newsItem: document.getElementById('news-item'),
    };

    // ============================================
    // UTILITY FUNCTIONS
    // ============================================
    function parseTime(timeStr) {
      const [hours, minutes] = timeStr.split(':').map(Number);
      return { hours, minutes };
    }

    function timeToMinutes(timeStr) {
      const { hours, minutes } = parseTime(timeStr);
      return hours * 60 + minutes;
    }

    function formatTime12Hour(date) {
      let hours = date.getHours();
      const minutes = date.getMinutes();
      const ampm = hours >= 12 ? 'PM' : 'AM';
      hours = hours % 12;
      hours = hours ? hours : 12;
      const minutesStr = minutes < 10 ? '0' + minutes : minutes;
      return `${hours}:${minutesStr} ${ampm}`;
    }

    function formatTime12HourShort(timeStr) {
      const { hours, minutes } = parseTime(timeStr);
      const ampm = hours >= 12 ? 'PM' : 'AM';
      const hour12 = hours % 12 || 12;
      const minutesStr = minutes < 10 ? '0' + minutes : minutes;
      return `${hour12}:${minutesStr} ${ampm}`;
    }

    function formatDateLong(date) {
      const options = { weekday: 'long', day: 'numeric', month: 'long', year: 'numeric' };
      return date.toLocaleDateString('en-AU', options);
    }

    function formatDateShort(dateStr) {
      const date = new Date(dateStr + 'T00:00:00');
      const options = { weekday: 'short', day: 'numeric', month: 'short' };
      return date.toLocaleDateString('en-AU', options);
    }

    function getDateString(date) {
      const year = date.getFullYear();
      const month = String(date.getMonth() + 1).padStart(2, '0');
      const day = String(date.getDate()).padStart(2, '0');
      return `${year}-${month}-${day}`;
    }

    // ============================================
    // WURUNDJERI SEASON
    // ============================================
    function getWurundjeriSeason(date) {
      const month = date.getMonth() + 1;
      const day = date.getDate();

      for (const season of WURUNDJERI_SEASONS) {
        const afterStart = month > season.startMonth ||
                          (month === season.startMonth && day >= season.startDay);
        const beforeEnd = month < season.endMonth ||
                         (month === season.endMonth && day <= season.endDay);

        if (season.startMonth <= season.endMonth) {
          if (afterStart && beforeEnd) {
            return season;
          }
        } else {
          if (afterStart || beforeEnd) {
            return season;
          }
        }
      }

      return WURUNDJERI_SEASONS[0];
    }

    // ============================================
    // YEAR PROGRESS WITH KEY DATE MARKERS
    // ============================================
    function getYearBounds() {
      // Year 12 specific: Feb 3 start to Nov 18 (VCAA exams conclude)
      const yearStart = new Date('2026-02-03T00:00:00');
      const yearEnd = new Date('2026-11-18T23:59:59');
      return { yearStart, yearEnd };
    }

    function calculateYearProgress(date) {
      const { yearStart, yearEnd } = getYearBounds();

      if (date < yearStart) return 0;
      if (date > yearEnd) return 100;

      const totalDuration = yearEnd - yearStart;
      const elapsed = date - yearStart;

      return Math.min(100, Math.max(0, (elapsed / totalDuration) * 100));
    }

    function renderKeyDateMarkers() {
      const { yearStart, yearEnd } = getYearBounds();
      const totalDuration = yearEnd - yearStart;
      const todayStr = getDateString(new Date());
      const container = elements.progressBar.parentElement;

      // Remove existing markers
      container.querySelectorAll('.key-date-marker').forEach(m => m.remove());

      keyDates.forEach((keyDate, index) => {
        const eventDate = new Date(keyDate.date + 'T00:00:00');
        if (eventDate < yearStart || eventDate > yearEnd) return;

        const position = ((eventDate - yearStart) / totalDuration) * 100;

        const marker = document.createElement('div');
        marker.className = 'key-date-marker';

        if (keyDate.date < todayStr) {
          marker.classList.add('past');
        } else if (keyDate.date === todayStr) {
          marker.classList.add('today');
        }

        marker.style.left = `${position}%`;

        // Use specified position or default to alternating
        const label = document.createElement('div');
        label.className = 'key-date-label';
        label.textContent = keyDate.description;

        const labelPosition = keyDate.position || (index % 2 === 0 ? 'above' : 'below');
        label.classList.add(labelPosition);

        marker.appendChild(label);
        elements.progressBar.appendChild(marker);
      });
    }

    // ============================================
    // SPARKLER ANIMATION
    // ============================================
    const sparks = [];
    let sparklerCtx = null;
    let currentYearProgress = 0;
    let sparklerStartTime = Date.now();

    function initSparkler() {
      const canvas = elements.sparklerCanvas;
      const progressBar = elements.progressBar;

      // Size canvas to match progress bar container area
      const barRect = progressBar.getBoundingClientRect();
      const barHeight = barRect.height;

      // Canvas height scales from 1x to 3x bar height based on progress
      const maxCanvasHeight = barHeight * 6; // Allow room for 3x on each side
      canvas.width = barRect.width;
      canvas.height = maxCanvasHeight;
      canvas.style.height = `${maxCanvasHeight}px`;
      canvas.style.width = `${barRect.width}px`;

      sparklerCtx = canvas.getContext('2d');
      sparklerStartTime = Date.now();
    }

    // Get sinusoidal pulse multiplier (1x to 10x over 10 second period)
    function getPulseMultiplier() {
      const elapsed = (Date.now() - sparklerStartTime) / 1000; // seconds
      const period = 10; // 10 second period
      // Sinusoidal from 1 to 10: base + amplitude * (sin + 1) / 2
      // sin goes -1 to 1, so (sin + 1) / 2 goes 0 to 1
      // We want 1 to 10, so: 1 + 9 * (sin + 1) / 2 = 1 + 4.5 * (sin + 1)
      const sineValue = Math.sin((elapsed / period) * Math.PI * 2);
      return 1 + 4.5 * (sineValue + 1); // ranges from 1 to 10
    }

    function createSpark(x, progress, pulseMultiplier) {
      // Scale intensity from 1x to 3x based on progress
      const intensityScale = 1 + (progress / 100) * 2;
      const canvasHeight = elements.sparklerCanvas.height;
      const centerY = canvasHeight / 2;

      // Random angle for spark direction (full 360 degrees)
      const angle = Math.random() * Math.PI * 2;
      // Speed scales with progress
      const speed = (2 + Math.random() * 4) * intensityScale;
      // Spark size scales with progress
      const size = (1 + Math.random() * 2) * intensityScale;

      // White or gold color (randomly choose)
      const isWhite = Math.random() < 0.4; // 40% white, 60% gold

      return {
        x: x,
        y: centerY,
        vx: Math.cos(angle) * speed,
        vy: Math.sin(angle) * speed,
        size: size,
        life: 1.0,
        decay: 0.015 + Math.random() * 0.025,
        isWhite: isWhite,
        // Gold hue range: 40-50 (golden yellow)
        hue: isWhite ? 0 : (40 + Math.random() * 10),
      };
    }

    function updateSparkler(progress) {
      if (!sparklerCtx) return;

      currentYearProgress = progress;

      const canvas = elements.sparklerCanvas;

      // Calculate spark emission point (at the progress position)
      const sparkX = (progress / 100) * canvas.width;

      // Get pulse multiplier for sinusoidal variation
      const pulseMultiplier = getPulseMultiplier();

      // Base spawn rate scales with progress (more sparks as we get closer to Done!)
      // 10x intensity increase
      const baseSpawnRate = (1 + (progress / 100) * 4) * 10;
      // Apply pulse multiplier to spawn rate
      const spawnRate = Math.floor(baseSpawnRate * pulseMultiplier);

      // Create new sparks
      for (let i = 0; i < spawnRate; i++) {
        if (Math.random() < 0.7) { // 70% chance each frame
          sparks.push(createSpark(sparkX, progress, pulseMultiplier));
        }
      }
    }

    function renderSparkler() {
      if (!sparklerCtx) return;

      const canvas = elements.sparklerCanvas;
      const ctx = sparklerCtx;

      // Clear canvas
      ctx.clearRect(0, 0, canvas.width, canvas.height);

      // Update and draw sparks
      for (let i = sparks.length - 1; i >= 0; i--) {
        const spark = sparks[i];

        // Update position
        spark.x += spark.vx;
        spark.y += spark.vy;
        spark.vy += 0.1; // Gravity
        spark.life -= spark.decay;

        // Remove dead sparks
        if (spark.life <= 0) {
          sparks.splice(i, 1);
          continue;
        }

        // Draw spark with 35% opacity
        const alpha = spark.life * 0.35;
        ctx.beginPath();
        ctx.arc(spark.x, spark.y, spark.size, 0, Math.PI * 2);

        // Bright core - white or gold
        const gradient = ctx.createRadialGradient(
          spark.x, spark.y, 0,
          spark.x, spark.y, spark.size
        );

        if (spark.isWhite) {
          // Pure white spark
          gradient.addColorStop(0, `rgba(255, 255, 255, ${alpha})`);
          gradient.addColorStop(0.4, `rgba(240, 240, 255, ${alpha * 0.8})`);
          gradient.addColorStop(1, `rgba(200, 200, 255, 0)`);
        } else {
          // Gold spark
          gradient.addColorStop(0, `hsla(${spark.hue}, 100%, 90%, ${alpha})`);
          gradient.addColorStop(0.4, `hsla(${spark.hue}, 100%, 65%, ${alpha * 0.8})`);
          gradient.addColorStop(1, `hsla(${spark.hue}, 100%, 50%, 0)`);
        }

        ctx.fillStyle = gradient;
        ctx.fill();

        // Add glow effect
        ctx.beginPath();
        ctx.arc(spark.x, spark.y, spark.size * 2, 0, Math.PI * 2);
        if (spark.isWhite) {
          ctx.fillStyle = `rgba(255, 255, 255, ${alpha * 0.3})`;
        } else {
          ctx.fillStyle = `hsla(${spark.hue}, 100%, 75%, ${alpha * 0.3})`;
        }
        ctx.fill();
      }

      requestAnimationFrame(renderSparkler);
    }

    function startSparkler() {
      initSparkler();
      renderSparkler();

      // Reinit on resize
      window.addEventListener('resize', () => {
        setTimeout(initSparkler, 100);
      });
    }

    // ============================================
    // SCHEDULE FUNCTIONS
    // ============================================
    function getCurrentScheduleSlot(date) {
      const currentMinutes = date.getHours() * 60 + date.getMinutes();

      for (const slot of SCHEDULE) {
        const startMinutes = timeToMinutes(slot.start);
        const endMinutes = timeToMinutes(slot.end);

        if (currentMinutes >= startMinutes && currentMinutes < endMinutes) {
          return slot;
        }
      }

      return null;
    }

    function getSlotProgress(slot, date) {
      const currentMinutes = date.getHours() * 60 + date.getMinutes() + date.getSeconds() / 60;
      const startMinutes = timeToMinutes(slot.start);
      const endMinutes = timeToMinutes(slot.end);

      const progress = ((currentMinutes - startMinutes) / (endMinutes - startMinutes)) * 100;
      return Math.min(100, Math.max(0, progress));
    }

    // ============================================
    // UPCOMING EVENTS
    // ============================================
    function getUpcomingEvents() {
      const today = new Date();
      today.setHours(0, 0, 0, 0);

      // Use appData upcoming if available, otherwise hardcoded
      const events = (appData && appData.upcoming) ? appData.upcoming : keyDates;

      return events
        .filter(event => new Date(event.date + 'T00:00:00') >= today)
        .sort((a, b) => new Date(a.date) - new Date(b.date));
    }

    let overlayBusy = false;

    function showUpcomingEvent() {
      if (overlayBusy || previewMode) return;

      const upcoming = getUpcomingEvents();
      if (upcoming.length === 0) return;

      overlayBusy = true;
      showingUpcoming = true;

      const event = upcoming[currentUpcomingIndex % upcoming.length];

      elements.upcomingLabel.textContent = 'Upcoming';
      elements.upcomingDescription.textContent = event.description;
      elements.upcomingDate.textContent = formatDateShort(event.date);

      elements.currentDisplay.classList.add('fade-out');

      setTimeout(() => {
        elements.upcomingOverlay.classList.add('visible');
      }, 500);

      setTimeout(() => {
        hideUpcomingEvent();
        currentUpcomingIndex++;
      }, CONFIG.upcomingShowDurationMs);
    }

    function hideUpcomingEvent() {
      elements.upcomingOverlay.classList.remove('visible');

      setTimeout(() => {
        elements.currentDisplay.classList.remove('fade-out');
        showingUpcoming = false;
        overlayBusy = false;
      }, 500);
    }

    // ============================================
    // QUOTES
    // ============================================
    const QUOTES = [
      // === PERSEVERANCE ===
      { text: "It does not matter how slowly you go as long as you do not stop.", author: "Confucius" },
      { text: "Perseverance is not a long race; it is many short races one after the other.", author: "Walter Elliot" },
      { text: "Fall seven times, stand up eight.", author: "Japanese Proverb" },
      { text: "Success is not final, failure is not fatal: it is the courage to continue that counts.", author: "Winston Churchill" },
      { text: "The oak fought the wind and was broken, the willow bent when it must and survived.", author: "Robert Jordan" },
      { text: "Our greatest glory is not in never falling, but in rising every time we fall.", author: "Confucius" },
      { text: "It always seems impossible until it's done.", author: "Nelson Mandela" },
      { text: "A river cuts through rock not because of its power but because of its persistence.", author: null },
      { text: "Patience and perseverance have a magical effect.", author: "John Quincy Adams" },
      { text: "The only way to guarantee failure is to quit.", author: null },
      { text: "Perseverance is the hard work you do after you get tired of doing the hard work you already did.", author: "Newt Gingrich" },
      { text: "Many of life's failures are people who did not realise how close they were to success when they gave up.", author: "Thomas Edison" },
      { text: "When you get into a tight place and everything goes against you, never give up then, for that is just the place and time that the tide will turn.", author: "Harriet Beecher Stowe" },
      { text: "Persistence can change failure into extraordinary achievement.", author: "Marv Levy" },
      { text: "A smooth sea never made a skilled sailor.", author: null },
      { text: "Be patient with yourself. Nothing in nature blooms all year.", author: null },
      { text: "If it doesn't challenge you, it doesn't change you.", author: null },
      { text: "The difference between a successful person and others is not a lack of strength, but rather a lack of will.", author: "Vince Lombardi" },
      { text: "Don't watch the clock; do what it does. Keep going.", author: "Sam Levenson" },
      { text: "Through perseverance many people win success out of what seemed destined to be certain failure.", author: "Benjamin Disraeli" },

      // === EXCELLENCE ===
      { text: "Excellence is not a skill. It is an attitude.", author: "Ralph Marston" },
      { text: "We are what we repeatedly do. Excellence, then, is not an act, but a habit.", author: "Aristotle" },
      { text: "The secret of joy in work is contained in one word: excellence.", author: "Pearl S. Buck" },
      { text: "Excellence is doing ordinary things extraordinarily well.", author: "John W. Gardner" },
      { text: "Strive for excellence, not perfection.", author: "H. Jackson Brown Jr." },
      { text: "The quality of a person's life is in direct proportion to their commitment to excellence.", author: "Vince Lombardi" },
      { text: "Excellence is the gradual result of always striving to do better.", author: "Pat Riley" },
      { text: "If you are going to achieve excellence in big things, you develop the habit in little matters.", author: "Colin Powell" },
      { text: "Hard work beats talent when talent doesn't work hard.", author: "Tim Notke" },
      { text: "The pursuit of excellence is gratifying and healthy. The pursuit of perfection is frustrating and a waste of time.", author: "Ed Bliss" },
      { text: "Every expert was once a beginner.", author: null },
      { text: "The only way to do great work is to love what you do.", author: "Steve Jobs" },
      { text: "Excellence is not a destination but a continuous journey.", author: null },
      { text: "The beautiful thing about learning is that nobody can take it away from you.", author: "B.B. King" },
      { text: "The mind is not a vessel to be filled, but a fire to be kindled.", author: "Plutarch" },
      { text: "Live as if you were to die tomorrow. Learn as if you were to live forever.", author: "Mahatma Gandhi" },
      { text: "The important thing is not to stop questioning.", author: "Albert Einstein" },
      { text: "Somewhere, something incredible is waiting to be known.", author: "Carl Sagan" },
      { text: "Wonder is the beginning of wisdom.", author: "Socrates" },
      { text: "Look up at the stars and not down at your feet.", author: "Stephen Hawking" },

      // === RESPECT ===
      { text: "Respect for ourselves guides our morals; respect for others guides our manners.", author: "Laurence Sterne" },
      { text: "One of the most sincere forms of respect is actually listening to what another has to say.", author: "Bryant H. McGill" },
      { text: "I speak to everyone in the same way, whether he is the garbage man or the president of the university.", author: "Albert Einstein" },
      { text: "Treat people the way you want to be treated. Talk to people the way you want to be talked to.", author: null },
      { text: "Knowledge will give you power, but character will give you respect.", author: "Bruce Lee" },
      { text: "Respect is earned, honesty is appreciated, trust is gained, and loyalty is returned.", author: null },
      { text: "Everyone deserves respect, but not everyone will earn your trust.", author: null },
      { text: "Self-respect is the fruit of discipline; the sense of dignity grows with the ability to say no to oneself.", author: "Abraham Joshua Heschel" },
      { text: "He who loves others is constantly loved by them. He who respects others is constantly respected by them.", author: "Mencius" },
      { text: "Respect yourself enough to walk away from anything that no longer serves you, grows you, or makes you happy.", author: null },
      { text: "Respect is what we owe; love, what we give.", author: "Philip James Bailey" },
      { text: "When we treat people merely as they are, they will remain as they are. When we treat them as if they were what they should be, they will become what they should be.", author: "Ralph Waldo Emerson" },
      { text: "The truest form of love is how you behave toward someone, not how you feel about them.", author: "Steve Hall" },
      { text: "Strong people stand up for themselves. Stronger people stand up for others.", author: null },
      { text: "We rise by lifting others.", author: "Robert Ingersoll" },
      { text: "Alone we can do so little; together we can do so much.", author: "Helen Keller" },
      { text: "You belong here.", author: null },
      { text: "Your potential is enormous. Don't let anyone tell you otherwise.", author: null },
      { text: "You are in this classroom because you can do things here you can't do on your own.", author: null },

      // === COURAGE ===
      { text: "Courage is not the absence of fear, but the judgement that something else is more important.", author: "Ambrose Redmoon" },
      { text: "You gain strength, courage, and confidence by every experience in which you really stop to look fear in the face.", author: "Eleanor Roosevelt" },
      { text: "Courage is resistance to fear, mastery of fear, not absence of fear.", author: "Mark Twain" },
      { text: "Life shrinks or expands in proportion to one's courage.", author: "Ana√Øs Nin" },
      { text: "It takes courage to grow up and become who you really are.", author: "E.E. Cummings" },
      { text: "Have the courage to follow your heart and intuition. They somehow know what you truly want to become.", author: "Steve Jobs" },
      { text: "Courage is the most important of all the virtues because without courage, you can't practice any other virtue consistently.", author: "Maya Angelou" },
      { text: "Do one thing every day that scares you.", author: "Eleanor Roosevelt" },
      { text: "Being deeply loved by someone gives you strength, while loving someone deeply gives you courage.", author: "Lao Tzu" },
      { text: "You cannot swim for new horizons until you have courage to lose sight of the shore.", author: "William Faulkner" },
      { text: "Courage is found in unlikely places.", author: "J.R.R. Tolkien" },
      { text: "The brave may not live forever, but the cautious do not live at all.", author: null },
      { text: "Fortune favours the brave.", author: "Latin Proverb" },
      { text: "With courage you will dare to take risks, have the strength to be compassionate, and the wisdom to be humble.", author: "Keshavan Nair" },
      { text: "Courage doesn't always roar. Sometimes courage is the quiet voice at the end of the day saying, 'I will try again tomorrow.'", author: "Mary Anne Radmacher" },
      { text: "Dream big. Start small. Act now.", author: null },
      { text: "Believe you can and you're halfway there.", author: "Theodore Roosevelt" },
      { text: "Start where you are. Use what you have. Do what you can.", author: "Arthur Ashe" },
      { text: "The best way to predict your future is to create it.", author: null },
      { text: "You are more capable than you know.", author: null },

      // === KINDNESS ===
      { text: "In a world where you can be anything, be kind.", author: null },
      { text: "No act of kindness, no matter how small, is ever wasted.", author: "Aesop" },
      { text: "Be the reason someone smiles today.", author: null },
      { text: "Kindness is a language which the deaf can hear and the blind can see.", author: "Mark Twain" },
      { text: "A single act of kindness throws out roots in all directions, and the roots spring up and make new trees.", author: "Amelia Earhart" },
      { text: "Carry out a random act of kindness, with no expectation of reward, safe in the knowledge that one day someone might do the same for you.", author: "Princess Diana" },
      { text: "Kindness in words creates confidence. Kindness in thinking creates profoundness. Kindness in giving creates love.", author: "Lao Tzu" },
      { text: "Strong people lift others up.", author: null },
      { text: "The best portion of a good man's life is his little, nameless, unremembered acts of kindness and of love.", author: "William Wordsworth" },
      { text: "Remember there's no such thing as a small act of kindness. Every act creates a ripple with no logical end.", author: "Scott Adams" },
      { text: "How do we change the world? One random act of kindness at a time.", author: "Morgan Freeman" },
      { text: "Kindness is always fashionable, and always welcome.", author: "Amelia Barr" },
      { text: "Tenderness and kindness are not signs of weakness and despair, but manifestations of strength and resolution.", author: "Kahlil Gibran" },
      { text: "Wherever there is a human being, there is an opportunity for kindness.", author: "Seneca" },
      { text: "Be kind whenever possible. It is always possible.", author: "Dalai Lama" },
      { text: "Three things in human life are important: the first is to be kind; the second is to be kind; and the third is to be kind.", author: "Henry James" },
      { text: "What wisdom can you find that is greater than kindness?", author: "Jean-Jacques Rousseau" },
      { text: "Compassion is the basis of morality.", author: "Arthur Schopenhauer" },

      // === GENERAL LEARNING ===
      { text: "The person who asks a question is a fool for a minute. The person who doesn't is a fool for a lifetime.", author: null },
      { text: "Today is a good day to learn something new.", author: null },
      { text: "Progress, not perfection.", author: null },
      { text: "Done is better than perfect.", author: null },
      { text: "A year from now you will wish you had started today.", author: null },
      { text: "Stay curious. The answers will come.", author: null },
      { text: "Mistakes are proof that you are trying.", author: null },
      { text: "It's not about being perfect. It's about effort.", author: null },
      { text: "You don't have to be great to start, but you have to start to be great.", author: null },
    ];

    let currentQuoteIndex = 0;
    let showingQuote = false;
    let currentHistoryIndex = 0;
    let currentWordIndex = 0;

    // Create array of history keys for cycling through
    const HISTORY_KEYS = Object.keys(THIS_DAY_IN_HISTORY).sort();

    function shuffleQuotes() {
      for (let i = QUOTES.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [QUOTES[i], QUOTES[j]] = [QUOTES[j], QUOTES[i]];
      }
    }
    shuffleQuotes();

    function showQuote() {
      if (overlayBusy || previewMode) return;
      overlayBusy = true;
      showingQuote = true;

      const quote = QUOTES[currentQuoteIndex % QUOTES.length];
      currentQuoteIndex++;

      elements.upcomingLabel.textContent = '';
      elements.upcomingDescription.textContent = quote.text;
      elements.upcomingDate.textContent = quote.author ? `‚Äî ${quote.author}` : '';

      // Adjust font size based on quote length
      const len = quote.text.length;
      let sizeClass = '';
      if (len > 200) {
        sizeClass = 'quote-small';
      } else if (len > 120) {
        sizeClass = 'quote-medium';
      }
      elements.upcomingDescription.className = 'upcoming-description ' + sizeClass;

      elements.currentDisplay.classList.add('fade-out');

      setTimeout(() => {
        elements.upcomingOverlay.classList.add('visible');
      }, 500);

      setTimeout(() => {
        hideQuote();
      }, CONFIG.quoteShowDurationMs);
    }

    function hideQuote() {
      elements.upcomingOverlay.classList.remove('visible');
      elements.upcomingDescription.className = 'upcoming-description'; // Reset size class

      setTimeout(() => {
        elements.currentDisplay.classList.remove('fade-out');
        showingQuote = false;
        overlayBusy = false;
      }, 500);
    }

    // ============================================
    // THIS DAY IN HISTORY (Australian Positive)
    // ============================================
    // Key: "MM-DD" format
    const THIS_DAY_IN_HISTORY = {
      "01-01": { year: 1901, event: "The Commonwealth of Australia is proclaimed, uniting six colonies into one nation" },
      "01-02": { year: 2020, event: "Volunteer firefighters from across Australia unite to battle unprecedented bushfires" },
      "01-03": { year: 1959, event: "Alaska becomes the 49th US state, strengthening Pacific partnerships" },
      "01-04": { year: 2010, event: "Burj Khalifa opens; Australian engineers contributed to the world's tallest building" },
      "01-05": { year: 1956, event: "Melbourne begins preparations for Australia's first Olympic Games" },
      "01-06": { year: 1838, event: "Samuel Morse demonstrates the telegraph, revolutionising global communication" },
      "01-07": { year: 1949, event: "The first photograph of genes is taken, advancing Australian medical research" },
      "01-08": { year: 1962, event: "The National Gallery of Victoria opens its new building, celebrating Australian art" },
      "01-09": { year: 2007, event: "Steve Jobs unveils the iPhone, transforming how Australians connect" },
      "01-10": { year: 1946, event: "First United Nations General Assembly meets, with Australia as founding member" },
      "01-11": { year: 1935, event: "Amelia Earhart becomes first to fly solo from Hawaii to California" },
      "01-12": { year: 1998, event: "Nineteen European nations agree to ban human cloning" },
      "01-13": { year: 1942, event: "Henry Ford patents a plastic automobile, inspiring sustainable design" },
      "01-14": { year: 1973, event: "Elvis Presley's concert is broadcast globally, including to Australian audiences" },
      "01-15": { year: 1892, event: "James Naismith publishes the rules of basketball" },
      "01-16": { year: 1992, event: "Peace accords end 12-year civil war in El Salvador" },
      "01-17": { year: 1991, event: "Tim Berners-Lee launches the first website, changing communication forever" },
      "01-18": { year: 1958, event: "Willie O'Ree breaks the NHL colour barrier in ice hockey" },
      "01-19": { year: 1915, event: "Georges Claude patents the neon lamp, brightening cities worldwide" },
      "01-20": { year: 2009, event: "Barack Obama inaugurated; Australia celebrates historic moment" },
      "01-21": { year: 1976, event: "Concorde begins commercial flights, shrinking distances" },
      "01-22": { year: 2008, event: "Australian government officially apologises to the Stolen Generations" },
      "01-23": { year: 1960, event: "Jacques Piccard and Don Walsh reach the deepest ocean point" },
      "01-24": { year: 1848, event: "Gold discovered at Sutter's Mill, inspiring Australian gold rush searches" },
      "01-25": { year: 1924, event: "First Winter Olympics begin in France, inspiring global sport" },
      "01-26": { year: 1788, event: "First Fleet arrives at Sydney Cove" },
      "01-27": { year: 1945, event: "Auschwitz liberated; International Holocaust Remembrance Day" },
      "01-28": { year: 1958, event: "LEGO patents the brick design, inspiring creativity worldwide" },
      "01-29": { year: 1886, event: "Karl Benz patents the first gasoline-powered automobile" },
      "01-30": { year: 1969, event: "The Beatles perform their last public concert, on a London rooftop" },
      "01-31": { year: 1958, event: "Explorer 1 launches, beginning the Space Age" },
      "02-01": { year: 2003, event: "Space Shuttle Columbia crew honoured; advancing space research" },
      "02-02": { year: 1913, event: "Grand Central Terminal opens in New York City" },
      "02-03": { year: 1966, event: "Soviet Luna 9 makes first soft landing on the Moon" },
      "02-04": { year: 2004, event: "Facebook launches, connecting billions globally including Australians" },
      "02-05": { year: 1971, event: "Apollo 14 astronauts walk on the Moon" },
      "02-06": { year: 1952, event: "Queen Elizabeth II accedes to the throne" },
      "02-07": { year: 1964, event: "The Beatles arrive in America, changing music forever" },
      "02-08": { year: 1910, event: "Boy Scouts of America founded, inspiring youth worldwide" },
      "02-09": { year: 1964, event: "The Beatles make their US television debut on Ed Sullivan" },
      "02-10": { year: 1996, event: "IBM's Deep Blue defeats chess champion Garry Kasparov" },
      "02-11": { year: 1990, event: "Nelson Mandela released from prison after 27 years" },
      "02-12": { year: 2002, event: "The Kyoto Protocol on climate change comes into effect" },
      "02-13": { year: 2008, event: "Prime Minister Kevin Rudd delivers the National Apology to the Stolen Generations" },
      "02-14": { year: 1989, event: "First GPS satellite launched, revolutionising navigation" },
      "02-15": { year: 1971, event: "Decimalisation of British currency completed" },
      "02-16": { year: 2005, event: "Kyoto Protocol becomes international law" },
      "02-17": { year: 1972, event: "Volkswagen Beetle overtakes Ford Model T as most-produced car" },
      "02-18": { year: 1930, event: "Clyde Tombaugh discovers Pluto" },
      "02-19": { year: 1942, event: "Darwin is bombed; Australians unite in resilience" },
      "02-20": { year: 1962, event: "John Glenn becomes first American to orbit Earth" },
      "02-21": { year: 1848, event: "The Communist Manifesto published, changing political thought" },
      "02-22": { year: 1997, event: "Scientists announce cloning of Dolly the sheep" },
      "02-23": { year: 1945, event: "US Marines raise flag on Iwo Jima" },
      "02-24": { year: 1582, event: "Pope Gregory XIII announces Gregorian calendar" },
      "02-25": { year: 1964, event: "Muhammad Ali defeats Sonny Liston to become heavyweight champion" },
      "02-26": { year: 1935, event: "Robert Watson-Watt demonstrates radar for the first time" },
      "02-27": { year: 2019, event: "Australia recognises West Jerusalem as Israel's capital" },
      "02-28": { year: 1953, event: "Watson and Crick discover DNA structure" },
      "02-29": { year: 1940, event: "Hattie McDaniel becomes first African American to win an Oscar" },
      "03-01": { year: 1966, event: "Venera 3 becomes first spacecraft to reach another planet" },
      "03-02": { year: 1978, event: "First spam email sent, beginning the digital age challenges" },
      "03-03": { year: 1931, event: "The Star-Spangled Banner adopted as US national anthem" },
      "03-04": { year: 1789, event: "US Constitution takes effect, inspiring democracies worldwide" },
      "03-05": { year: 1970, event: "Nuclear Non-Proliferation Treaty goes into effect" },
      "03-06": { year: 1869, event: "Dmitri Mendeleev presents the periodic table of elements" },
      "03-07": { year: 1876, event: "Alexander Graham Bell patents the telephone" },
      "03-08": { year: 1917, event: "International Women's Day demonstrations in St Petersburg" },
      "03-09": { year: 1959, event: "Barbie doll debuts, becoming a cultural icon" },
      "03-10": { year: 1876, event: "Alexander Graham Bell makes first telephone call" },
      "03-11": { year: 1918, event: "First cases of Spanish flu recorded at Camp Funston" },
      "03-12": { year: 1930, event: "Gandhi begins Salt March for Indian independence" },
      "03-13": { year: 1781, event: "William Herschel discovers Uranus" },
      "03-14": { year: 2018, event: "Stephen Hawking passes; his work continues to inspire" },
      "03-15": { year: 44, event: "Julius Caesar assassinated; ides of March enters history" },
      "03-16": { year: 1926, event: "Robert Goddard launches first liquid-fuelled rocket" },
      "03-17": { year: 1992, event: "South African referendum ends apartheid" },
      "03-18": { year: 1965, event: "Alexei Leonov performs first spacewalk" },
      "03-19": { year: 1932, event: "Sydney Harbour Bridge officially opens" },
      "03-20": { year: 2003, event: "Iraq War begins; journalists embedded including Australians" },
      "03-21": { year: 2006, event: "Twitter founded, changing social communication" },
      "03-22": { year: 1995, event: "Cosmonaut Valeri Polyakov returns after 437 days in space" },
      "03-23": { year: 1983, event: "Dr Barney Clark lives 112 days with artificial heart" },
      "03-24": { year: 1965, event: "First teach-in held against Vietnam War at University of Michigan" },
      "03-25": { year: 2007, event: "200th anniversary of UK abolishing slave trade" },
      "03-26": { year: 1953, event: "Jonas Salk announces successful polio vaccine" },
      "03-27": { year: 1964, event: "Great Alaska Earthquake; Australia sends aid" },
      "03-28": { year: 1979, event: "Three Mile Island nuclear plant partially melts down" },
      "03-29": { year: 1867, event: "British Parliament passes Canadian Confederation act" },
      "03-30": { year: 1981, event: "President Reagan survives assassination attempt" },
      "03-31": { year: 1889, event: "Eiffel Tower opens for Paris Exposition" },
      "04-01": { year: 1976, event: "Apple Computer Company founded" },
      "04-02": { year: 2005, event: "Pope John Paul II passes; 4 million attend funeral" },
      "04-03": { year: 1973, event: "First handheld mobile phone call made by Martin Cooper" },
      "04-04": { year: 1968, event: "Martin Luther King Jr assassinated; civil rights advances" },
      "04-05": { year: 1722, event: "Dutch explorer Jacob Roggeveen discovers Easter Island" },
      "04-06": { year: 1896, event: "First modern Olympic Games open in Athens" },
      "04-07": { year: 1948, event: "World Health Organization established" },
      "04-08": { year: 1974, event: "Hank Aaron breaks Babe Ruth's home run record" },
      "04-09": { year: 2003, event: "Fall of Baghdad; end of Ba'athist Iraq" },
      "04-10": { year: 1970, event: "Paul McCartney announces Beatles breakup" },
      "04-11": { year: 1968, event: "US Civil Rights Act signed into law" },
      "04-12": { year: 1961, event: "Yuri Gagarin becomes first human in space" },
      "04-13": { year: 1970, event: "Apollo 13 astronauts survive oxygen tank explosion" },
      "04-14": { year: 1828, event: "Noah Webster publishes first American dictionary" },
      "04-15": { year: 1912, event: "Titanic sinks; leads to improved maritime safety" },
      "04-16": { year: 1947, event: "Bernard Baruch coins the term Cold War" },
      "04-17": { year: 1970, event: "Apollo 13 crew safely returns to Earth" },
      "04-18": { year: 1906, event: "San Francisco earthquake; city rebuilds stronger" },
      "04-19": { year: 1775, event: "American Revolution begins at Lexington" },
      "04-20": { year: 1999, event: "Columbine tragedy leads to improved school safety" },
      "04-21": { year: 753, event: "Traditional date of Rome's founding" },
      "04-22": { year: 1970, event: "First Earth Day celebrated by millions worldwide" },
      "04-23": { year: 1985, event: "Coca-Cola changes formula; consumer voices heard" },
      "04-24": { year: 1990, event: "Hubble Space Telescope launched" },
      "04-25": { year: 1915, event: "Anzac troops land at Gallipoli; Australian and New Zealand spirit endures" },
      "04-26": { year: 1986, event: "Chernobyl disaster; leads to improved nuclear safety" },
      "04-27": { year: 1994, event: "First multiracial elections in South Africa" },
      "04-28": { year: 2001, event: "Dennis Tito becomes first space tourist" },
      "04-29": { year: 2011, event: "Royal wedding of Prince William and Catherine Middleton" },
      "04-30": { year: 1975, event: "Fall of Saigon ends Vietnam War" },
      "05-01": { year: 1931, event: "Empire State Building opens in New York City" },
      "05-02": { year: 2011, event: "Osama bin Laden killed by US forces" },
      "05-03": { year: 1978, event: "First spam email sent; digital communication evolves" },
      "05-04": { year: 1979, event: "Margaret Thatcher becomes UK's first female PM" },
      "05-05": { year: 1961, event: "Alan Shepard becomes first American in space" },
      "05-06": { year: 1994, event: "Channel Tunnel opens between UK and France" },
      "05-07": { year: 1915, event: "Lusitania sunk; changes public opinion on WWI" },
      "05-08": { year: 1945, event: "Victory in Europe Day; WWII ends in Europe" },
      "05-09": { year: 1950, event: "Schuman Declaration begins European unity" },
      "05-10": { year: 1994, event: "Nelson Mandela inaugurated as President of South Africa" },
      "05-11": { year: 1997, event: "IBM's Deep Blue defeats Kasparov at chess" },
      "05-12": { year: 2017, event: "Emmanuel Macron inaugurated as French President" },
      "05-13": { year: 1981, event: "Pope John Paul II survives assassination attempt" },
      "05-14": { year: 1948, event: "State of Israel declared" },
      "05-15": { year: 1940, event: "Nylon stockings first sold in the United States" },
      "05-16": { year: 1960, event: "Theodore Maiman operates first laser" },
      "05-17": { year: 2004, event: "Massachusetts legalises same-sex marriage" },
      "05-18": { year: 1980, event: "Mount St Helens erupts; leads to geological research" },
      "05-19": { year: 1935, event: "Lawrence of Arabia dies in motorcycle accident" },
      "05-20": { year: 1927, event: "Charles Lindbergh begins first solo transatlantic flight" },
      "05-21": { year: 1927, event: "Charles Lindbergh completes transatlantic flight" },
      "05-22": { year: 1990, event: "Microsoft releases Windows 3.0" },
      "05-23": { year: 1934, event: "Bonnie and Clyde shot; Depression-era crime falls" },
      "05-24": { year: 1844, event: "Samuel Morse sends first telegraph message" },
      "05-25": { year: 1977, event: "Star Wars premieres in cinemas" },
      "05-26": { year: 1907, event: "John Wayne born; becomes Hollywood icon" },
      "05-27": { year: 1941, event: "German battleship Bismarck sunk" },
      "05-28": { year: 1937, event: "Golden Gate Bridge opens in San Francisco" },
      "05-29": { year: 1953, event: "Edmund Hillary and Tenzing Norgay summit Everest" },
      "05-30": { year: 1431, event: "Joan of Arc executed; later canonised as saint" },
      "05-31": { year: 1859, event: "Big Ben clock tower begins keeping time" },
      "06-01": { year: 1980, event: "CNN launches, beginning 24-hour news" },
      "06-02": { year: 1953, event: "Queen Elizabeth II coronation" },
      "06-03": { year: 1965, event: "Ed White performs first American spacewalk" },
      "06-04": { year: 1989, event: "Tiananmen Square protests; spirit of democracy" },
      "06-05": { year: 1968, event: "Robert F Kennedy shot; civil rights movement continues" },
      "06-06": { year: 1944, event: "D-Day: Allied forces land at Normandy" },
      "06-07": { year: 1975, event: "Sony introduces Betamax video recorder" },
      "06-08": { year: 1949, event: "George Orwell's 1984 published" },
      "06-09": { year: 1934, event: "Donald Duck first appears in Disney cartoon" },
      "06-10": { year: 2003, event: "NASA's Spirit rover launched to Mars" },
      "06-11": { year: 1963, event: "Buddhist monk Th√≠ch Qu·∫£ng ƒê·ª©c self-immolates for peace" },
      "06-12": { year: 1987, event: "Reagan delivers 'tear down this wall' speech" },
      "06-13": { year: 1983, event: "Pioneer 10 leaves solar system" },
      "06-14": { year: 1777, event: "Stars and Stripes adopted as US flag" },
      "06-15": { year: 1215, event: "Magna Carta sealed, foundation of democratic rights" },
      "06-16": { year: 1963, event: "Valentina Tereshkova becomes first woman in space" },
      "06-17": { year: 1972, event: "Watergate break-in; leads to governmental reforms" },
      "06-18": { year: 1983, event: "Sally Ride becomes first American woman in space" },
      "06-19": { year: 1865, event: "Juneteenth: last enslaved people learn of freedom" },
      "06-20": { year: 1975, event: "Jaws released, creating summer blockbuster era" },
      "06-21": { year: 2004, event: "SpaceShipOne makes first private spaceflight" },
      "06-22": { year: 1941, event: "Operation Barbarossa begins; Russia enters WWII" },
      "06-23": { year: 2016, event: "UK votes for Brexit; democracy in action" },
      "06-24": { year: 1947, event: "Kenneth Arnold reports first UFO sighting" },
      "06-25": { year: 1950, event: "Korean War begins" },
      "06-26": { year: 2015, event: "US Supreme Court legalises same-sex marriage nationwide" },
      "06-27": { year: 1967, event: "World's first ATM installed in London" },
      "06-28": { year: 1914, event: "Archduke Franz Ferdinand assassinated; WWI begins" },
      "06-29": { year: 2007, event: "First iPhone released" },
      "06-30": { year: 1971, event: "Soviet cosmonauts die in Soyuz 11; leads to safety improvements" },
      "07-01": { year: 1867, event: "Canada becomes a self-governing dominion" },
      "07-02": { year: 1964, event: "US Civil Rights Act signed by President Johnson" },
      "07-03": { year: 1886, event: "Karl Benz drives first patented automobile" },
      "07-04": { year: 1776, event: "US Declaration of Independence adopted" },
      "07-05": { year: 1996, event: "Dolly the sheep born; first cloned mammal" },
      "07-06": { year: 1885, event: "Louis Pasteur successfully tests rabies vaccine" },
      "07-07": { year: 2005, event: "London bombings; city shows resilience" },
      "07-08": { year: 1889, event: "Wall Street Journal begins publication" },
      "07-09": { year: 2011, event: "South Sudan becomes world's newest nation" },
      "07-10": { year: 1962, event: "Telstar 1 satellite launches; first live transatlantic TV" },
      "07-11": { year: 1979, event: "Skylab falls to Earth, mostly over Western Australia" },
      "07-12": { year: 1998, event: "France wins World Cup at home" },
      "07-13": { year: 1985, event: "Live Aid concerts raise millions for famine relief" },
      "07-14": { year: 1789, event: "Storming of the Bastille begins French Revolution" },
      "07-15": { year: 2006, event: "Twitter launches to the public" },
      "07-16": { year: 1969, event: "Apollo 11 launches for the Moon" },
      "07-17": { year: 1975, event: "Apollo-Soyuz spacecraft dock in orbit" },
      "07-18": { year: 1976, event: "Nadia ComƒÉneci scores first perfect 10 in gymnastics" },
      "07-19": { year: 1799, event: "Rosetta Stone discovered in Egypt" },
      "07-20": { year: 1969, event: "Neil Armstrong and Buzz Aldrin walk on the Moon" },
      "07-21": { year: 1969, event: "Neil Armstrong returns to lunar module; Moon landing success" },
      "07-22": { year: 1934, event: "FBI agents shoot John Dillinger outside Chicago theatre" },
      "07-23": { year: 1995, event: "Comet Hale-Bopp discovered" },
      "07-24": { year: 1969, event: "Apollo 11 astronauts splash down safely" },
      "07-25": { year: 1909, event: "Louis Bl√©riot flies across English Channel" },
      "07-26": { year: 1947, event: "US National Security Act creates CIA and Air Force" },
      "07-27": { year: 1953, event: "Korean War armistice signed" },
      "07-28": { year: 1914, event: "World War I begins" },
      "07-29": { year: 1981, event: "Prince Charles and Diana Spencer marry" },
      "07-30": { year: 1619, event: "First representative assembly in America convenes" },
      "07-31": { year: 1790, event: "US Patent Office opens" },
      "08-01": { year: 1981, event: "MTV launches, revolutionising music" },
      "08-02": { year: 1990, event: "Iraq invades Kuwait; international coalition forms" },
      "08-03": { year: 1958, event: "USS Nautilus crosses North Pole under ice" },
      "08-04": { year: 1944, event: "Anne Frank and family discovered; her diary inspires millions" },
      "08-05": { year: 1962, event: "Marilyn Monroe dies; legacy endures" },
      "08-06": { year: 1945, event: "Atomic bomb dropped on Hiroshima; peace movement grows" },
      "08-07": { year: 1974, event: "Philippe Petit walks tightrope between Twin Towers" },
      "08-08": { year: 1974, event: "Nixon resigns; peaceful transfer of power" },
      "08-09": { year: 1945, event: "Atomic bomb dropped on Nagasaki; WWII ends soon after" },
      "08-10": { year: 1990, event: "Magellan spacecraft enters Venus orbit" },
      "08-11": { year: 1999, event: "Total solar eclipse visible across Europe" },
      "08-12": { year: 1981, event: "IBM introduces personal computer" },
      "08-13": { year: 1961, event: "Berlin Wall construction begins; eventually falls" },
      "08-14": { year: 1945, event: "Japan surrenders; WWII ends" },
      "08-15": { year: 1947, event: "India gains independence from Britain" },
      "08-16": { year: 1977, event: "Elvis Presley dies; music legend remembered" },
      "08-17": { year: 1998, event: "President Clinton admits to affair; democracy tested" },
      "08-18": { year: 1920, event: "19th Amendment ratified; US women gain voting rights" },
      "08-19": { year: 1934, event: "First All-American Soap Box Derby held" },
      "08-20": { year: 1977, event: "Voyager 2 launched to explore outer planets" },
      "08-21": { year: 1959, event: "Hawaii becomes 50th US state" },
      "08-22": { year: 1989, event: "Nolan Ryan records 5,000th strikeout" },
      "08-23": { year: 1989, event: "Baltic Way: two million form human chain for independence" },
      "08-24": { year: 2006, event: "Pluto reclassified; astronomy expands knowledge" },
      "08-25": { year: 1991, event: "Linus Torvalds announces Linux operating system" },
      "08-26": { year: 1920, event: "Women's suffrage certified in United States" },
      "08-27": { year: 1883, event: "Krakatoa eruption; leads to improved warning systems" },
      "08-28": { year: 1963, event: "Martin Luther King Jr delivers 'I Have a Dream' speech" },
      "08-29": { year: 2005, event: "Hurricane Katrina; global aid response" },
      "08-30": { year: 1983, event: "Guion Bluford becomes first African American in space" },
      "08-31": { year: 1997, event: "Princess Diana dies; world mourns together" },
      "09-01": { year: 1939, event: "Germany invades Poland; WWII begins in Europe" },
      "09-02": { year: 1945, event: "WWII officially ends with Japan's surrender" },
      "09-03": { year: 1939, event: "Australia declares war on Germany" },
      "09-04": { year: 1998, event: "Google founded by Larry Page and Sergey Brin" },
      "09-05": { year: 1997, event: "Mother Teresa dies; her charity work continues" },
      "09-06": { year: 1991, event: "Soviet Union recognises Baltic independence" },
      "09-07": { year: 1936, event: "Tasmanian tiger (thylacine) dies in captivity; conservation awareness grows" },
      "09-08": { year: 1966, event: "Star Trek premieres; inspires generations of scientists" },
      "09-09": { year: 2015, event: "Queen Elizabeth II becomes longest-reigning British monarch" },
      "09-10": { year: 2008, event: "Large Hadron Collider activated at CERN" },
      "09-11": { year: 2001, event: "September 11 attacks; global unity and resilience" },
      "09-12": { year: 1959, event: "Soviet Luna 2 reaches the Moon" },
      "09-13": { year: 1847, event: "US forces capture Mexico City in Mexican-American War" },
      "09-14": { year: 1959, event: "Soviet Luna 2 first spacecraft to reach Moon" },
      "09-15": { year: 1890, event: "Agatha Christie born; becomes bestselling novelist" },
      "09-16": { year: 1620, event: "Mayflower departs Plymouth for America" },
      "09-17": { year: 1787, event: "US Constitution signed in Philadelphia" },
      "09-18": { year: 1947, event: "US Air Force established as separate military branch" },
      "09-19": { year: 1893, event: "New Zealand becomes first country with women's suffrage" },
      "09-20": { year: 1973, event: "Billie Jean King defeats Bobby Riggs in Battle of Sexes" },
      "09-21": { year: 1981, event: "Belize gains independence from Britain" },
      "09-22": { year: 1862, event: "Lincoln issues preliminary Emancipation Proclamation" },
      "09-23": { year: 2002, event: "Firefox web browser first released" },
      "09-24": { year: 1957, event: "Little Rock Nine integrate Arkansas high school" },
      "09-25": { year: 1997, event: "Thrust SSC breaks sound barrier on land" },
      "09-26": { year: 1969, event: "Abbey Road album released by The Beatles" },
      "09-27": { year: 1905, event: "Einstein publishes E=mc¬≤ equation" },
      "09-28": { year: 1928, event: "Alexander Fleming discovers penicillin" },
      "09-29": { year: 1979, event: "Pope John Paul II visits Ireland" },
      "09-30": { year: 1955, event: "James Dean dies in car crash; legend born" },
      "10-01": { year: 1958, event: "NASA officially begins operations" },
      "10-02": { year: 1950, event: "Peanuts comic strip first published" },
      "10-03": { year: 1990, event: "Germany reunified after 45 years" },
      "10-04": { year: 1957, event: "Soviet Union launches Sputnik 1, first satellite" },
      "10-05": { year: 2011, event: "Steve Jobs dies; Apple innovator remembered" },
      "10-06": { year: 1927, event: "The Jazz Singer premieres; first talking picture" },
      "10-07": { year: 2001, event: "Afghanistan invasion begins" },
      "10-08": { year: 1871, event: "Great Chicago Fire; city rebuilds better" },
      "10-09": { year: 1989, event: "Dalai Lama wins Nobel Peace Prize" },
      "10-10": { year: 1967, event: "Outer Space Treaty enters into force" },
      "10-11": { year: 1968, event: "Apollo 7, first crewed Apollo mission, launches" },
      "10-12": { year: 1492, event: "Columbus reaches the Americas" },
      "10-13": { year: 1792, event: "White House cornerstone laid" },
      "10-14": { year: 1947, event: "Chuck Yeager breaks sound barrier" },
      "10-15": { year: 1951, event: "I Love Lucy premieres on television" },
      "10-16": { year: 1978, event: "Polish Cardinal Wojty≈Ça becomes Pope John Paul II" },
      "10-17": { year: 1989, event: "Loma Prieta earthquake; Bay Area shows resilience" },
      "10-18": { year: 1867, event: "US takes formal possession of Alaska" },
      "10-19": { year: 1987, event: "Black Monday stock crash; markets recover" },
      "10-20": { year: 1968, event: "Jacqueline Kennedy marries Aristotle Onassis" },
      "10-21": { year: 1879, event: "Thomas Edison invents practical electric light" },
      "10-22": { year: 1962, event: "Cuban Missile Crisis begins; diplomacy prevails" },
      "10-23": { year: 2001, event: "Apple unveils the iPod" },
      "10-24": { year: 1945, event: "United Nations officially founded" },
      "10-25": { year: 1983, event: "US invades Grenada; Operation Urgent Fury" },
      "10-26": { year: 1825, event: "Erie Canal opens, boosting commerce" },
      "10-27": { year: 1904, event: "New York City subway opens" },
      "10-28": { year: 1886, event: "Statue of Liberty dedicated in New York Harbor" },
      "10-29": { year: 1969, event: "First ARPANET message sent, beginning internet" },
      "10-30": { year: 1938, event: "Orson Welles broadcasts War of the Worlds" },
      "10-31": { year: 1517, event: "Martin Luther posts 95 Theses" },
      "11-01": { year: 1993, event: "European Union established with Maastricht Treaty" },
      "11-02": { year: 1947, event: "Hughes H-4 Hercules (Spruce Goose) flies" },
      "11-03": { year: 1957, event: "Soviet dog Laika first animal in orbit" },
      "11-04": { year: 2008, event: "Barack Obama elected first African American US President" },
      "11-05": { year: 1605, event: "Gunpowder Plot foiled in London" },
      "11-06": { year: 1860, event: "Abraham Lincoln elected 16th US President" },
      "11-07": { year: 1917, event: "Bolshevik Revolution in Russia" },
      "11-08": { year: 1895, event: "Wilhelm R√∂ntgen discovers X-rays" },
      "11-09": { year: 1989, event: "Berlin Wall falls; Cold War ends" },
      "11-10": { year: 1969, event: "Sesame Street premieres, educating children worldwide" },
      "11-11": { year: 1918, event: "Armistice Day; WWI fighting ends" },
      "11-12": { year: 1990, event: "Tim Berners-Lee publishes formal proposal for World Wide Web" },
      "11-13": { year: 1994, event: "Sweden votes to join European Union" },
      "11-14": { year: 1922, event: "BBC begins radio broadcasts" },
      "11-15": { year: 1920, event: "League of Nations holds first meeting" },
      "11-16": { year: 1945, event: "UNESCO founded to promote peace through education" },
      "11-17": { year: 1970, event: "Soviet Lunokhod 1 lands on Moon" },
      "11-18": { year: 1928, event: "Mickey Mouse debuts in Steamboat Willie" },
      "11-19": { year: 1863, event: "Lincoln delivers Gettysburg Address" },
      "11-20": { year: 1945, event: "Nuremberg trials begin; justice for war crimes" },
      "11-21": { year: 1964, event: "Verrazano-Narrows Bridge opens in New York" },
      "11-22": { year: 1963, event: "President Kennedy assassinated; nation unites" },
      "11-23": { year: 1963, event: "Doctor Who premieres on BBC" },
      "11-24": { year: 1859, event: "Darwin publishes On the Origin of Species" },
      "11-25": { year: 2016, event: "Fidel Castro dies; Cuba enters new era" },
      "11-26": { year: 1922, event: "Howard Carter opens King Tut's tomb" },
      "11-27": { year: 1978, event: "Harvey Milk assassinated; LGBTQ+ rights advance" },
      "11-28": { year: 1942, event: "Cocoanut Grove fire; leads to safety reforms" },
      "11-29": { year: 1972, event: "Atari releases Pong video game" },
      "11-30": { year: 1874, event: "Winston Churchill born" },
      "12-01": { year: 1955, event: "Rosa Parks refuses to give up bus seat; civil rights movement grows" },
      "12-02": { year: 1942, event: "First controlled nuclear chain reaction achieved" },
      "12-03": { year: 1967, event: "First human heart transplant performed" },
      "12-04": { year: 1791, event: "Observer newspaper first published" },
      "12-05": { year: 1933, event: "Prohibition ends in United States" },
      "12-06": { year: 1865, event: "13th Amendment abolishes slavery in US" },
      "12-07": { year: 1941, event: "Attack on Pearl Harbor; US enters WWII" },
      "12-08": { year: 1980, event: "John Lennon shot; peace message lives on" },
      "12-09": { year: 1992, event: "Australian PM Keating delivers Redfern Address on Indigenous reconciliation" },
      "12-10": { year: 1901, event: "First Nobel Prizes awarded in Stockholm" },
      "12-11": { year: 1972, event: "Apollo 17 lands; last humans on Moon (so far)" },
      "12-12": { year: 2015, event: "Paris Agreement on climate change adopted" },
      "12-13": { year: 2003, event: "Saddam Hussein captured" },
      "12-14": { year: 1911, event: "Roald Amundsen reaches South Pole" },
      "12-15": { year: 1791, event: "US Bill of Rights ratified" },
      "12-16": { year: 1773, event: "Boston Tea Party protests British taxation" },
      "12-17": { year: 1903, event: "Wright Brothers achieve first powered flight" },
      "12-18": { year: 1865, event: "13th Amendment officially abolishes slavery" },
      "12-19": { year: 1998, event: "President Clinton impeached by House; survives" },
      "12-20": { year: 1803, event: "Louisiana Purchase completed, doubling US territory" },
      "12-21": { year: 1968, event: "Apollo 8 launches; first humans to orbit Moon" },
      "12-22": { year: 2001, event: "Richard Reid shoe bomb attempt foiled by passengers" },
      "12-23": { year: 1986, event: "Voyager aircraft completes first non-stop flight around world" },
      "12-24": { year: 1968, event: "Apollo 8 astronauts read Genesis from lunar orbit" },
      "12-25": { year: 1991, event: "Soviet Union officially dissolves; Cold War ends" },
      "12-26": { year: 2004, event: "Indian Ocean tsunami; global aid response" },
      "12-27": { year: 1904, event: "Peter Pan premieres in London" },
      "12-28": { year: 1895, event: "Lumi√®re brothers hold first commercial film screening" },
      "12-29": { year: 1845, event: "Texas admitted as 28th US state" },
      "12-30": { year: 1922, event: "Soviet Union officially established" },
      "12-31": { year: 1999, event: "Y2K bug fears prove unfounded; new millennium begins peacefully" },
    };

    // ============================================
    // WORD OF THE DAY (365 Positive Psychology Words)
    // ============================================
    // Key: day of year (1-366)
    const WORDS_OF_THE_DAY = [
      // January (1-31)
      { word: "Eudaimonia", definition: "A state of flourishing and living in accordance with one's true self", pronunciation: "yoo-dy-MOH-nee-uh" },
      { word: "Sonder", definition: "The realisation that each passerby has a life as vivid as your own", pronunciation: "SON-der" },
      { word: "Kairos", definition: "The perfect, opportune moment for action", pronunciation: "KY-ros" },
      { word: "Ubuntu", definition: "The belief in a universal bond of sharing that connects all humanity", pronunciation: "oo-BOON-too" },
      { word: "Meraki", definition: "Doing something with soul, creativity, and love", pronunciation: "meh-RAH-kee" },
      { word: "Ikigai", definition: "A reason for being; what gives life meaning", pronunciation: "ee-kee-GUY" },
      { word: "Hygge", definition: "A quality of cosiness and contentment", pronunciation: "HOO-guh" },
      { word: "Sisu", definition: "Extraordinary determination and resilience", pronunciation: "SEE-soo" },
      { word: "Wabi-sabi", definition: "Finding beauty in imperfection", pronunciation: "WAH-bee SAH-bee" },
      { word: "Lagom", definition: "Just the right amount; balanced and moderate", pronunciation: "LAH-gom" },
      { word: "Gezellig", definition: "Warm, convivial atmosphere with loved ones", pronunciation: "heh-SELL-ikh" },
      { word: "Friluftsliv", definition: "Open-air living; connecting with nature", pronunciation: "FREE-loofts-leev" },
      { word: "Mudita", definition: "Vicarious joy; happiness in others' success", pronunciation: "moo-DEE-tah" },
      { word: "Mamihlapinatapai", definition: "A look shared by two people who both wish the other would initiate something", pronunciation: "mah-mee-lah-pee-nah-tah-PAI" },
      { word: "Fernweh", definition: "An ache for distant places; longing for travel", pronunciation: "FERN-vay" },
      { word: "Serendipity", definition: "Finding something good without looking for it", pronunciation: "ser-en-DIP-ih-tee" },
      { word: "Petrichor", definition: "The earthy scent after rain falls on dry earth", pronunciation: "PET-ri-kor" },
      { word: "Hiraeth", definition: "A deep longing for home and belonging", pronunciation: "HEER-eyeth" },
      { word: "Komorebi", definition: "Sunlight filtering through leaves", pronunciation: "koh-moh-REH-bee" },
      { word: "Tsundoku", definition: "Acquiring books and letting them pile up unread", pronunciation: "TSOON-doh-koo" },
      { word: "Shinrin-yoku", definition: "Forest bathing; taking in the forest atmosphere", pronunciation: "SHIN-rin YOH-koo" },
      { word: "G√∂kotta", definition: "Waking early to hear the first birds sing", pronunciation: "yur-KOT-ah" },
      { word: "Uitwaaien", definition: "Walking in the wind to clear one's mind", pronunciation: "OUT-vy-en" },
      { word: "Sobremesa", definition: "Lingering at the table after a meal for conversation", pronunciation: "so-breh-MEH-sah" },
      { word: "Fika", definition: "Taking a break for coffee and connection", pronunciation: "FEE-kah" },
      { word: "Jugaad", definition: "Creative improvisation; finding solutions with limited resources", pronunciation: "joo-GAHD" },
      { word: "Pochemuchka", definition: "A person who asks many questions", pronunciation: "poh-cheh-MOOCH-kah" },
      { word: "Toska", definition: "A deep spiritual anguish, often without cause", pronunciation: "TOHS-kah" },
      { word: "Saudade", definition: "A melancholic longing for something lost", pronunciation: "sow-DAH-djee" },
      { word: "Aware", definition: "The bittersweetness of a brief and fading moment", pronunciation: "ah-WAH-reh" },
      { word: "Wunderkind", definition: "A person who achieves success at a young age", pronunciation: "VOON-der-kint" },
      // February (32-60)
      { word: "Yugen", definition: "A profound awareness of the universe", pronunciation: "yoo-GEHN" },
      { word: "Sprezzatura", definition: "Making the difficult look effortless", pronunciation: "spret-sah-TOO-rah" },
      { word: "Dolce far niente", definition: "The sweetness of doing nothing", pronunciation: "DOHL-chay far nee-EN-tay" },
      { word: "Weltschmerz", definition: "World-weariness; feeling that the world cannot satisfy", pronunciation: "VELT-shmairts" },
      { word: "Iktsuarpok", definition: "The anticipation of waiting for someone to arrive", pronunciation: "ikt-soo-AR-pok" },
      { word: "Waldeinsamkeit", definition: "The feeling of being alone in the woods", pronunciation: "VALT-ine-sahm-kite" },
      { word: "L'esprit de l'escalier", definition: "Thinking of the perfect reply too late", pronunciation: "less-PREE duh less-kahl-YAY" },
      { word: "Kintsugi", definition: "The art of repairing with gold; embracing flaws", pronunciation: "kin-TSOO-gee" },
      { word: "Uffda", definition: "An expression of sympathy or exhaustion", pronunciation: "OOF-dah" },
      { word: "Cafun√©", definition: "Running your fingers through someone's hair", pronunciation: "kah-foo-NEH" },
      { word: "Kos", definition: "Comfort and cosiness; enjoying the simple things", pronunciation: "kos" },
      { word: "M√•ngata", definition: "The road-like reflection of moonlight on water", pronunciation: "MONG-ah-tah" },
      { word: "Friluftsmenneske", definition: "A person who loves the outdoors", pronunciation: "FREE-loofts-men-ess-keh" },
      { word: "Niksen", definition: "The Dutch art of doing nothing", pronunciation: "NIK-sen" },
      { word: "Arbejdsgl√¶de", definition: "Happiness at work; job satisfaction", pronunciation: "AR-bides-gleh-theh" },
      { word: "Pana Po'o", definition: "Scratching your head to remember something", pronunciation: "pah-nah POH-oh" },
      { word: "Gigil", definition: "The urge to squeeze something cute", pronunciation: "GEE-gil" },
      { word: "Freudenfreude", definition: "Joy in another's joy; opposite of schadenfreude", pronunciation: "FROY-den-froy-duh" },
      { word: "Confelicity", definition: "Pleasure in another's happiness", pronunciation: "kon-feh-LIS-ih-tee" },
      { word: "Eleutheromania", definition: "An intense desire for freedom", pronunciation: "el-oo-thero-MAY-nee-uh" },
      { word: "Nefelibata", definition: "Cloud-walker; one who lives in their imagination", pronunciation: "neh-feh-lee-BAH-tah" },
      { word: "Vorfreude", definition: "Joyful anticipation of future pleasure", pronunciation: "FOR-froy-duh" },
      { word: "Uitbuiken", definition: "Resting after a satisfying meal", pronunciation: "OUT-bow-ken" },
      { word: "Backpfeifengesicht", definition: "A face that needs a punch; charmingly annoying", pronunciation: "bahk-FY-fen-geh-zikt" },
      { word: "Meriggiare", definition: "Resting at noon in the shade", pronunciation: "meh-ree-JAH-reh" },
      { word: "Forelsket", definition: "The euphoria of falling in love", pronunciation: "for-ELS-ket" },
      { word: "Gluggavedur", definition: "Weather that looks nice through a window but isn't", pronunciation: "GLOO-gah-veth-ur" },
      { word: "Desenrascan√ßo", definition: "Improvising a solution at the last minute", pronunciation: "deh-zen-rash-KAHN-soo" },
      { word: "Abbiocco", definition: "Drowsiness after a big meal", pronunciation: "ah-bee-OH-koh" },
      // March (61-91)
      { word: "Smultronst√§lle", definition: "A special place discovered and treasured", pronunciation: "SMOOL-tron-stel-eh" },
      { word: "Plenitude", definition: "Abundance; the state of being complete", pronunciation: "PLEN-ih-tood" },
      { word: "Mellowness", definition: "A gentle, unhurried quality of contentment", pronunciation: "MEL-oh-nes" },
      { word: "Effervescence", definition: "Bubbling enthusiasm and vivacity", pronunciation: "ef-er-VES-ens" },
      { word: "Sanguine", definition: "Optimistic and cheerful", pronunciation: "SANG-gwin" },
      { word: "Resplendent", definition: "Dazzling in appearance", pronunciation: "reh-SPLEN-dent" },
      { word: "Ineffable", definition: "Too great to be expressed in words", pronunciation: "in-EF-uh-bul" },
      { word: "Solace", definition: "Comfort during distress or sadness", pronunciation: "SOL-is" },
      { word: "Equanimity", definition: "Mental calmness and composure", pronunciation: "ek-wuh-NIM-ih-tee" },
      { word: "Benevolence", definition: "The quality of being well-meaning and kind", pronunciation: "buh-NEV-uh-lens" },
      { word: "Gratitude", definition: "The quality of being thankful", pronunciation: "GRAT-ih-tood" },
      { word: "Compassion", definition: "Sympathetic concern for others' suffering", pronunciation: "kum-PASH-un" },
      { word: "Resilience", definition: "The capacity to recover from difficulties", pronunciation: "rih-ZIL-yens" },
      { word: "Mindfulness", definition: "Being fully present in the moment", pronunciation: "MIND-ful-nes" },
      { word: "Serenity", definition: "The state of being calm and peaceful", pronunciation: "suh-REN-ih-tee" },
      { word: "Luminous", definition: "Full of light; radiant", pronunciation: "LOO-mih-nus" },
      { word: "Tranquility", definition: "A state of peace and calm", pronunciation: "trang-KWIL-ih-tee" },
      { word: "Euphoria", definition: "Intense happiness and well-being", pronunciation: "yoo-FOR-ee-uh" },
      { word: "Bliss", definition: "Perfect happiness; great joy", pronunciation: "blis" },
      { word: "Rapture", definition: "Ecstatic joy and delight", pronunciation: "RAP-chur" },
      { word: "Jubilation", definition: "Great happiness and triumph", pronunciation: "joo-bih-LAY-shun" },
      { word: "Exuberance", definition: "Lively energy and cheerfulness", pronunciation: "ig-ZOO-ber-uns" },
      { word: "Vivacity", definition: "Liveliness and high spirits", pronunciation: "vy-VAS-ih-tee" },
      { word: "Ebullience", definition: "Enthusiastic excitement", pronunciation: "ih-BOOL-yens" },
      { word: "Halcyon", definition: "Calm, peaceful, and happy", pronunciation: "HAL-see-un" },
      { word: "Effulgent", definition: "Shining brightly; radiant", pronunciation: "ih-FUL-jent" },
      { word: "Beatitude", definition: "Supreme blessedness", pronunciation: "bee-AT-ih-tood" },
      { word: "Felicity", definition: "Intense happiness", pronunciation: "fuh-LIS-ih-tee" },
      { word: "Elation", definition: "Great happiness and exhilaration", pronunciation: "ih-LAY-shun" },
      { word: "Winsome", definition: "Charming and engaging", pronunciation: "WIN-sum" },
      { word: "Ardent", definition: "Enthusiastic and passionate", pronunciation: "AR-dent" },
      // April (92-121)
      { word: "Mellifluous", definition: "Sweet-sounding; pleasant to hear", pronunciation: "muh-LIF-loo-us" },
      { word: "Dulcet", definition: "Sweet and soothing", pronunciation: "DUL-sit" },
      { word: "Scintillating", definition: "Sparkling; brilliantly lively", pronunciation: "SIN-tih-lay-ting" },
      { word: "Incandescent", definition: "Emitting light; passionate", pronunciation: "in-kan-DES-ent" },
      { word: "Sumptouous", definition: "Luxuriously fine and grand", pronunciation: "SUMP-choo-us" },
      { word: "Copious", definition: "Abundant in quantity", pronunciation: "KOH-pee-us" },
      { word: "Munificent", definition: "More generous than necessary", pronunciation: "myoo-NIF-ih-sent" },
      { word: "Magnanimous", definition: "Generous and forgiving", pronunciation: "mag-NAN-ih-mus" },
      { word: "Bountiful", definition: "Large in quantity; abundant", pronunciation: "BOWN-tih-ful" },
      { word: "Propitious", definition: "Indicating a good chance of success", pronunciation: "pruh-PISH-us" },
      { word: "Auspicious", definition: "Conducive to success; favourable", pronunciation: "aw-SPISH-us" },
      { word: "Fortuitous", definition: "Happening by lucky chance", pronunciation: "for-TOO-ih-tus" },
      { word: "Sagacious", definition: "Having keen mental discernment", pronunciation: "suh-GAY-shus" },
      { word: "Perspicacious", definition: "Having keen insight", pronunciation: "per-spih-KAY-shus" },
      { word: "Discerning", definition: "Having good judgement", pronunciation: "dih-SURN-ing" },
      { word: "Astute", definition: "Showing sharp practical judgement", pronunciation: "uh-STOOT" },
      { word: "Acumen", definition: "The ability to make good decisions quickly", pronunciation: "AK-yoo-men" },
      { word: "Sapient", definition: "Wise; having great wisdom", pronunciation: "SAY-pee-ent" },
      { word: "Prudent", definition: "Acting with care and thought for the future", pronunciation: "PROO-dent" },
      { word: "Judicious", definition: "Having good sense and judgement", pronunciation: "joo-DISH-us" },
      { word: "Resolute", definition: "Admirably purposeful and determined", pronunciation: "REZ-uh-loot" },
      { word: "Tenacious", definition: "Holding firmly; persistent", pronunciation: "tuh-NAY-shus" },
      { word: "Dauntless", definition: "Showing fearlessness and determination", pronunciation: "DAWNT-les" },
      { word: "Valiant", definition: "Possessing courage and determination", pronunciation: "VAL-yent" },
      { word: "Intrepid", definition: "Fearless and adventurous", pronunciation: "in-TREP-id" },
      { word: "Audacious", definition: "Showing willingness to take bold risks", pronunciation: "aw-DAY-shus" },
      { word: "Gallant", definition: "Brave and noble", pronunciation: "GAL-unt" },
      { word: "Stalwart", definition: "Loyal and reliable", pronunciation: "STAWL-wert" },
      { word: "Indomitable", definition: "Impossible to defeat or discourage", pronunciation: "in-DOM-ih-tuh-bul" },
      { word: "Steadfast", definition: "Firmly loyal; unwavering", pronunciation: "STED-fast" },
      // May (122-152)
      { word: "Altruistic", definition: "Showing selfless concern for others", pronunciation: "al-troo-IS-tik" },
      { word: "Philanthropic", definition: "Seeking to promote the welfare of others", pronunciation: "fil-an-THROP-ik" },
      { word: "Beneficent", definition: "Resulting in good; doing good", pronunciation: "buh-NEF-ih-sent" },
      { word: "Magnanimity", definition: "Generous and forgiving nature", pronunciation: "mag-nuh-NIM-ih-tee" },
      { word: "Clemency", definition: "Merciful and lenient treatment", pronunciation: "KLEM-en-see" },
      { word: "Forbearance", definition: "Patient self-control; restraint", pronunciation: "for-BEAR-uns" },
      { word: "Lenience", definition: "Being tolerant and forgiving", pronunciation: "LEE-nee-uns" },
      { word: "Indulgence", definition: "Tolerant or lenient treatment", pronunciation: "in-DUL-jens" },
      { word: "Amity", definition: "Friendly relations between people", pronunciation: "AM-ih-tee" },
      { word: "Concord", definition: "Agreement or harmony between people", pronunciation: "KON-kord" },
      { word: "Rapport", definition: "Harmonious understanding with another", pronunciation: "ra-POR" },
      { word: "Affinity", definition: "Natural liking or attraction", pronunciation: "uh-FIN-ih-tee" },
      { word: "Kinship", definition: "Sharing characteristics or origins", pronunciation: "KIN-ship" },
      { word: "Camaraderie", definition: "Mutual trust among friends", pronunciation: "kah-mah-RAH-duh-ree" },
      { word: "Fellowship", definition: "Friendly association with others", pronunciation: "FEL-oh-ship" },
      { word: "Solidarity", definition: "Unity based on shared interests", pronunciation: "sol-ih-DAIR-ih-tee" },
      { word: "Synergy", definition: "Combined effort greater than individual parts", pronunciation: "SIN-er-jee" },
      { word: "Collaboration", definition: "Working together towards a goal", pronunciation: "kuh-lab-uh-RAY-shun" },
      { word: "Cohesion", definition: "The state of forming a united whole", pronunciation: "koh-HEE-zhun" },
      { word: "Consonance", definition: "Agreement or harmony", pronunciation: "KON-suh-nuns" },
      { word: "Attunement", definition: "Being receptive to and aware of others", pronunciation: "uh-TOON-ment" },
      { word: "Empathy", definition: "Understanding and sharing others' feelings", pronunciation: "EM-puh-thee" },
      { word: "Sympathy", definition: "Feelings of pity and sorrow for another", pronunciation: "SIM-puh-thee" },
      { word: "Warmth", definition: "Kindness and affection", pronunciation: "wormth" },
      { word: "Tenderness", definition: "Gentleness and kindness", pronunciation: "TEN-der-nes" },
      { word: "Affection", definition: "Gentle feeling of fondness", pronunciation: "uh-FEK-shun" },
      { word: "Devotion", definition: "Love, loyalty, or enthusiasm", pronunciation: "dih-VOH-shun" },
      { word: "Adoration", definition: "Deep love and respect", pronunciation: "ad-uh-RAY-shun" },
      { word: "Reverence", definition: "Deep respect for someone", pronunciation: "REV-er-uns" },
      { word: "Veneration", definition: "Great respect; reverence", pronunciation: "ven-er-AY-shun" },
      { word: "Esteem", definition: "Respect and admiration", pronunciation: "ih-STEEM" },
      // June (153-182)
      { word: "Integrity", definition: "Quality of being honest and moral", pronunciation: "in-TEG-rih-tee" },
      { word: "Authenticity", definition: "Being true to one's own personality", pronunciation: "aw-then-TIS-ih-tee" },
      { word: "Sincerity", definition: "The quality of being genuine", pronunciation: "sin-SEER-ih-tee" },
      { word: "Candour", definition: "The quality of being open and honest", pronunciation: "KAN-der" },
      { word: "Probity", definition: "Quality of having strong moral principles", pronunciation: "PROH-bih-tee" },
      { word: "Rectitude", definition: "Morally correct behaviour", pronunciation: "REK-tih-tood" },
      { word: "Honour", definition: "High respect and adherence to ethics", pronunciation: "ON-er" },
      { word: "Dignity", definition: "The state of being worthy of respect", pronunciation: "DIG-nih-tee" },
      { word: "Nobility", definition: "Quality of being morally impressive", pronunciation: "noh-BIL-ih-tee" },
      { word: "Grace", definition: "Elegance and poise of movement or manner", pronunciation: "grays" },
      { word: "Elegance", definition: "Graceful and stylish quality", pronunciation: "EL-ih-guns" },
      { word: "Refinement", definition: "Cultured elegance in manner", pronunciation: "rih-FINE-ment" },
      { word: "Sophistication", definition: "Quality of being worldly and cultured", pronunciation: "suh-fis-tih-KAY-shun" },
      { word: "Poise", definition: "Graceful and elegant bearing", pronunciation: "poiz" },
      { word: "Aplomb", definition: "Self-confidence in difficult situations", pronunciation: "uh-PLOM" },
      { word: "Composure", definition: "The state of being calm and in control", pronunciation: "kum-POH-zhur" },
      { word: "Sangfroid", definition: "Coolness under strain", pronunciation: "sahn-FRWAH" },
      { word: "Nonchalance", definition: "Calm and relaxed state", pronunciation: "NON-shuh-lahns" },
      { word: "Insouciance", definition: "Casual lack of concern", pronunciation: "in-SOO-see-uns" },
      { word: "Detachment", definition: "State of being objective and uninvolved", pronunciation: "dih-TACH-ment" },
      { word: "Imperturbability", definition: "Unable to be upset or excited", pronunciation: "im-per-TUR-buh-BIL-ih-tee" },
      { word: "Patience", definition: "Capacity to accept delay without anger", pronunciation: "PAY-shuns" },
      { word: "Tolerance", definition: "Willingness to accept differences", pronunciation: "TOL-er-uns" },
      { word: "Acceptance", definition: "Willingness to receive something", pronunciation: "ak-SEP-tuns" },
      { word: "Understanding", definition: "Sympathetic awareness", pronunciation: "un-der-STAND-ing" },
      { word: "Perceptiveness", definition: "Having keen insight or intuition", pronunciation: "per-SEP-tiv-nes" },
      { word: "Intuition", definition: "Ability to understand instinctively", pronunciation: "in-too-ISH-un" },
      { word: "Insight", definition: "Deep understanding of something", pronunciation: "IN-site" },
      { word: "Wisdom", definition: "Quality of having experience and good judgement", pronunciation: "WIZ-dum" },
      { word: "Enlightenment", definition: "State of having spiritual knowledge", pronunciation: "en-LITE-en-ment" },
      // July (183-213)
      { word: "Curiosity", definition: "Strong desire to know or learn", pronunciation: "kyoor-ee-OS-ih-tee" },
      { word: "Wonder", definition: "Feeling of amazement and admiration", pronunciation: "WUN-der" },
      { word: "Awe", definition: "Feeling of reverential respect", pronunciation: "aw" },
      { word: "Marvel", definition: "A wonderful thing; to be amazed", pronunciation: "MAR-vel" },
      { word: "Fascination", definition: "Intense interest in something", pronunciation: "fas-ih-NAY-shun" },
      { word: "Enchantment", definition: "State of being delighted", pronunciation: "en-CHANT-ment" },
      { word: "Captivation", definition: "Attracting and holding attention", pronunciation: "kap-tih-VAY-shun" },
      { word: "Allure", definition: "Powerfully attractive quality", pronunciation: "uh-LOOR" },
      { word: "Magnetism", definition: "Ability to attract and charm", pronunciation: "MAG-nuh-tiz-um" },
      { word: "Charisma", definition: "Compelling attractiveness", pronunciation: "kuh-RIZ-muh" },
      { word: "Presence", definition: "Impressive manner or appearance", pronunciation: "PREZ-uns" },
      { word: "Radiance", definition: "Light or heat radiating from something", pronunciation: "RAY-dee-uns" },
      { word: "Brilliance", definition: "Exceptional talent or intelligence", pronunciation: "BRIL-yuns" },
      { word: "Lustre", definition: "Soft glow or shine", pronunciation: "LUS-ter" },
      { word: "Shimmer", definition: "Soft, tremulous light", pronunciation: "SHIM-er" },
      { word: "Gleam", definition: "Faint or brief light", pronunciation: "gleem" },
      { word: "Sparkle", definition: "Shine brightly with flashes of light", pronunciation: "SPAR-kul" },
      { word: "Twinkle", definition: "Shine with a flickering light", pronunciation: "TWING-kul" },
      { word: "Glimmer", definition: "Faint unsteady light", pronunciation: "GLIM-er" },
      { word: "Glow", definition: "Steady radiance of light", pronunciation: "gloh" },
      { word: "Warmth", definition: "Quality of being warm", pronunciation: "wormth" },
      { word: "Cosiness", definition: "Comfortable and warm atmosphere", pronunciation: "KOH-zee-nes" },
      { word: "Comfort", definition: "State of physical ease", pronunciation: "KUM-fert" },
      { word: "Contentment", definition: "State of peaceful happiness", pronunciation: "kun-TENT-ment" },
      { word: "Satisfaction", definition: "Fulfilment of desires", pronunciation: "sat-is-FAK-shun" },
      { word: "Fulfilment", definition: "Achievement of something desired", pronunciation: "ful-FIL-ment" },
      { word: "Accomplishment", definition: "Something achieved successfully", pronunciation: "uh-KOM-plish-ment" },
      { word: "Achievement", definition: "Thing done successfully", pronunciation: "uh-CHEEV-ment" },
      { word: "Success", definition: "Accomplishment of an aim", pronunciation: "suk-SES" },
      { word: "Triumph", definition: "Great victory or achievement", pronunciation: "TRY-umf" },
      { word: "Victory", definition: "Act of defeating an enemy", pronunciation: "VIK-tuh-ree" },
      // August (214-244)
      { word: "Mastery", definition: "Comprehensive knowledge or skill", pronunciation: "MAS-ter-ee" },
      { word: "Expertise", definition: "Expert skill or knowledge", pronunciation: "ek-sper-TEEZ" },
      { word: "Proficiency", definition: "High degree of competence", pronunciation: "pruh-FISH-en-see" },
      { word: "Competence", definition: "Ability to do something well", pronunciation: "KOM-peh-tens" },
      { word: "Capability", definition: "Power or ability to do something", pronunciation: "kay-puh-BIL-ih-tee" },
      { word: "Aptitude", definition: "Natural ability to do something", pronunciation: "AP-tih-tood" },
      { word: "Talent", definition: "Natural aptitude or skill", pronunciation: "TAL-ent" },
      { word: "Gift", definition: "Natural ability or talent", pronunciation: "gift" },
      { word: "Flair", definition: "Natural ability for something", pronunciation: "flair" },
      { word: "Knack", definition: "Acquired skill for doing something", pronunciation: "nak" },
      { word: "Finesse", definition: "Refined delicacy of performance", pronunciation: "fih-NES" },
      { word: "Dexterity", definition: "Skill in performing tasks", pronunciation: "dek-STER-ih-tee" },
      { word: "Agility", definition: "Ability to move quickly and easily", pronunciation: "uh-JIL-ih-tee" },
      { word: "Nimbleness", definition: "Quickness and lightness of movement", pronunciation: "NIM-bul-nes" },
      { word: "Flexibility", definition: "Willingness to change or compromise", pronunciation: "flek-sih-BIL-ih-tee" },
      { word: "Adaptability", definition: "Ability to adjust to new conditions", pronunciation: "uh-dap-tuh-BIL-ih-tee" },
      { word: "Versatility", definition: "Ability to adapt to many functions", pronunciation: "ver-suh-TIL-ih-tee" },
      { word: "Resourcefulness", definition: "Ability to find quick solutions", pronunciation: "rih-SORS-ful-nes" },
      { word: "Ingenuity", definition: "Quality of being clever and inventive", pronunciation: "in-juh-NOO-ih-tee" },
      { word: "Creativity", definition: "Use of imagination to create", pronunciation: "kree-ay-TIV-ih-tee" },
      { word: "Innovation", definition: "New method or idea", pronunciation: "in-uh-VAY-shun" },
      { word: "Originality", definition: "Quality of being novel or unusual", pronunciation: "uh-rij-ih-NAL-ih-tee" },
      { word: "Imagination", definition: "Faculty of forming mental images", pronunciation: "ih-maj-ih-NAY-shun" },
      { word: "Inventiveness", definition: "Skill at creating new things", pronunciation: "in-VEN-tiv-nes" },
      { word: "Inspiration", definition: "Process of being mentally stimulated", pronunciation: "in-spih-RAY-shun" },
      { word: "Motivation", definition: "Reason for acting a certain way", pronunciation: "moh-tih-VAY-shun" },
      { word: "Aspiration", definition: "Hope or ambition of achieving", pronunciation: "as-pih-RAY-shun" },
      { word: "Ambition", definition: "Strong desire to achieve", pronunciation: "am-BISH-un" },
      { word: "Drive", definition: "Innate need guiding behaviour", pronunciation: "dryv" },
      { word: "Determination", definition: "Firmness of purpose", pronunciation: "dih-ter-mih-NAY-shun" },
      { word: "Perseverance", definition: "Continued effort despite difficulty", pronunciation: "per-suh-VEER-uns" },
      // September (245-274)
      { word: "Grit", definition: "Courage and resolve; strength of character", pronunciation: "grit" },
      { word: "Fortitude", definition: "Courage in pain or adversity", pronunciation: "FOR-tih-tood" },
      { word: "Endurance", definition: "Ability to withstand hardship", pronunciation: "en-DOOR-uns" },
      { word: "Stamina", definition: "Ability to sustain prolonged effort", pronunciation: "STAM-ih-nuh" },
      { word: "Vitality", definition: "State of being strong and active", pronunciation: "vy-TAL-ih-tee" },
      { word: "Vigour", definition: "Physical strength and good health", pronunciation: "VIG-er" },
      { word: "Energy", definition: "Strength required for activity", pronunciation: "EN-er-jee" },
      { word: "Dynamism", definition: "Quality of being energetic and forceful", pronunciation: "DY-nuh-miz-um" },
      { word: "Zest", definition: "Great enthusiasm and energy", pronunciation: "zest" },
      { word: "Gusto", definition: "Enjoyment and vigour in doing something", pronunciation: "GUS-toh" },
      { word: "Verve", definition: "Vigour and spirit; enthusiasm", pronunciation: "verv" },
      { word: "Pizzazz", definition: "Attractive combination of vitality and glamour", pronunciation: "pih-ZAZ" },
      { word: "Panache", definition: "Flamboyant confidence of style", pronunciation: "puh-NASH" },
      { word: "√âlan", definition: "Energy, style, and enthusiasm", pronunciation: "ay-LAHN" },
      { word: "Brio", definition: "Vigour and vivacity", pronunciation: "BREE-oh" },
      { word: "Spirit", definition: "Quality of courage and determination", pronunciation: "SPIR-it" },
      { word: "Mettle", definition: "Ability to cope with difficulties", pronunciation: "MET-ul" },
      { word: "Pluck", definition: "Spirited and determined courage", pronunciation: "pluk" },
      { word: "Nerve", definition: "Courage or bravery", pronunciation: "nerv" },
      { word: "Backbone", definition: "Strength of character; resolution", pronunciation: "BAK-bohn" },
      { word: "Spine", definition: "Resolution and determination", pronunciation: "spyn" },
      { word: "Spunk", definition: "Courage and determination", pronunciation: "spungk" },
      { word: "Moxie", definition: "Force of character; determination", pronunciation: "MOK-see" },
      { word: "Chutzpah", definition: "Shameless audacity; nerve", pronunciation: "KHOOTS-pah" },
      { word: "Gumption", definition: "Shrewd common sense; initiative", pronunciation: "GUMP-shun" },
      { word: "Initiative", definition: "Ability to act independently", pronunciation: "ih-NISH-uh-tiv" },
      { word: "Enterprise", definition: "Willingness to undertake new ventures", pronunciation: "EN-ter-pryz" },
      { word: "Entrepreneurship", definition: "Activity of setting up ventures", pronunciation: "on-truh-pruh-NUR-ship" },
      { word: "Pioneering", definition: "Developing new ideas or methods", pronunciation: "py-uh-NEER-ing" },
      { word: "Trailblazing", definition: "Making new paths or discoveries", pronunciation: "TRAYL-blay-zing" },
      // October (275-305)
      { word: "Groundbreaking", definition: "Innovative; pioneering", pronunciation: "GROWND-bray-king" },
      { word: "Revolutionary", definition: "Involving dramatic change", pronunciation: "rev-uh-LOO-shun-air-ee" },
      { word: "Transformative", definition: "Causing major change", pronunciation: "trans-FOR-muh-tiv" },
      { word: "Progressive", definition: "Favouring change and innovation", pronunciation: "pruh-GRES-iv" },
      { word: "Visionary", definition: "Thinking about the future imaginatively", pronunciation: "VIZH-uh-nair-ee" },
      { word: "Idealistic", definition: "Characterised by high ideals", pronunciation: "eye-dee-uh-LIS-tik" },
      { word: "Utopian", definition: "Aiming for perfect society", pronunciation: "yoo-TOH-pee-un" },
      { word: "Optimistic", definition: "Hopeful about the future", pronunciation: "op-tih-MIS-tik" },
      { word: "Hopeful", definition: "Feeling or inspiring hope", pronunciation: "HOHP-ful" },
      { word: "Positive", definition: "Constructive and optimistic", pronunciation: "POZ-ih-tiv" },
      { word: "Upbeat", definition: "Cheerful and optimistic", pronunciation: "UP-beet" },
      { word: "Sunny", definition: "Cheerful and bright", pronunciation: "SUN-ee" },
      { word: "Buoyant", definition: "Cheerful and optimistic", pronunciation: "BOY-unt" },
      { word: "Chirpy", definition: "Cheerful and lively", pronunciation: "CHUR-pee" },
      { word: "Perky", definition: "Cheerful and lively", pronunciation: "PUR-kee" },
      { word: "Jovial", definition: "Cheerful and friendly", pronunciation: "JOH-vee-ul" },
      { word: "Genial", definition: "Friendly and cheerful", pronunciation: "JEEN-yul" },
      { word: "Amiable", definition: "Friendly and pleasant", pronunciation: "AY-mee-uh-bul" },
      { word: "Affable", definition: "Friendly and good-natured", pronunciation: "AF-uh-bul" },
      { word: "Cordial", definition: "Warm and friendly", pronunciation: "KOR-jul" },
      { word: "Convivial", definition: "Friendly and lively", pronunciation: "kun-VIV-ee-ul" },
      { word: "Gregarious", definition: "Fond of company; sociable", pronunciation: "greh-GAIR-ee-us" },
      { word: "Sociable", definition: "Willing to talk and engage", pronunciation: "SOH-shuh-bul" },
      { word: "Outgoing", definition: "Friendly and socially confident", pronunciation: "OWT-goh-ing" },
      { word: "Extroverted", definition: "Energised by social interaction", pronunciation: "EK-struh-ver-tid" },
      { word: "Approachable", definition: "Easy to talk to", pronunciation: "uh-PROH-chuh-bul" },
      { word: "Welcoming", definition: "Behaving in a friendly manner", pronunciation: "WEL-kum-ing" },
      { word: "Hospitable", definition: "Friendly and generous to guests", pronunciation: "hos-PIT-uh-bul" },
      { word: "Gracious", definition: "Courteous, kind, and pleasant", pronunciation: "GRAY-shus" },
      { word: "Courteous", definition: "Polite and respectful", pronunciation: "KUR-tee-us" },
      { word: "Considerate", definition: "Careful not to cause inconvenience", pronunciation: "kun-SID-er-it" },
      // November (306-335)
      { word: "Thoughtful", definition: "Showing consideration for others", pronunciation: "THAWT-ful" },
      { word: "Caring", definition: "Displaying kindness and concern", pronunciation: "KAIR-ing" },
      { word: "Nurturing", definition: "Providing care and encouragement", pronunciation: "NUR-cher-ing" },
      { word: "Supportive", definition: "Providing encouragement", pronunciation: "suh-POR-tiv" },
      { word: "Encouraging", definition: "Giving support and confidence", pronunciation: "en-KUR-ij-ing" },
      { word: "Uplifting", definition: "Inspiring happiness or hope", pronunciation: "up-LIFT-ing" },
      { word: "Inspiring", definition: "Having the effect of inspiring", pronunciation: "in-SPY-ring" },
      { word: "Motivating", definition: "Providing stimulus for action", pronunciation: "MOH-tih-vay-ting" },
      { word: "Empowering", definition: "Giving someone power or authority", pronunciation: "em-POW-er-ing" },
      { word: "Enabling", definition: "Giving means or opportunity", pronunciation: "en-AY-bling" },
      { word: "Enriching", definition: "Improving quality or value", pronunciation: "en-RICH-ing" },
      { word: "Enlightening", definition: "Giving greater knowledge", pronunciation: "en-LY-ten-ing" },
      { word: "Edifying", definition: "Instructive and improving", pronunciation: "ED-ih-fy-ing" },
      { word: "Illuminating", definition: "Helping to clarify or explain", pronunciation: "ih-LOO-mih-nay-ting" },
      { word: "Revelatory", definition: "Revealing something unknown", pronunciation: "rev-uh-LAH-tuh-ree" },
      { word: "Liberating", definition: "Freeing from restrictions", pronunciation: "LIB-er-ay-ting" },
      { word: "Emancipating", definition: "Setting free from constraints", pronunciation: "ih-MAN-sih-pay-ting" },
      { word: "Freeing", definition: "Releasing from confinement", pronunciation: "FREE-ing" },
      { word: "Unburdening", definition: "Relieving of a burden", pronunciation: "un-BUR-den-ing" },
      { word: "Relieving", definition: "Causing relaxation of tension", pronunciation: "rih-LEEV-ing" },
      { word: "Soothing", definition: "Having a calming effect", pronunciation: "SOO-thing" },
      { word: "Calming", definition: "Making peaceful or quiet", pronunciation: "KAH-ming" },
      { word: "Relaxing", definition: "Reducing tension or anxiety", pronunciation: "rih-LAK-sing" },
      { word: "Peaceful", definition: "Free from disturbance", pronunciation: "PEES-ful" },
      { word: "Restful", definition: "Having a quiet and soothing quality", pronunciation: "REST-ful" },
      { word: "Rejuvenating", definition: "Making someone feel younger", pronunciation: "rih-JOO-vuh-nay-ting" },
      { word: "Revitalising", definition: "Giving new life or vigour", pronunciation: "ree-VY-tuh-ly-zing" },
      { word: "Invigorating", definition: "Making one feel strong", pronunciation: "in-VIG-uh-ray-ting" },
      { word: "Refreshing", definition: "Reviving or stimulating", pronunciation: "rih-FRESH-ing" },
      { word: "Renewing", definition: "Resuming after interruption", pronunciation: "rih-NOO-ing" },
      // December (336-366)
      { word: "Regenerating", definition: "Growing again or being renewed", pronunciation: "rih-JEN-er-ay-ting" },
      { word: "Healing", definition: "Tending to heal or restore", pronunciation: "HEE-ling" },
      { word: "Restorative", definition: "Having the ability to restore", pronunciation: "rih-STOR-uh-tiv" },
      { word: "Remedial", definition: "Giving or intended as remedy", pronunciation: "rih-MEE-dee-ul" },
      { word: "Therapeutic", definition: "Having a healing effect", pronunciation: "ther-uh-PYOO-tik" },
      { word: "Curative", definition: "Able to cure disease", pronunciation: "KYOOR-uh-tiv" },
      { word: "Salutary", definition: "Producing good effects", pronunciation: "SAL-yoo-ter-ee" },
      { word: "Wholesome", definition: "Conducive to health and wellbeing", pronunciation: "HOHL-sum" },
      { word: "Nourishing", definition: "Providing sustenance", pronunciation: "NUR-ish-ing" },
      { word: "Sustaining", definition: "Strengthening or supporting", pronunciation: "suh-STAY-ning" },
      { word: "Fulfilling", definition: "Making someone satisfied", pronunciation: "ful-FIL-ing" },
      { word: "Rewarding", definition: "Providing satisfaction", pronunciation: "rih-WOR-ding" },
      { word: "Satisfying", definition: "Giving fulfilment", pronunciation: "SAT-is-fy-ing" },
      { word: "Gratifying", definition: "Giving pleasure or satisfaction", pronunciation: "GRAT-ih-fy-ing" },
      { word: "Pleasurable", definition: "Giving enjoyment", pronunciation: "PLEZH-er-uh-bul" },
      { word: "Enjoyable", definition: "Giving delight", pronunciation: "en-JOY-uh-bul" },
      { word: "Delightful", definition: "Causing great pleasure", pronunciation: "dih-LYT-ful" },
      { word: "Wonderful", definition: "Inspiring delight or admiration", pronunciation: "WUN-der-ful" },
      { word: "Marvellous", definition: "Causing great wonder", pronunciation: "MAR-vuh-lus" },
      { word: "Magnificent", definition: "Extremely beautiful or impressive", pronunciation: "mag-NIF-ih-sent" },
      { word: "Splendid", definition: "Magnificent; very impressive", pronunciation: "SPLEN-did" },
      { word: "Glorious", definition: "Having great beauty", pronunciation: "GLOR-ee-us" },
      { word: "Sublime", definition: "Of outstanding spiritual worth", pronunciation: "suh-BLYM" },
      { word: "Transcendent", definition: "Surpassing the ordinary", pronunciation: "tran-SEN-dent" },
      { word: "Extraordinary", definition: "Very unusual or remarkable", pronunciation: "ik-STROR-din-air-ee" },
      { word: "Exceptional", definition: "Unusually good; outstanding", pronunciation: "ik-SEP-shuh-nul" },
      { word: "Outstanding", definition: "Exceptionally good", pronunciation: "owt-STAN-ding" },
      { word: "Remarkable", definition: "Worthy of attention", pronunciation: "rih-MAR-kuh-bul" },
      { word: "Phenomenal", definition: "Remarkable or exceptional", pronunciation: "fuh-NOM-ih-nul" },
      { word: "Spectacular", definition: "Beautiful in a dramatic way", pronunciation: "spek-TAK-yoo-ler" },
      { word: "Breathtaking", definition: "Astonishing or awe-inspiring", pronunciation: "BRETH-tay-king" },
    ];

    function getTodaysHistory() {
      const now = new Date();
      const key = String(now.getMonth() + 1).padStart(2, '0') + '-' + String(now.getDate()).padStart(2, '0');
      return THIS_DAY_IN_HISTORY[key] || null;
    }

    function getTodaysWord() {
      const now = new Date();
      const start = new Date(now.getFullYear(), 0, 0);
      const diff = now - start;
      const oneDay = 1000 * 60 * 60 * 24;
      const dayOfYear = Math.floor(diff / oneDay);
      // Wrap around if we somehow have more than 366 days
      const index = (dayOfYear - 1) % WORDS_OF_THE_DAY.length;
      return WORDS_OF_THE_DAY[index >= 0 ? index : 0];
    }

    function showThisDayInHistory(cycle = false) {
      if (overlayBusy || previewMode) return;

      let history, dateKey;
      if (cycle) {
        // Cycle through all history entries
        dateKey = HISTORY_KEYS[currentHistoryIndex % HISTORY_KEYS.length];
        history = THIS_DAY_IN_HISTORY[dateKey];
        currentHistoryIndex++;
      } else {
        // Show today's history
        const now = new Date();
        dateKey = String(now.getMonth() + 1).padStart(2, '0') + '-' + String(now.getDate()).padStart(2, '0');
        history = THIS_DAY_IN_HISTORY[dateKey];
      }

      if (!history) return;

      overlayBusy = true;

      const displayDate = cycle ? `${dateKey.split('-')[1]}/${dateKey.split('-')[0]} - ${history.year}` : history.year;
      elements.upcomingLabel.textContent = 'This Day in History';
      elements.upcomingDescription.textContent = history.event;
      elements.upcomingDate.textContent = displayDate;

      // Adjust font size based on text length
      const len = history.event.length;
      let sizeClass = '';
      if (len > 150) {
        sizeClass = 'quote-small';
      } else if (len > 80) {
        sizeClass = 'quote-medium';
      }
      elements.upcomingDescription.className = 'upcoming-description ' + sizeClass;

      elements.currentDisplay.classList.add('fade-out');

      setTimeout(() => {
        elements.upcomingOverlay.classList.add('visible');
      }, 500);

      setTimeout(() => {
        hideOverlay();
      }, CONFIG.quoteShowDurationMs);
    }

    function showWordOfTheDay(cycle = false) {
      if (overlayBusy || previewMode) return;

      let word;
      if (cycle) {
        // Cycle through all words
        word = WORDS_OF_THE_DAY[currentWordIndex % WORDS_OF_THE_DAY.length];
        currentWordIndex++;
      } else {
        // Show today's word
        word = getTodaysWord();
      }

      if (!word) return;

      overlayBusy = true;

      elements.upcomingLabel.textContent = 'Word of the Day';
      elements.upcomingDescription.textContent = `${word.word} ‚Äî ${word.definition}`;
      elements.upcomingDate.textContent = word.pronunciation;

      elements.upcomingDescription.className = 'upcoming-description quote-medium';

      elements.currentDisplay.classList.add('fade-out');

      setTimeout(() => {
        elements.upcomingOverlay.classList.add('visible');
      }, 500);

      setTimeout(() => {
        hideOverlay();
      }, CONFIG.quoteShowDurationMs);
    }

    function hideOverlay() {
      elements.upcomingOverlay.classList.remove('visible');
      elements.upcomingDescription.className = 'upcoming-description';

      setTimeout(() => {
        elements.currentDisplay.classList.remove('fade-out');
        overlayBusy = false;
      }, 500);
    }

    // ============================================
    // GOOD NEWS API
    // ============================================
    let newsIndex = 0;
    let newsRunning = false;
    let newsTimeout = null;
    let newsEnabled = false; // Default to off, toggle with 'n' key

    async function loadGoodNews() {
      try {
        // Using RSS2JSON service to convert Good News Network RSS to JSON (free, no API key required)
        const rssUrl = encodeURIComponent('https://www.goodnewsnetwork.org/feed/');
        const response = await fetch(`https://api.rss2json.com/v1/api.json?rss_url=${rssUrl}`, {
          method: 'GET',
        });

        if (!response.ok) throw new Error('RSS feed unavailable');

        const data = await response.json();
        if (data.status === 'ok' && data.items && data.items.length > 0) {
          // Extract titles from RSS feed items
          newsHeadlines = data.items.slice(0, 10).map(item => item.title);
        } else {
          throw new Error('No news items found');
        }
      } catch (error) {
        console.log('News feed error, using fallback:', error.message);
        // Fallback to hardcoded good news
        newsHeadlines = [
          "Scientists discover high coral coverage at Water Point in the Great Barrier Reef",
          "Renewable energy capacity reaches new global highs",
          "Community gardens bring neighbours together across Australia",
          "Students raise funds for local wildlife rescue",
          "New technology helps clean ocean plastic more efficiently",
          "Volunteers plant 10,000 trees in local conservation effort",
          "Youth mental health initiatives show positive outcomes",
          "Local libraries report increased community engagement",
        ];
      }

      // Only auto-start if news is enabled
      if (newsEnabled && !newsRunning && newsHeadlines.length > 0) {
        startNewsCycle();
      }
    }

    function startNewsCycle() {
      if (!newsEnabled) return;
      newsRunning = true;
      newsIndex = 0;
      showNextNewsItem();
    }

    function showNextNewsItem() {
      // Don't show if news is disabled
      if (!newsEnabled) {
        elements.newsItem.classList.remove('visible');
        elements.newsSection.classList.remove('visible');
        newsRunning = false;
        return;
      }

      if (newsIndex >= newsHeadlines.length) {
        // All items shown, hide and rest for 5 minutes
        elements.newsItem.classList.remove('visible');
        elements.newsSection.classList.remove('visible');
        newsTimeout = setTimeout(() => {
          newsIndex = 0;
          loadGoodNews(); // Refresh news
          if (newsEnabled) {
            elements.newsSection.classList.add('visible');
            showNextNewsItem();
          }
        }, 5 * 60 * 1000); // 5 minutes rest
        return;
      }

      // Show current item
      elements.newsSection.classList.add('visible');
      elements.newsItem.textContent = newsHeadlines[newsIndex];
      elements.newsItem.classList.add('visible');

      // After 10 seconds, fade out and show next
      newsTimeout = setTimeout(() => {
        elements.newsItem.classList.remove('visible');
        setTimeout(() => {
          newsIndex++;
          showNextNewsItem();
        }, 500); // Wait for fade out
      }, 10 * 1000); // 10 seconds per item
    }

    function toggleNews() {
      newsEnabled = !newsEnabled;
      if (newsEnabled) {
        // Start showing news
        if (newsHeadlines.length > 0) {
          newsIndex = 0;
          newsRunning = true;
          showNextNewsItem();
        } else {
          loadGoodNews();
        }
      } else {
        // Stop and hide news
        if (newsTimeout) {
          clearTimeout(newsTimeout);
          newsTimeout = null;
        }
        elements.newsItem.classList.remove('visible');
        elements.newsSection.classList.remove('visible');
        newsRunning = false;
      }
    }

    // ============================================
    // DISPLAY UPDATE
    // ============================================
    function updateDisplay() {
      if (previewMode) return;

      const now = new Date();

      // Update time
      elements.timeDisplay.textContent = formatTime12Hour(now);

      // Update date
      elements.dateText.textContent = formatDateLong(now);

      // Update Wurundjeri season
      const season = getWurundjeriSeason(now);
      elements.seasonText.textContent = `Naarm ‚Äî ${season.name} ‚Äî ${season.meaning}`;

      // Update year progress
      const yearProgress = calculateYearProgress(now);
      elements.yearProgressFill.style.width = `${yearProgress}%`;
      elements.yearProgressPercent.textContent = `${Math.round(yearProgress)}%`;
      updateSparkler(yearProgress);

      // Get current schedule slot
      const currentSlot = getCurrentScheduleSlot(now);

      if (currentSlot) {
        // During school hours - show period but no class content
        elements.periodName.textContent = currentSlot.name;
        elements.currentDisplay.classList.add('empty-state');
        elements.currentDisplay.classList.remove('outside-hours');

        // Update period progress
        const slotProgress = getSlotProgress(currentSlot, now);
        elements.periodProgressFill.style.width = `${slotProgress}%`;
        elements.periodStartTime.textContent = formatTime12HourShort(currentSlot.start);
        elements.periodEndTime.textContent = formatTime12HourShort(currentSlot.end);
        elements.periodProgressSection.style.display = 'block';

        elements.classInfo.textContent = '';
        elements.activityDisplay.textContent = '';
      } else {
        // Outside school hours
        elements.currentDisplay.classList.add('outside-hours');
        elements.currentDisplay.classList.remove('empty-state');
        elements.periodName.textContent = 'Outside School Hours';
        elements.classInfo.textContent = '';
        elements.activityDisplay.textContent = '';
        elements.periodProgressSection.style.display = 'none';
      }
    }

    // ============================================
    // DATA LOADING
    // ============================================
    async function loadData() {
      try {
        const response = await fetch(CONFIG.dataUrl + '?t=' + Date.now());
        if (!response.ok) {
          throw new Error(`HTTP error! status: ${response.status}`);
        }
        appData = await response.json();

        // Use upcoming from data.json if available
        if (appData.upcoming && appData.upcoming.length > 0) {
          keyDates = appData.upcoming;
        }

        // Update room name if specified
        if (appData.room) {
          elements.roomName.textContent = appData.room;
        }

        console.log('Data loaded successfully');

      } catch (error) {
        console.log('No data.json found, using hardcoded dates');
        // Continue with hardcoded data - this is expected
      }

      // Show main UI regardless
      elements.loading.style.display = 'none';
      elements.header.style.display = 'flex';
      elements.yearProgressSection.style.display = 'block';
      elements.mainContent.style.display = 'flex';

      // Render key date markers
      renderKeyDateMarkers();

      lastRefreshDate = new Date();
    }

    function checkMorningRefresh() {
      const now = new Date();

      if (lastRefreshDate) {
        const lastDate = lastRefreshDate.toDateString();
        const todayDate = now.toDateString();

        if (lastDate !== todayDate &&
            now.getHours() >= CONFIG.morningRefreshHour &&
            now.getMinutes() >= CONFIG.morningRefreshMinute) {
          console.log('Morning refresh triggered');
          loadData();
        }
      }
    }

    // ============================================
    // WEATHER (Open-Meteo API - Melbourne)
    // ============================================
    const WEATHER_CONFIG = {
      latitude: -37.8136,
      longitude: 144.9631,
      refreshIntervalMs: 30 * 60 * 1000
    };

    let weatherData = null;

    async function loadWeather() {
      try {
        const url = `https://api.open-meteo.com/v1/forecast?latitude=${WEATHER_CONFIG.latitude}&longitude=${WEATHER_CONFIG.longitude}&daily=temperature_2m_max,temperature_2m_min,sunrise,sunset&current=temperature_2m,relative_humidity_2m,dew_point_2m&timezone=Australia%2FMelbourne&forecast_days=1`;

        const response = await fetch(url);
        if (!response.ok) throw new Error('Weather fetch failed');

        weatherData = await response.json();
        updateWeatherDisplay();
      } catch (error) {
        console.log('Weather unavailable:', error.message);
        elements.weatherDisplay.classList.remove('visible');
      }
    }

    function updateWeatherDisplay() {
      if (!weatherData) return;

      try {
        const current = weatherData.current;
        const daily = weatherData.daily;

        const temp = Math.round(current.temperature_2m);
        const dewPoint = Math.round(current.dew_point_2m);
        const min = Math.round(daily.temperature_2m_min[0]);
        const max = Math.round(daily.temperature_2m_max[0]);

        const sunrise = new Date(daily.sunrise[0]);
        const sunset = new Date(daily.sunset[0]);
        const sunriseStr = formatTime12Hour(sunrise).replace(' ', '');
        const sunsetStr = formatTime12Hour(sunset).replace(' ', '');

        elements.weatherDisplay.innerHTML =
          `<span>${temp}¬∞C</span>` +
          `<span>${min}¬∞/${max}¬∞</span>` +
          `<span>‚òÄ${sunriseStr}</span>` +
          `<span>‚òæ${sunsetStr}</span>` +
          `<span>Dew ${dewPoint}¬∞</span>`;

        elements.weatherDisplay.classList.add('visible');
      } catch (error) {
        console.log('Weather display error:', error.message);
      }
    }

    // ============================================
    // PREVIEW MODE / KEYBOARD NAVIGATION
    // ============================================
    function enterPreviewMode() {
      if (!previewMode) {
        previewMode = true;
        previewDate = new Date();
        previewPeriodIndex = getCurrentPeriodIndex();
        if (previewPeriodIndex < 0) previewPeriodIndex = 0;
      }
      updatePreviewIndicator();
      updatePreviewDisplay();
    }

    function exitPreviewMode() {
      previewMode = false;
      previewDate = null;
      previewPeriodIndex = 0;
      elements.previewIndicator.classList.remove('visible');
      updateDisplay();
    }

    function getCurrentPeriodIndex() {
      const now = new Date();
      const currentMinutes = now.getHours() * 60 + now.getMinutes();

      for (let i = 0; i < SCHEDULE.length; i++) {
        const slot = SCHEDULE[i];
        const startMinutes = timeToMinutes(slot.start);
        const endMinutes = timeToMinutes(slot.end);
        if (currentMinutes >= startMinutes && currentMinutes < endMinutes) {
          return i;
        }
      }
      return -1;
    }

    function navigatePeriod(direction) {
      enterPreviewMode();

      previewPeriodIndex += direction;

      if (previewPeriodIndex >= SCHEDULE.length) {
        previewDate.setDate(previewDate.getDate() + 1);
        previewPeriodIndex = 0;
      } else if (previewPeriodIndex < 0) {
        previewDate.setDate(previewDate.getDate() - 1);
        previewPeriodIndex = SCHEDULE.length - 1;
      }

      updatePreviewIndicator();
      updatePreviewDisplay();
    }

    function navigateDay(direction) {
      enterPreviewMode();
      previewDate.setDate(previewDate.getDate() + direction);
      updatePreviewIndicator();
      updatePreviewDisplay();
    }

    function navigateWeek(direction) {
      enterPreviewMode();
      previewDate.setDate(previewDate.getDate() + (direction * 7));
      updatePreviewIndicator();
      updatePreviewDisplay();
    }

    function updatePreviewIndicator() {
      const dateStr = formatDateLong(previewDate);
      const slot = SCHEDULE[previewPeriodIndex];
      elements.previewText.textContent = `${dateStr} ‚Äî ${slot.name}`;
      elements.previewIndicator.classList.add('visible');
    }

    function updatePreviewDisplay() {
      const slot = SCHEDULE[previewPeriodIndex];

      // Update date display
      elements.dateText.textContent = formatDateLong(previewDate);

      // Update Wurundjeri season
      const season = getWurundjeriSeason(previewDate);
      elements.seasonText.textContent = `Naarm ‚Äî ${season.name} ‚Äî ${season.meaning}`;

      // Update year progress
      const yearProgress = calculateYearProgress(previewDate);
      elements.yearProgressFill.style.width = `${yearProgress}%`;
      elements.yearProgressPercent.textContent = `${Math.round(yearProgress)}%`;
      updateSparkler(yearProgress);

      // Show period time
      elements.timeDisplay.textContent = formatTime12HourShort(slot.start);

      // Update period info - no class content
      elements.periodName.textContent = slot.name;
      elements.periodStartTime.textContent = formatTime12HourShort(slot.start);
      elements.periodEndTime.textContent = formatTime12HourShort(slot.end);
      elements.periodProgressFill.style.width = '0%';
      elements.periodProgressSection.style.display = 'block';

      elements.currentDisplay.classList.add('empty-state');
      elements.currentDisplay.classList.remove('outside-hours');
      elements.classInfo.textContent = '';
      elements.activityDisplay.textContent = '';
    }

    function setTextScale(key) {
      const scale = TEXT_SCALE_MAP[key];
      if (scale === undefined) return;

      document.documentElement.style.setProperty('--text-scale', scale);

      try { localStorage.setItem('displace-text-scale', key); } catch (e) {}

      elements.previewText.textContent = `Text size: ${key} (${Math.round(scale * 100)}%)`;
      elements.previewIndicator.classList.add('visible');
      setTimeout(() => {
        if (!previewMode) {
          elements.previewIndicator.classList.remove('visible');
        }
      }, 1500);
    }

    function loadTextScale() {
      try {
        const saved = localStorage.getItem('displace-text-scale');
        if (saved && TEXT_SCALE_MAP[saved] !== undefined) {
          document.documentElement.style.setProperty('--text-scale', TEXT_SCALE_MAP[saved]);
        }
      } catch (e) {}
    }

    function handleKeydown(event) {
      const key = event.key;

      if (key >= '1' && key <= '9' && !event.ctrlKey && !event.metaKey && !event.altKey) {
        setTextScale(key);
        event.preventDefault();
        return;
      }

      if (key === 'Escape' && previewMode) {
        exitPreviewMode();
        event.preventDefault();
        return;
      }

      if (key === 'ArrowLeft' || key === 'ArrowRight') {
        event.preventDefault();
        const direction = key === 'ArrowRight' ? 1 : -1;

        if (event.ctrlKey || event.metaKey) {
          navigateWeek(direction);
        } else if (event.shiftKey) {
          navigateDay(direction);
        } else {
          navigatePeriod(direction);
        }
      }

      // Debug: 'q' to cycle through quotes
      if (key === 'q' || key === 'Q') {
        if (showingQuote) {
          // If quote showing, dismiss and show next
          hideQuote();
          setTimeout(() => showQuote(), 600);
        } else {
          showQuote();
        }
        event.preventDefault();
        return;
      }

      // Toggle news with 'n' key
      if (key === 'n' || key === 'N') {
        toggleNews();
        event.preventDefault();
        return;
      }

      // Show help with '?' key
      if (key === '?') {
        showFirstRunGuide();
        event.preventDefault();
        return;
      }

      // Show This Day in History with 'd' key
      if (key === 'd' || key === 'D') {
        showThisDayInHistory();
        event.preventDefault();
        return;
      }

      // Show Word of the Day (vocabulary) with 'v' key
      if (key === 'v' || key === 'V') {
        showWordOfTheDay();
        event.preventDefault();
        return;
      }
    }

    // ============================================
    // FIRST RUN GUIDE
    // ============================================
    const firstRunOverlay = document.getElementById('first-run-overlay');
    const firstRunDismissBtn = document.getElementById('first-run-dismiss');
    const firstRunLaterBtn = document.getElementById('first-run-later');

    function checkFirstRun() {
      try {
        const seen = localStorage.getItem('displace-first-run-seen');
        if (!seen) {
          showFirstRunGuide();
        } else {
          hideFirstRunGuide();
        }
      } catch (e) {
        hideFirstRunGuide();
      }
    }

    function showFirstRunGuide() {
      firstRunOverlay.classList.remove('hidden');
    }

    function hideFirstRunGuide() {
      firstRunOverlay.classList.add('hidden');
    }

    function dismissFirstRunGuide(permanent) {
      if (permanent) {
        try {
          localStorage.setItem('displace-first-run-seen', 'true');
        } catch (e) {}
      }
      hideFirstRunGuide();
    }

    firstRunDismissBtn.addEventListener('click', () => dismissFirstRunGuide(true));
    firstRunLaterBtn.addEventListener('click', () => dismissFirstRunGuide(false));

    // Close on Escape
    firstRunOverlay.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        dismissFirstRunGuide(false);
        e.stopPropagation();
      }
    });

    // ============================================
    // INITIALIZATION
    // ============================================
    function init() {
      loadTextScale();
      loadData();

      // Check for first run
      checkFirstRun();

      // Start sparkler animation after a short delay (let DOM settle)
      setTimeout(startSparkler, 500);

      // Start update loop
      setInterval(updateDisplay, CONFIG.updateIntervalMs);

      // Schedule hourly refresh
      setInterval(loadData, CONFIG.refreshIntervalMs);

      // Check for morning refresh every minute
      setInterval(checkMorningRefresh, 60000);

      // Schedule upcoming events display
      setInterval(() => {
        if (!overlayBusy && !previewMode && getUpcomingEvents().length > 0) {
          showUpcomingEvent();
        }
      }, CONFIG.upcomingIntervalMs);

      // Initial upcoming show after 30 seconds
      setTimeout(() => {
        if (getUpcomingEvents().length > 0) {
          showUpcomingEvent();
        }
      }, 30000);

      // Schedule quotes
      function scheduleNextQuote() {
        const jitter = (Math.random() - 0.5) * 10 * 60 * 1000;
        const delay = CONFIG.quoteIntervalMs + jitter;
        setTimeout(() => {
          if (!overlayBusy && !previewMode) {
            showQuote();
          }
          scheduleNextQuote();
        }, delay);
      }
      scheduleNextQuote();

      // Load weather
      loadWeather();
      setInterval(loadWeather, WEATHER_CONFIG.refreshIntervalMs);

      // Pre-load good news (but don't display - press 'n' to toggle)
      loadGoodNews();

      // Keyboard navigation
      document.addEventListener('keydown', handleKeydown);
    }

    // Start the app
    init();
  </script>
</body>
</html>
