<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ongoing TLAC Audit</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: #f8f9fa;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        @media (max-width: 1024px) {
            .container {
                padding: 15px;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
        }

        header {
            background: #2c5aa0;
            color: white;
            padding: 15px 0;
            margin-bottom: 15px;
        }

        header h1 {
            font-size: 1.6rem;
            font-weight: 500;
        }

        .nav-tabs {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            border-bottom: 2px solid #e0e0e0;
        }

        .nav-tab {
            padding: 12px 24px;
            background: none;
            border: none;
            color: #666;
            cursor: pointer;
            font-size: 1rem;
            position: relative;
            min-height: 44px;
        }

        .nav-tab.active {
            color: #2c5aa0;
        }

        .nav-tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            right: 0;
            height: 2px;
            background: #2c5aa0;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .profile-section {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .profile-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group label {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 5px;
        }

        .form-group input, .form-group textarea {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 0.95rem;
        }

        .category-section {
            margin-bottom: 30px;
        }

        .category-header {
            background: linear-gradient(to right, #f0f4f8, #fff);
            padding: 14px 15px;
            border-left: 4px solid #2c5aa0;
            margin-bottom: 10px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            min-height: 48px;
        }

        .category-header:hover {
            background: linear-gradient(to right, #e8ecf0, #f8f9fa);
        }

        .category-header h2 {
            font-size: 1.2rem;
            font-weight: 500;
        }

        .category-expand-icon {
            transition: transform 0.3s;
            color: #666;
            font-size: 1.2rem;
            padding: 0 5px;
        }

        .category-expand-icon.collapsed {
            transform: rotate(-90deg);
        }

        .category-content {
            display: block;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .category-content.collapsed {
            display: none;
        }

        /* Subtle color coding for categories */
        .category-1 { border-left-color: #4a90e2; }
        .category-2 { border-left-color: #5cb85c; }
        .category-3 { border-left-color: #f0ad4e; }
        .category-4 { border-left-color: #5bc0de; }
        .category-5 { border-left-color: #d9534f; }
        .category-6 { border-left-color: #6f42c1; }
        .category-7 { border-left-color: #20c997; }

        .technique-item {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            margin-bottom: 6px;
            overflow: hidden;
        }

        .technique-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 10px 12px;
            cursor: pointer;
            min-height: 44px; /* Touch-friendly height */
        }

        @media (max-width: 768px) {
            .technique-name {
                flex-direction: column;
                align-items: flex-start;
                gap: 2px;
                width: 100%;
            }
            
            .technique-controls {
            display: flex;
            align-items: center;
            flex-shrink: 0;
        }
                white-space: normal;
                overflow: visible;
                text-overflow: unset;
            }
            
            .status-select {
                font-size: 0.85rem;
                padding: 4px 8px;
                min-width: 140px;
            }
            
            .technique-header {
                flex-wrap: wrap;
                gap: 8px;
            }
            
            .nav-tabs {
                overflow-x: auto;
                -webkit-overflow-scrolling: touch;
            }
        }

        .technique-header:hover {
            background: #f8f9fa;
        }

        .technique-name {
            font-weight: 500;
            flex: 1;
            display: flex;
            align-items: baseline;
            gap: 8px;
            min-width: 0;
        }

        .technique-title {
            font-weight: 600;
            flex-shrink: 0;
        }

        .technique-desc {
            font-style: italic;
            color: #666;
            font-size: 0.82rem;
            font-family: 'Arial Narrow', 'Helvetica Condensed', Arial, sans-serif;
            letter-spacing: -0.3px;
            line-height: 1.3;
            flex: 1;
            min-width: 0;
        }

        .status-select {
            padding: 6px 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 0.9rem;
            cursor: pointer;
            margin: 0 8px;
            min-width: 150px;
            background: white;
        }

        .status-often { background-color: #4caf50; color: white; }
        .status-occasionally { background-color: #8bc34a; color: white; }
        .status-dont-use { background-color: #795548; color: white; }
        .status-not-yet { background-color: #ff9800; color: white; }
        .status-not-suitable { background-color: #9e9e9e; color: white; }
        .status-other { background-color: white; color: #333; }

        .expand-icon {
            transition: transform 0.3s;
            color: #666;
            font-size: 1.1rem;
            padding: 0 5px;
        }

        .expand-icon.expanded {
            transform: rotate(180deg);
        }

        .technique-details {
            display: none;
            padding: 12px;
            background: #f8f9fa;
            border-top: 1px solid #e0e0e0;
        }

        .technique-details.show {
            display: block;
        }

        .detail-section {
            margin-bottom: 12px;
        }

        .detail-section h4 {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 6px;
        }

        .links-section {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .link-button {
            padding: 6px 12px;
            background: #2c5aa0;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            font-size: 0.83rem;
            display: inline-block;
            min-height: 32px;
            line-height: 20px;
        }

        .link-button:hover {
            background: #1e3d6f;
        }

        .notes-textarea {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            resize: vertical;
            min-height: 60px;
            font-size: 0.85rem;
        }

        .notes-history {
            margin-top: 8px;
            max-height: 150px;
            overflow-y: auto;
        }

        .note-entry {
            padding: 6px;
            background: white;
            border-radius: 4px;
            margin-bottom: 4px;
            font-size: 0.82rem;
        }

        .note-timestamp {
            color: #666;
            font-size: 0.8rem;
        }

        .global-notes {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-top: 30px;
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .btn {
            padding: 10px 18px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: opacity 0.3s;
            min-height: 40px;
        }

        .btn:hover {
            opacity: 0.8;
        }

        .btn-primary {
            background: #2c5aa0;
            color: white;
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-warning {
            background: #ffc107;
            color: #333;
        }

        .side-notification {
            position: fixed;
            right: -300px;
            top: 50%;
            transform: translateY(-50%);
            background: #fff3cd;
            border: 1px solid #ffeeba;
            border-radius: 8px 0 0 8px;
            padding: 15px;
            width: 280px;
            transition: right 0.3s;
            z-index: 1000;
        }

        .side-notification.show {
            right: 0;
        }

        .notification-close {
            float: right;
            cursor: pointer;
            color: #856404;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .dashboard-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }

        .dashboard-card h3 {
            margin-bottom: 15px;
            color: #2c5aa0;
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #f0f0f0;
        }

        .stat-label {
            color: #666;
        }

        .stat-value {
            font-weight: 500;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin-top: 10px;
        }

        .progress-fill {
            height: 100%;
            background: #4caf50;
            transition: width 0.3s;
        }

        .import-section {
            margin-top: 10px;
        }

        #fileInput {
            display: none;
        }

        .file-label {
            display: inline-block;
            padding: 10px 18px;
            background: #2c5aa0;
            color: white;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            min-height: 40px;
            line-height: 20px;
        }

        .other-input {
            margin-top: 8px;
            width: 100%;
            padding: 6px;
            border: 1px solid #ddd;
            border-radius: 4px;
            display: none;
            font-size: 0.9rem;
        }

        .other-input.show {
            display: block;
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <h1>Ongoing TLAC Audit</h1>
        </div>
    </header>

    <div class="container">
        <div class="nav-tabs">
            <button class="nav-tab active" id="techniques-tab-btn">Techniques</button>
            <button class="nav-tab" id="dashboard-tab-btn">Dashboard</button>
            <button class="nav-tab" id="profile-tab-btn">Profile</button>
            <button class="nav-tab" id="utilities-tab-btn">Utilities</button>
        </div>

        <!-- Techniques Tab -->
        <div id="techniques-tab" class="tab-content active">
            <div id="techniques-container"></div>
            
            <div class="global-notes">
                <h3>Global Notes</h3>
                <textarea id="global-notes-input" class="notes-textarea" placeholder="Add your overall observations, reflections, and insights here..."></textarea>
                <button class="btn btn-primary" onclick="saveGlobalNote()">Save Note</button>
                <div id="global-notes-history" class="notes-history"></div>
            </div>
        </div>

        <!-- Dashboard Tab -->
        <div id="dashboard-tab" class="tab-content">
            <div class="dashboard-grid">
                <div class="dashboard-card">
                    <h3>Usage Overview</h3>
                    <div id="usage-stats"></div>
                </div>
                <div class="dashboard-card">
                    <h3>Category Progress</h3>
                    <div id="category-progress"></div>
                </div>
                <div class="dashboard-card">
                    <h3>Recent Activity</h3>
                    <div id="recent-activity"></div>
                </div>
                <div class="dashboard-card">
                    <h3>Implementation Summary</h3>
                    <div id="implementation-summary"></div>
                </div>
            </div>
        </div>

        <!-- Profile Tab -->
        <div id="profile-tab" class="tab-content">
            <div class="profile-section">
                <h3>Teacher Information</h3>
                <div class="profile-grid">
                    <div class="form-group">
                        <label>Name</label>
                        <input type="text" id="teacher-name" placeholder="Your name">
                    </div>
                    <div class="form-group">
                        <label>Years Teaching</label>
                        <input type="number" id="years-teaching" placeholder="e.g., 5">
                    </div>
                    <div class="form-group">
                        <label>Current Classes</label>
                        <textarea id="current-classes" placeholder="List your current classes, one per line"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Previous Classes</label>
                        <textarea id="previous-classes" placeholder="List previous classes, one per line"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Areas of Expertise</label>
                        <textarea id="expertise-areas" placeholder="List your areas of expertise, separated by commas"></textarea>
                    </div>
                    <div class="form-group">
                        <label>Professional Interests</label>
                        <textarea id="interests" placeholder="Your professional development interests"></textarea>
                    </div>
                </div>
                <button class="btn btn-primary" onclick="saveProfile()">Save Profile</button>
            </div>
        </div>

        <!-- Utilities Tab -->
        <div id="utilities-tab" class="tab-content">
            <div class="profile-section">
                <h3>Data Management</h3>
                <div class="action-buttons" style="flex-direction: column; align-items: stretch; gap: 20px;">
                    <div>
                        <h4 style="margin-bottom: 10px; color: #666;">Export & Import</h4>
                        <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                            <button class="btn btn-primary" onclick="exportData()">Export Data</button>
                            <button class="btn btn-secondary" onclick="emailData()">Email Report</button>
                            <div class="import-section" style="margin: 0;">
                                <input type="file" id="fileInput" accept=".json" onchange="importData(event)">
                                <label for="fileInput" class="file-label">Import Data</label>
                            </div>
                        </div>
                    </div>
                    <div>
                        <h4 style="margin-bottom: 10px; color: #666;">Backup</h4>
                        <button class="btn btn-warning" onclick="saveToLocal()">Save Backup</button>
                        <p style="margin-top: 10px; color: #666; font-size: 0.9rem;">Last backup: <span id="last-backup-date">Never</span></p>
                    </div>
                    <div>
                        <h4 style="margin-bottom: 10px; color: #666;">Data Summary</h4>
                        <div id="data-summary" style="padding: 15px; background: #f8f9fa; border-radius: 4px; font-size: 0.9rem;"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="side-notification" id="backup-reminder">
        <span class="notification-close" onclick="hideReminder()">✕</span>
        <h4>Backup Reminder</h4>
        <p>It's been a week since your last backup. Consider saving your data to ensure nothing is lost.</p>
        <button class="btn btn-warning" onclick="saveToLocal(); hideReminder();">Save Backup Now</button>
    </div>

    <script>
        // TLAC Techniques Data
        const tlacData = {
            "Checking for Understanding": [
                { id: 1, name: "Reject Self-Report", description: "Move beyond student self-assessment to verify understanding through objective measures" },
                { id: 2, name: "Targeted Questioning", description: "Ask specific questions to check understanding of key concepts" },
                { id: 3, name: "Standardize the Format", description: "Use consistent formats for student responses to make assessment efficient" },
                { id: 4, name: "Active Observation", description: "Systematically observe student work and behavior during independent practice" },
                { id: 5, name: "Show Me", description: "Have students display their understanding through visual signals or written work" },
                { id: 6, name: "Affirmative Checking", description: "Use positive sampling to verify that students are meeting expectations" }
            ],
            "Academic Ethos": [
                { id: 7, name: "Plan for Error", description: "Anticipate common mistakes and plan how to address them" },
                { id: 8, name: "Culture of Error", description: "Create an environment where mistakes are valued as learning opportunities" },
                { id: 9, name: "Excavate Error", description: "Dig into errors to understand and address root causes" },
                { id: 10, name: "Own and Track", description: "Students track their own progress and take ownership of learning" },
                { id: 11, name: "No Opt Out", description: "Ensure all students answer correctly before moving on" },
                { id: 12, name: "Right is Right", description: "Set and defend a high standard for correctness" },
                { id: 13, name: "Stretch It", description: "Extend learning with challenging follow-up questions" },
                { id: 14, name: "Format Matters", description: "Require complete sentences and proper academic language" },
                { id: 15, name: "Without Apology", description: "Teach content without apology or dilution" }
            ],
            "Ratio": [
                { id: 16, name: "Think Ratio", description: "Maximize the cognitive work students do versus teacher" },
                { id: 17, name: "Wait Time", description: "Provide thinking time after posing questions" },
                { id: 18, name: "Cold Call", description: "Call on students regardless of hand-raising" },
                { id: 19, name: "Call and Response", description: "Use whole-class choral response for key points" },
                { id: 20, name: "Break It Down", description: "Simplify complex tasks into manageable steps" },
                { id: 21, name: "Ratio Through Writing", description: "Increase student thinking through written responses" },
                { id: 22, name: "Ratio Through Discussion", description: "Structure discussions to maximize student participation" },
                { id: 23, name: "Turn and Talk", description: "Brief paired discussions to process information" }
            ],
            "Behavior and Culture": [
                { id: 24, name: "Radar/Be Seen Looking", description: "Demonstrate awareness of all classroom activity" },
                { id: 25, name: "Make Compliance Visible", description: "Ensure compliance is observable to maintain standards" },
                { id: 26, name: "Least Invasive Intervention", description: "Correct behavior with minimal disruption to learning" },
                { id: 27, name: "Firm, Calm Finesse", description: "Address behavior with quiet confidence and respect" },
                { id: 28, name: "Art of the Consequence", description: "Apply consequences consistently and instructionally" },
                { id: 29, name: "What to Do", description: "Give specific, concrete, observable directions" },
                { id: 30, name: "Strong Voice", description: "Project authority through tone and body language" },
                { id: 31, name: "Positive Framing", description: "Frame corrections positively and build momentum" },
                { id: 32, name: "Precise Praise", description: "Offer specific, genuine praise for effort and achievement" },
                { id: 33, name: "Warm/Strict", description: "Be both caring and exacting simultaneously" },
                { id: 34, name: "Emotional Constancy", description: "Maintain steady emotional tone regardless of student behavior" },
                { id: 35, name: "Joy Factor", description: "Celebrate learning and create joyful classroom moments" }
            ],
            "Building Student Motivation and Trust": [
                { id: 36, name: "Habits of Attention", description: "Teach and reinforce habits of focused attention" },
                { id: 37, name: "Threshold", description: "Meet students at the door to establish tone" },
                { id: 38, name: "Change the Pace", description: "Vary activities and pace to maintain engagement" },
                { id: 39, name: "Brighten the Lines", description: "Make transitions between activities crisp and clear" },
                { id: 40, name: "All Hands", description: "Use gestures and movement to maintain engagement" },
                { id: 41, name: "Work the Clock", description: "Use time limits to create productive urgency" },
                { id: 42, name: "Every Minute Matters", description: "Maximize instructional time and eliminate downtime" }
            ],
            "Lesson Structures": [
                { id: 43, name: "Board = Paper", description: "Model note-taking by having board match student papers" },
                { id: 44, name: "Double Plan", description: "Plan both what you'll teach and what students will do" },
                { id: 45, name: "Do Now", description: "Start class with brief independent work" },
                { id: 46, name: "Exit Ticket", description: "End class with brief assessment of learning" },
                { id: 47, name: "Retrieval Practice", description: "Regular practice recalling information from memory" },
                { id: 48, name: "Go Conceptual", description: "Move from procedural to conceptual understanding" }
            ],
            "Procedures and Routines": [
                { id: 49, name: "Strategic Investment", description: "Invest time in teaching important procedures thoroughly" },
                { id: 50, name: "Do It Again", description: "Practice procedures until they meet expectations" },
                { id: 51, name: "Engineer Efficiency", description: "Design procedures for maximum efficiency" },
                { id: 52, name: "Procedure and Routine", description: "Establish clear, consistent classroom procedures" }
            ]
        };

        // Initialize application data
        let appData = {
            profile: {
                name: '',
                yearsTeaching: 0,
                currentClasses: [],
                previousClasses: [],
                expertiseAreas: [],
                interests: ''
            },
            techniques: {},
            globalNotes: [],
            lastBackup: null
        };

        // Load data from localStorage
        function loadData() {
            const saved = localStorage.getItem('tlacAuditData');
            if (saved) {
                appData = JSON.parse(saved);
            }
            initializeTechniques();
            renderTechniques();
            loadProfile();
            loadGlobalNotes();
            updateDashboard();
            checkBackupReminder();
        }

        // Initialize techniques if not already in data
        function initializeTechniques() {
            Object.entries(tlacData).forEach(([category, techniques]) => {
                techniques.forEach(technique => {
                    if (!appData.techniques[technique.id]) {
                        appData.techniques[technique.id] = {
                            status: 'not-yet',
                            otherText: '',
                            notes: []
                        };
                    }
                });
            });
        }

        // Save data to localStorage
        function saveData() {
            localStorage.setItem('tlacAuditData', JSON.stringify(appData));
        }

        // Render techniques
        function renderTechniques() {
            const container = document.getElementById('techniques-container');
            container.innerHTML = '';
            
            Object.entries(tlacData).forEach(([category, techniques], categoryIndex) => {
                const section = document.createElement('div');
                section.className = 'category-section';
                
                const header = document.createElement('div');
                header.className = `category-header category-${categoryIndex + 1}`;
                header.onclick = () => toggleCategory(categoryIndex);
                header.innerHTML = '<h2>Part ' + (categoryIndex + 1) + ': ' + category + '</h2>' +
                    '<span class="category-expand-icon collapsed" id="cat-icon-' + categoryIndex + '">▼</span>';
                section.appendChild(header);
                
                const content = document.createElement('div');
                content.className = 'category-content collapsed';
                content.id = 'category-content-' + categoryIndex;
                
                techniques.forEach(technique => {
                    const item = createTechniqueElement(technique, categoryIndex);
                    content.appendChild(item);
                });
                
                section.appendChild(content);
                container.appendChild(section);
            });
        }

        // Toggle category
        function toggleCategory(index) {
            const content = document.getElementById('category-content-' + index);
            const icon = document.getElementById('cat-icon-' + index);
            content.classList.toggle('collapsed');
            icon.classList.toggle('collapsed');
        }

        // Create technique element
        function createTechniqueElement(technique, categoryIndex) {
            const item = document.createElement('div');
            item.className = 'technique-item';
            
            const data = appData.techniques[technique.id] || { status: 'not-yet', notes: [] };
            
            const notesHTML = data.notes.map(note => 
                '<div class="note-entry">' +
                    '<div class="note-timestamp">' + new Date(note.timestamp).toLocaleString() + '</div>' +
                    '<div>' + note.text + '</div>' +
                '</div>'
            ).join('');
            
            const otherInputHTML = data.status === 'other' ? 
                '<input type="text" class="other-input show" value="' + (data.otherText || '') + 
                '" placeholder="Please specify..." onchange="updateOtherText(' + technique.id + ', this.value)">' : '';
            
            const chatGPTPrompt = 'Search for information about teachlikeachampion.org ' + technique.name + ' and explain simply with examples';
            
            item.innerHTML = 
                '<div class="technique-header" onclick="toggleDetails(' + technique.id + ')">' +
                    '<span class="technique-name">' +
                        '<span class="technique-title">' + technique.id + '. ' + technique.name + '</span>' +
                        '<span class="technique-desc">' + technique.description + '</span>' +
                    '</span>' +
                    '<div style="display: flex; align-items: center; flex-shrink: 0;">' +
                        '<select class="status-select status-' + data.status + '" onclick="event.stopPropagation()" onchange="updateStatus(' + technique.id + ', this.value, this)">' +
                            '<option value="often" ' + (data.status === 'often' ? 'selected' : '') + '>I use this often</option>' +
                            '<option value="occasionally" ' + (data.status === 'occasionally' ? 'selected' : '') + '>I use this occasionally</option>' +
                            '<option value="dont-use" ' + (data.status === 'dont-use' ? 'selected' : '') + '>I don\'t use this</option>' +
                            '<option value="not-yet" ' + (data.status === 'not-yet' ? 'selected' : '') + '>I haven\'t used this yet</option>' +
                            '<option value="not-suitable" ' + (data.status === 'not-suitable' ? 'selected' : '') + '>This does not suit me</option>' +
                            '<option value="other" ' + (data.status === 'other' ? 'selected' : '') + '>Other</option>' +
                        '</select>' +
                        '<span class="expand-icon" id="icon-' + technique.id + '">▼</span>' +
                    '</div>' +
                '</div>' +
                '<div class="technique-details" id="details-' + technique.id + '">' +
                    otherInputHTML +
                    '<div class="detail-section">' +
                        '<h4>Resources</h4>' +
                        '<div class="links-section">' +
                            '<a href="https://www.google.com/search?q=teachlikeachampion.org+' + encodeURIComponent(technique.name) + '" class="link-button" target="_blank" rel="noopener">Google Search</a>' +
                            '<a href="https://www.youtube.com/results?search_query=teachlikeachampion+' + encodeURIComponent(technique.name) + '" class="link-button" target="_blank" rel="noopener">YouTube</a>' +
                            '<a href="https://chat.openai.com/?q=' + encodeURIComponent(chatGPTPrompt) + '" class="link-button" target="_blank" rel="noopener" title="Prompt: ' + chatGPTPrompt + '">ChatGPT</a>' +
                        '</div>' +
                    '</div>' +
                    '<div class="detail-section">' +
                        '<h4>Personal Notes</h4>' +
                        '<textarea class="notes-textarea" id="note-input-' + technique.id + '" placeholder="Share your successes, challenges, and considerations..."></textarea>' +
                        '<button class="btn btn-primary" onclick="saveTechniqueNote(' + technique.id + ')">Add Note</button>' +
                        '<div class="notes-history" id="notes-' + technique.id + '">' +
                            notesHTML +
                        '</div>' +
                    '</div>' +
                '</div>';
            
            return item;
        }

        // Toggle technique details
        function toggleDetails(id) {
            const details = document.getElementById('details-' + id);
            const icon = document.getElementById('icon-' + id);
            details.classList.toggle('show');
            icon.classList.toggle('expanded');
        }

        // Update technique status
        function updateStatus(id, status, selectElement) {
            appData.techniques[id].status = status;
            selectElement.className = 'status-select status-' + status;
            
            // Show/hide other input
            const details = document.getElementById('details-' + id);
            const existingOtherInput = details.querySelector('.other-input');
            
            if (status === 'other') {
                if (!existingOtherInput) {
                    const otherInput = document.createElement('input');
                    otherInput.type = 'text';
                    otherInput.className = 'other-input show';
                    otherInput.placeholder = 'Please specify...';
                    otherInput.value = appData.techniques[id].otherText || '';
                    otherInput.onchange = (e) => updateOtherText(id, e.target.value);
                    details.insertBefore(otherInput, details.firstChild);
                } else {
                    existingOtherInput.classList.add('show');
                }
            } else if (existingOtherInput) {
                existingOtherInput.classList.remove('show');
            }
            
            saveData();
            updateDashboard();
        }

        // Update other text
        function updateOtherText(id, text) {
            appData.techniques[id].otherText = text;
            saveData();
        }

        // Save technique note
        function saveTechniqueNote(id) {
            const input = document.getElementById('note-input-' + id);
            const text = input.value.trim();
            
            if (text) {
                if (!appData.techniques[id].notes) {
                    appData.techniques[id].notes = [];
                }
                
                appData.techniques[id].notes.unshift({
                    text: text,
                    timestamp: new Date().toISOString()
                });
                
                input.value = '';
                saveData();
                
                // Update display
                const notesContainer = document.getElementById('notes-' + id);
                const noteEntry = document.createElement('div');
                noteEntry.className = 'note-entry';
                noteEntry.innerHTML = '<div class="note-timestamp">' + new Date().toLocaleString() + '</div>' +
                    '<div>' + text + '</div>';
                notesContainer.insertBefore(noteEntry, notesContainer.firstChild);
            }
        }

        // Save global note
        function saveGlobalNote() {
            const input = document.getElementById('global-notes-input');
            const text = input.value.trim();
            
            if (text) {
                appData.globalNotes.unshift({
                    text: text,
                    timestamp: new Date().toISOString()
                });
                
                input.value = '';
                saveData();
                loadGlobalNotes();
            }
        }

        // Load global notes
        function loadGlobalNotes() {
            const container = document.getElementById('global-notes-history');
            container.innerHTML = appData.globalNotes.map(note => 
                '<div class="note-entry">' +
                    '<div class="note-timestamp">' + new Date(note.timestamp).toLocaleString() + '</div>' +
                    '<div>' + note.text + '</div>' +
                '</div>'
            ).join('');
        }

        // Switch tabs
        function switchTab(tabName) {
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            document.getElementById(tabName + '-tab-btn').classList.add('active');
            document.getElementById(tabName + '-tab').classList.add('active');
            
            if (tabName === 'dashboard') {
                updateDashboard();
            } else if (tabName === 'utilities') {
                updateUtilities();
            }
        }

        // Update utilities tab
        function updateUtilities() {
            // Update last backup date
            const lastBackupElement = document.getElementById('last-backup-date');
            if (appData.lastBackup) {
                lastBackupElement.textContent = new Date(appData.lastBackup).toLocaleString();
            } else {
                lastBackupElement.textContent = 'Never';
            }
            
            // Update data summary
            const usageStats = {};
            Object.values(appData.techniques).forEach(tech => {
                usageStats[tech.status] = (usageStats[tech.status] || 0) + 1;
            });
            
            const totalNotes = appData.globalNotes.length + 
                Object.values(appData.techniques).reduce((sum, tech) => sum + (tech.notes?.length || 0), 0);
            
            const summaryHTML = '<strong>Profile:</strong> ' + (appData.profile.name || 'Not set') + '<br>' +
                '<strong>Techniques Tracked:</strong> ' + Object.keys(appData.techniques).length + '/52<br>' +
                '<strong>Total Notes:</strong> ' + totalNotes + '<br>' +
                '<strong>Implementation Rate:</strong> ' + (((usageStats.often || 0) + (usageStats.occasionally || 0)) / 52 * 100).toFixed(1) + '%<br>' +
                '<strong>Data Size:</strong> ' + (JSON.stringify(appData).length / 1024).toFixed(1) + ' KB';
            
            document.getElementById('data-summary').innerHTML = summaryHTML;
        }

        // Update dashboard
        function updateDashboard() {
            // Usage statistics
            const usageStats = {
                often: 0,
                occasionally: 0,
                'dont-use': 0,
                'not-yet': 0,
                'not-suitable': 0,
                other: 0
            };
            
            Object.values(appData.techniques).forEach(technique => {
                usageStats[technique.status]++;
            });
            
            const totalTechniques = Object.keys(appData.techniques).length;
            const implemented = usageStats.often + usageStats.occasionally;
            const implementationRate = totalTechniques > 0 ? (implemented / totalTechniques * 100).toFixed(1) : 0;
            
            document.getElementById('usage-stats').innerHTML = 
                '<div class="stat-row">' +
                    '<span class="stat-label">Used Often</span>' +
                    '<span class="stat-value" style="color: #4caf50">' + usageStats.often + '</span>' +
                '</div>' +
                '<div class="stat-row">' +
                    '<span class="stat-label">Used Occasionally</span>' +
                    '<span class="stat-value" style="color: #8bc34a">' + usageStats.occasionally + '</span>' +
                '</div>' +
                '<div class="stat-row">' +
                    '<span class="stat-label">Not Used</span>' +
                    '<span class="stat-value" style="color: #795548">' + usageStats['dont-use'] + '</span>' +
                '</div>' +
                '<div class="stat-row">' +
                    '<span class="stat-label">Not Yet Tried</span>' +
                    '<span class="stat-value" style="color: #ff9800">' + usageStats['not-yet'] + '</span>' +
                '</div>' +
                '<div class="stat-row">' +
                    '<span class="stat-label">Not Suitable</span>' +
                    '<span class="stat-value" style="color: #9e9e9e">' + usageStats['not-suitable'] + '</span>' +
                '</div>' +
                '<div class="progress-bar">' +
                    '<div class="progress-fill" style="width: ' + implementationRate + '%"></div>' +
                '</div>' +
                '<p style="text-align: center; margin-top: 10px; color: #666;">Implementation Rate: ' + implementationRate + '%</p>';
            
            // Category progress
            let categoryHTML = '';
            Object.entries(tlacData).forEach(([category, techniques]) => {
                const categoryStats = techniques.reduce((acc, tech) => {
                    const status = appData.techniques[tech.id]?.status || 'not-yet';
                    if (status === 'often' || status === 'occasionally') acc.implemented++;
                    acc.total++;
                    return acc;
                }, { implemented: 0, total: 0 });
                
                const percentage = (categoryStats.implemented / categoryStats.total * 100).toFixed(0);
                categoryHTML += '<div class="stat-row">' +
                    '<span class="stat-label">' + category + '</span>' +
                    '<span class="stat-value">' + categoryStats.implemented + '/' + categoryStats.total + '</span>' +
                '</div>' +
                '<div class="progress-bar" style="margin-bottom: 15px">' +
                    '<div class="progress-fill" style="width: ' + percentage + '%"></div>' +
                '</div>';
            });
            document.getElementById('category-progress').innerHTML = categoryHTML;
            
            // Recent activity
            const allNotes = [];
            Object.entries(appData.techniques).forEach(([id, data]) => {
                if (data.notes) {
                    data.notes.forEach(note => {
                        allNotes.push({
                            type: 'technique',
                            techniqueId: id,
                            ...note
                        });
                    });
                }
            });
            appData.globalNotes.forEach(note => {
                allNotes.push({
                    type: 'global',
                    ...note
                });
            });
            
            allNotes.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            const recentNotes = allNotes.slice(0, 5);
            
            document.getElementById('recent-activity').innerHTML = recentNotes.map(note => {
                const label = note.type === 'global' ? 'Global Note' : 'Technique ' + note.techniqueId;
                return '<div class="note-entry">' +
                    '<div class="note-timestamp">' + new Date(note.timestamp).toLocaleString() + ' - ' + label + '</div>' +
                    '<div>' + note.text.substring(0, 100) + (note.text.length > 100 ? '...' : '') + '</div>' +
                '</div>';
            }).join('') || '<p style="color: #666;">No recent activity</p>';
            
            // Implementation summary
            const summaryHTML = '<p><strong>Total Techniques:</strong> ' + totalTechniques + '</p>' +
                '<p><strong>Actively Using:</strong> ' + implemented + ' (' + implementationRate + '%)</p>' +
                '<p><strong>Total Notes:</strong> ' + allNotes.length + '</p>' +
                '<p><strong>Last Updated:</strong> ' + new Date().toLocaleDateString() + '</p>';
            document.getElementById('implementation-summary').innerHTML = summaryHTML;
        }

        // Save profile
        function saveProfile() {
            appData.profile = {
                name: document.getElementById('teacher-name').value,
                yearsTeaching: document.getElementById('years-teaching').value,
                currentClasses: document.getElementById('current-classes').value.split('\n').filter(c => c.trim()),
                previousClasses: document.getElementById('previous-classes').value.split('\n').filter(c => c.trim()),
                expertiseAreas: document.getElementById('expertise-areas').value.split(',').map(e => e.trim()).filter(e => e),
                interests: document.getElementById('interests').value
            };
            saveData();
            alert('Profile saved successfully');
        }

        // Load profile
        function loadProfile() {
            document.getElementById('teacher-name').value = appData.profile.name || '';
            document.getElementById('years-teaching').value = appData.profile.yearsTeaching || '';
            document.getElementById('current-classes').value = (appData.profile.currentClasses || []).join('\n');
            document.getElementById('previous-classes').value = (appData.profile.previousClasses || []).join('\n');
            document.getElementById('expertise-areas').value = (appData.profile.expertiseAreas || []).join(', ');
            document.getElementById('interests').value = appData.profile.interests || '';
        }

        // Export data
        function exportData() {
            const dataStr = JSON.stringify(appData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'ongoing-tlac-audit-' + new Date().toISOString().split('T')[0] + '.json';
            link.click();
            
            appData.lastBackup = new Date().toISOString();
            saveData();
        }

        // Import data
        function importData(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const imported = JSON.parse(e.target.result);
                        if (confirm('This will replace all current data. Continue?')) {
                            appData = imported;
                            saveData();
                            location.reload();
                        }
                    } catch (error) {
                        alert('Invalid file format');
                    }
                };
                reader.readAsText(file);
            }
        }

        // Email data
        function emailData() {
            const summary = generateReadableSummary();
            const detailedReport = generateDetailedReport();
            const jsonData = JSON.stringify(appData, null, 2);
            
            const subject = encodeURIComponent('Ongoing TLAC Audit Report - ' + (appData.profile.name || 'Teacher') + ' - ' + new Date().toLocaleDateString());
            const body = encodeURIComponent(summary + '\n\n' + detailedReport + '\n\n--- JSON DATA (for import) ---\n' + jsonData);
            
            const mailtoLink = 'mailto:?subject=' + subject + '&body=' + body;
            window.location.href = mailtoLink;
        }

        // Generate detailed human-readable report
        function generateDetailedReport() {
            let report = '=== DETAILED TECHNIQUE STATUS ===\n\n';
            
            // Group techniques by status
            const statusGroups = {
                'often': [],
                'occasionally': [],
                'dont-use': [],
                'not-yet': [],
                'not-suitable': [],
                'other': []
            };
            
            Object.entries(tlacData).forEach(([category, techniques]) => {
                techniques.forEach(tech => {
                    const data = appData.techniques[tech.id];
                    if (data) {
                        statusGroups[data.status].push({
                            category: category,
                            technique: tech,
                            data: data
                        });
                    }
                });
            });
            
            // Add techniques by status with all their notes
            if (statusGroups.often.length > 0) {
                report += 'FREQUENTLY USED TECHNIQUES:\n';
                statusGroups.often.forEach(item => {
                    report += '  • ' + item.technique.name + ' (' + item.category + ')\n';
                    if (item.data.notes && item.data.notes.length > 0) {
                        report += '    Notes (' + item.data.notes.length + ' entries):\n';
                        item.data.notes.forEach(note => {
                            const date = new Date(note.timestamp).toLocaleString();
                            report += '      - [' + date + '] ' + note.text + '\n';
                        });
                    }
                });
                report += '\n';
            }
            
            if (statusGroups.occasionally.length > 0) {
                report += 'OCCASIONALLY USED TECHNIQUES:\n';
                statusGroups.occasionally.forEach(item => {
                    report += '  • ' + item.technique.name + ' (' + item.category + ')\n';
                    if (item.data.notes && item.data.notes.length > 0) {
                        report += '    Notes (' + item.data.notes.length + ' entries):\n';
                        item.data.notes.forEach(note => {
                            const date = new Date(note.timestamp).toLocaleString();
                            report += '      - [' + date + '] ' + note.text + '\n';
                        });
                    }
                });
                report += '\n';
            }
            
            if (statusGroups['dont-use'].length > 0) {
                report += 'TECHNIQUES NOT CURRENTLY USED:\n';
                statusGroups['dont-use'].forEach(item => {
                    report += '  • ' + item.technique.name + ' (' + item.category + ')\n';
                    if (item.data.notes && item.data.notes.length > 0) {
                        report += '    Notes:\n';
                        item.data.notes.forEach(note => {
                            const date = new Date(note.timestamp).toLocaleString();
                            report += '      - [' + date + '] ' + note.text + '\n';
                        });
                    }
                });
                report += '\n';
            }
            
            if (statusGroups['not-yet'].length > 0) {
                report += 'TECHNIQUES TO EXPLORE:\n';
                statusGroups['not-yet'].forEach(item => {
                    report += '  • ' + item.technique.name + ' (' + item.category + ')\n';
                    if (item.data.notes && item.data.notes.length > 0) {
                        report += '    Notes:\n';
                        item.data.notes.forEach(note => {
                            const date = new Date(note.timestamp).toLocaleString();
                            report += '      - [' + date + '] ' + note.text + '\n';
                        });
                    }
                });
                report += '\n';
            }
            
            if (statusGroups['not-suitable'].length > 0) {
                report += 'TECHNIQUES NOT SUITABLE:\n';
                statusGroups['not-suitable'].forEach(item => {
                    report += '  • ' + item.technique.name + ' (' + item.category + ')\n';
                    if (item.data.notes && item.data.notes.length > 0) {
                        report += '    Notes:\n';
                        item.data.notes.forEach(note => {
                            const date = new Date(note.timestamp).toLocaleString();
                            report += '      - [' + date + '] ' + note.text + '\n';
                        });
                    }
                });
                report += '\n';
            }
            
            if (statusGroups.other.length > 0) {
                report += 'TECHNIQUES WITH CUSTOM STATUS:\n';
                statusGroups.other.forEach(item => {
                    report += '  • ' + item.technique.name + ' (' + item.category + ')\n';
                    report += '    Status: ' + (item.data.otherText || 'Other') + '\n';
                    if (item.data.notes && item.data.notes.length > 0) {
                        report += '    Notes:\n';
                        item.data.notes.forEach(note => {
                            const date = new Date(note.timestamp).toLocaleString();
                            report += '      - [' + date + '] ' + note.text + '\n';
                        });
                    }
                });
                report += '\n';
            }
            
            // Add category breakdown with details
            report += '=== PROGRESS BY CATEGORY ===\n\n';
            Object.entries(tlacData).forEach(([category, techniques]) => {
                const categoryStats = techniques.reduce((acc, tech) => {
                    const status = appData.techniques[tech.id]?.status || 'not-yet';
                    if (status === 'often' || status === 'occasionally') acc.implemented++;
                    acc.total++;
                    const techNotes = appData.techniques[tech.id]?.notes || [];
                    acc.totalNotes += techNotes.length;
                    return acc;
                }, { implemented: 0, total: 0, totalNotes: 0 });
                
                const percentage = (categoryStats.implemented / categoryStats.total * 100).toFixed(0);
                report += category + ':\n';
                report += '  Implementation: ' + categoryStats.implemented + '/' + categoryStats.total + ' (' + percentage + '%)\n';
                report += '  Total Notes: ' + categoryStats.totalNotes + '\n\n';
            });
            
            // Add ALL global observations
            if (appData.globalNotes && appData.globalNotes.length > 0) {
                report += '=== ALL GLOBAL OBSERVATIONS (' + appData.globalNotes.length + ' total) ===\n\n';
                appData.globalNotes.forEach((note, index) => {
                    const date = new Date(note.timestamp).toLocaleString();
                    report += (index + 1) + '. [' + date + ']\n';
                    report += '   ' + note.text + '\n\n';
                });
            }
            
            // Add complete list of all technique notes
            const allTechniqueNotes = [];
            Object.entries(appData.techniques).forEach(([id, data]) => {
                if (data.notes && data.notes.length > 0) {
                    const techName = Object.values(tlacData).flatMap(cat => cat).find(t => t.id == id)?.name || 'Unknown';
                    data.notes.forEach(note => {
                        allTechniqueNotes.push({
                            technique: techName,
                            techniqueId: id,
                            note: note.text,
                            timestamp: note.timestamp,
                            date: new Date(note.timestamp)
                        });
                    });
                }
            });
            
            if (allTechniqueNotes.length > 0) {
                report += '=== ALL TECHNIQUE NOTES (' + allTechniqueNotes.length + ' total) ===\n\n';
                allTechniqueNotes.sort((a, b) => b.date - a.date);
                allTechniqueNotes.forEach((item, index) => {
                    report += (index + 1) + '. ' + item.technique + ' [' + item.date.toLocaleString() + ']\n';
                    report += '   ' + item.note + '\n\n';
                });
            }
            
            // Add profile details
            report += '=== TEACHER PROFILE DETAILS ===\n\n';
            report += 'Name: ' + (appData.profile.name || 'Not specified') + '\n';
            report += 'Years Teaching: ' + (appData.profile.yearsTeaching || 'Not specified') + '\n';
            report += '\nCurrent Classes:\n';
            if (appData.profile.currentClasses && appData.profile.currentClasses.length > 0) {
                appData.profile.currentClasses.forEach(cls => {
                    report += '  • ' + cls + '\n';
                });
            } else {
                report += '  None specified\n';
            }
            report += '\nPrevious Classes:\n';
            if (appData.profile.previousClasses && appData.profile.previousClasses.length > 0) {
                appData.profile.previousClasses.forEach(cls => {
                    report += '  • ' + cls + '\n';
                });
            } else {
                report += '  None specified\n';
            }
            report += '\nAreas of Expertise:\n';
            if (appData.profile.expertiseAreas && appData.profile.expertiseAreas.length > 0) {
                appData.profile.expertiseAreas.forEach(area => {
                    report += '  • ' + area + '\n';
                });
            } else {
                report += '  None specified\n';
            }
            report += '\nProfessional Interests:\n';
            report += appData.profile.interests || '  Not specified';
            report += '\n\n';
            
            // Add metadata
            report += '=== AUDIT METADATA ===\n\n';
            report += 'Report Generated: ' + new Date().toLocaleString() + '\n';
            report += 'Last Backup: ' + (appData.lastBackup ? new Date(appData.lastBackup).toLocaleString() : 'Never') + '\n';
            const totalNotes = appData.globalNotes.length + allTechniqueNotes.length;
            report += 'Total Notes: ' + totalNotes + ' (' + appData.globalNotes.length + ' global, ' + allTechniqueNotes.length + ' technique-specific)\n';
            
            // Add summary statistics
            const techniqueCount = Object.keys(appData.techniques).length;
            const usageStats = {};
            Object.values(appData.techniques).forEach(tech => {
                usageStats[tech.status] = (usageStats[tech.status] || 0) + 1;
            });
            report += 'Techniques Tracked: ' + techniqueCount + '/52\n';
            report += 'Overall Implementation Rate: ' + (((usageStats.often || 0) + (usageStats.occasionally || 0)) / 52 * 100).toFixed(1) + '%\n';
            
            return report;
        }

        // Generate readable summary
        function generateReadableSummary() {
            const usageStats = {};
            Object.values(appData.techniques).forEach(tech => {
                usageStats[tech.status] = (usageStats[tech.status] || 0) + 1;
            });
            
            const currentClasses = appData.profile.currentClasses || [];
            
            const summary = 'Ongoing TLAC Audit Report\n' +
                'Generated: ' + new Date().toLocaleString() + '\n\n' +
                'Teacher: ' + (appData.profile.name || 'Not specified') + '\n' +
                'Years Teaching: ' + (appData.profile.yearsTeaching || 'Not specified') + '\n' +
                'Current Classes: ' + (currentClasses.length > 0 ? currentClasses.join(', ') : 'Not specified') + '\n\n' +
                'Technique Usage Summary:\n' +
                '- Used Often: ' + (usageStats.often || 0) + '\n' +
                '- Used Occasionally: ' + (usageStats.occasionally || 0) + '\n' +
                '- Not Used: ' + (usageStats['dont-use'] || 0) + '\n' +
                '- Not Yet Tried: ' + (usageStats['not-yet'] || 0) + '\n' +
                '- Not Suitable: ' + (usageStats['not-suitable'] || 0) + '\n\n' +
                'Total Notes: ' + appData.globalNotes.length + ' global notes\n' +
                'Implementation Rate: ' + (((usageStats.often || 0) + (usageStats.occasionally || 0)) / 52 * 100).toFixed(1) + '%';
            
            return summary;
        }

        // Save to local
        function saveToLocal() {
            exportData();
            alert('Backup saved successfully');
            updateUtilities();
        }

        // Check backup reminder
        function checkBackupReminder() {
            if (appData.lastBackup) {
                const lastBackup = new Date(appData.lastBackup);
                const now = new Date();
                const daysSince = (now - lastBackup) / (1000 * 60 * 60 * 24);
                
                if (daysSince >= 7) {
                    setTimeout(() => {
                        document.getElementById('backup-reminder').classList.add('show');
                    }, 3000);
                }
            }
        }

        // Hide reminder
        function hideReminder() {
            document.getElementById('backup-reminder').classList.remove('show');
        }

        // Populate sample data for debugging
        function populateSampleData() {
            console.log('Populating sample data...');
            
            // Random name generator
            const firstNames = ['Sarah', 'Michael', 'Emma', 'David', 'Lisa', 'James', 'Jennifer', 'Robert', 'Maria', 'John', 'Patricia', 'Daniel'];
            const lastNames = ['Johnson', 'Smith', 'Williams', 'Brown', 'Jones', 'Garcia', 'Miller', 'Davis', 'Rodriguez', 'Martinez', 'Wilson'];
            const randomName = firstNames[Math.floor(Math.random() * firstNames.length)] + ' ' + 
                              lastNames[Math.floor(Math.random() * lastNames.length)];
            
            // Random classes
            const grades = ['Kindergarten', 'Grade 1', 'Grade 2', 'Grade 3', 'Grade 4', 'Grade 5', 'Grade 6', 'Grade 7', 'Grade 8', 'Grade 9', 'Grade 10', 'Grade 11', 'Grade 12'];
            const subjects = ['Mathematics', 'English Language Arts', 'Science', 'Social Studies', 'History', 'Geography', 'Physics', 'Chemistry', 'Biology', 'Algebra', 'Geometry', 'Literature', 'Writing', 'Spanish', 'French', 'Art', 'Music', 'Physical Education'];
            const levels = ['', 'Advanced', 'Honors', 'AP', 'Remedial', 'Support', 'Enrichment'];
            
            const generateClasses = (count) => {
                const classes = [];
                for (let i = 0; i < count; i++) {
                    const grade = grades[Math.floor(Math.random() * grades.length)];
                    const subject = subjects[Math.floor(Math.random() * subjects.length)];
                    const level = levels[Math.floor(Math.random() * levels.length)];
                    classes.push((level ? level + ' ' : '') + grade + ' ' + subject);
                }
                return classes;
            };
            
            // Random expertise areas
            const expertiseOptions = [
                'Mathematics Education', 'STEM Integration', 'Differentiated Instruction', 'Technology Integration',
                'Project-Based Learning', 'Inquiry-Based Learning', 'Classroom Management', 'Special Education',
                'English as a Second Language', 'Assessment and Evaluation', 'Curriculum Development',
                'Educational Technology', 'Collaborative Learning', 'Critical Thinking', 'Creative Problem Solving',
                'Social-Emotional Learning', 'Culturally Responsive Teaching', 'Literacy Development',
                'Reading Comprehension', 'Writing Instruction', 'Science Education', 'Arts Integration'
            ];
            
            const randomExpertise = [];
            const expertiseCount = 3 + Math.floor(Math.random() * 4); // 3-6 areas
            for (let i = 0; i < expertiseCount; i++) {
                const expertise = expertiseOptions[Math.floor(Math.random() * expertiseOptions.length)];
                if (!randomExpertise.includes(expertise)) {
                    randomExpertise.push(expertise);
                }
            }
            
            // Random interests
            const interestTemplates = [
                'Exploring innovative teaching methods for diverse learners',
                'Building student confidence through collaborative learning',
                'Incorporating real-world applications in curriculum design',
                'Developing critical thinking skills through inquiry-based learning',
                'Creating inclusive classroom environments for all students',
                'Integrating technology to enhance student engagement',
                'Fostering creativity and innovation in the classroom',
                'Building strong relationships with students and families',
                'Implementing research-based instructional strategies',
                'Promoting student agency and self-directed learning'
            ];
            
            // Sample profile data with randomization
            appData.profile = {
                name: randomName,
                yearsTeaching: Math.floor(Math.random() * 25) + 1, // 1-25 years
                currentClasses: generateClasses(2 + Math.floor(Math.random() * 4)), // 2-5 classes
                previousClasses: generateClasses(3 + Math.floor(Math.random() * 5)), // 3-7 classes
                expertiseAreas: randomExpertise,
                interests: interestTemplates[Math.floor(Math.random() * interestTemplates.length)] + 
                          '. Also interested in ' + interestTemplates[Math.floor(Math.random() * interestTemplates.length)].toLowerCase()
            };
            
            // Sample technique data with varied statuses
            const sampleStatuses = ['often', 'occasionally', 'dont-use', 'not-yet', 'not-suitable', 'other'];
            const statusWeights = [25, 30, 10, 25, 5, 5]; // Percentage weights for more realistic distribution
            
            const getWeightedRandomStatus = () => {
                const totalWeight = statusWeights.reduce((a, b) => a + b, 0);
                let random = Math.random() * totalWeight;
                for (let i = 0; i < statusWeights.length; i++) {
                    random -= statusWeights[i];
                    if (random <= 0) {
                        return sampleStatuses[i];
                    }
                }
                return sampleStatuses[0];
            };
            
            const sampleNotes = [
                'Students responded exceptionally well to this technique during group work sessions',
                'Need more practice implementing this consistently across all class periods',
                'Great for maintaining engagement during longer instructional blocks',
                'Works especially well with advanced learners who need additional challenges',
                'Challenging to implement with larger class sizes but worth the effort',
                'Modified this technique to better suit virtual and hybrid learning environments',
                'Combines effectively with other ratio techniques for deeper student engagement',
                'Students initially showed resistance but now actively embrace this approach',
                'Noticed significant improvement in student participation after implementing this',
                'Planning to share this technique with department colleagues at next meeting',
                'Requires careful planning but yields excellent results for comprehension',
                'Students have started using this technique independently in group work',
                'Adapted this technique based on feedback from student surveys',
                'This technique has become a cornerstone of my classroom management approach',
                'Seeing measurable improvements in assessment scores since implementation',
                'Parents have commented positively about this technique during conferences',
                'Integrated this with technology tools for enhanced effectiveness',
                'This technique works particularly well for ELL students in my classroom',
                'Created a visual reminder system to help students internalize this technique',
                'Collaborating with grade-level team to implement this school-wide'
            ];
            
            const otherReasons = [
                'Adapting for hybrid learning environment with online students',
                'Modified for students with special learning needs',
                'Using a variation learned at professional development workshop',
                'Customized for block scheduling format',
                'Adjusted for co-teaching classroom model',
                'Implementing gradually to build student comfort',
                'Testing effectiveness before full implementation',
                'Combining with school-wide initiative requirements'
            ];
            
            Object.entries(tlacData).forEach(([category, techniques]) => {
                techniques.forEach((tech, index) => {
                    const randomStatus = getWeightedRandomStatus();
                    appData.techniques[tech.id] = {
                        status: randomStatus,
                        otherText: randomStatus === 'other' ? otherReasons[Math.floor(Math.random() * otherReasons.length)] : '',
                        notes: []
                    };
                    
                    // Add 0-5 notes for techniques with more realistic distribution
                    let noteCount = 0;
                    if (randomStatus === 'often') {
                        noteCount = Math.floor(Math.random() * 4) + 1; // 1-4 notes
                    } else if (randomStatus === 'occasionally') {
                        noteCount = Math.floor(Math.random() * 3); // 0-2 notes
                    } else if (randomStatus === 'not-yet' || randomStatus === 'dont-use') {
                        noteCount = Math.random() < 0.3 ? 1 : 0; // 30% chance of 1 note
                    }
                    
                    for (let i = 0; i < noteCount; i++) {
                        const randomNote = sampleNotes[Math.floor(Math.random() * sampleNotes.length)];
                        const randomDays = Math.floor(Math.random() * 60); // 0-60 days ago
                        const noteDate = new Date();
                        noteDate.setDate(noteDate.getDate() - randomDays);
                        noteDate.setHours(Math.floor(Math.random() * 24));
                        noteDate.setMinutes(Math.floor(Math.random() * 60));
                        
                        appData.techniques[tech.id].notes.push({
                            text: randomNote,
                            timestamp: noteDate.toISOString()
                        });
                    }
                });
            });
            
            // Sample global notes with varied content
            const globalNoteTemplates = [
                'Overall improvement in classroom management this week. The consistent use of specific TLAC techniques is showing measurable results in student engagement and behavior.',
                'Reflection: Need to focus more on Ratio techniques. Realized through observation that I am still doing too much of the cognitive heavy lifting during class discussions.',
                'Exit tickets are providing invaluable insights into student understanding. Planning to expand their use across all classes and share results with PLC.',
                'Professional development session on Cold Call techniques was transformative. Practiced with colleagues and gained confidence in implementation strategies.',
                'Students have explicitly mentioned they appreciate the predictable routines we have established. The Threshold greeting is making a noticeable difference in classroom climate.',
                'Parent feedback from conferences has been overwhelmingly positive about the structured learning environment created through TLAC implementation.',
                'Collaboration with grade-level team on implementing common TLAC strategies is yielding consistent results across all classrooms.',
                'Data from formative assessments shows significant improvement since implementing regular retrieval practice and exit tickets.',
                'Observing increased student participation and engagement since implementing Wait Time more consistently. The silence is powerful.',
                'Challenge: Balancing the implementation of multiple new techniques while maintaining existing classroom routines. Need to prioritize and phase implementation.',
                'Success story: Previously reluctant student is now actively participating thanks to consistent use of No Opt Out and positive framing.',
                'Department meeting discussion about TLAC techniques led to agreement on school-wide implementation of key strategies.',
                'Video recording of my lessons has helped identify areas where I can better implement Strong Voice and Radar techniques.',
                'Student survey results indicate high satisfaction with classroom structure and clarity of expectations since TLAC implementation.',
                'Planning summer professional development focused on deepening understanding of academic ethos techniques.'
            ];
            
            appData.globalNotes = [];
            const globalNoteCount = 5 + Math.floor(Math.random() * 6); // 5-10 notes
            for (let i = 0; i < globalNoteCount; i++) {
                const randomDays = Math.floor(Math.random() * 90); // 0-90 days ago
                const noteDate = new Date();
                noteDate.setDate(noteDate.getDate() - randomDays);
                noteDate.setHours(Math.floor(Math.random() * 24));
                noteDate.setMinutes(Math.floor(Math.random() * 60));
                
                appData.globalNotes.push({
                    text: globalNoteTemplates[Math.floor(Math.random() * globalNoteTemplates.length)],
                    timestamp: noteDate.toISOString()
                });
            }
            
            // Sort global notes by date (newest first)
            appData.globalNotes.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
            
            // Set random last backup (1-10 days ago)
            const backupDays = Math.floor(Math.random() * 10) + 1;
            const backupDate = new Date();
            backupDate.setDate(backupDate.getDate() - backupDays);
            appData.lastBackup = backupDate.toISOString();
            
            // Save and reload
            saveData();
            loadProfile();
            renderTechniques();
            loadGlobalNotes();
            updateDashboard();
            updateUtilities();
            
            alert('Sample data populated successfully!\n\nAll fields have been filled with randomized test data.');
        }

        // Factory reset - clear all data
        function factoryReset() {
            console.log('Performing factory reset...');
            
            // Clear all data
            appData = {
                profile: {
                    name: '',
                    yearsTeaching: 0,
                    currentClasses: [],
                    previousClasses: [],
                    expertiseAreas: [],
                    interests: ''
                },
                techniques: {},
                globalNotes: [],
                lastBackup: null
            };
            
            // Reinitialize techniques with default values
            initializeTechniques();
            
            // Clear localStorage
            localStorage.removeItem('tlacAuditData');
            
            // Save clean state
            saveData();
            
            // Reload everything
            loadProfile();
            renderTechniques();
            loadGlobalNotes();
            updateDashboard();
            updateUtilities();
            
            alert('Factory reset complete!\n\nAll data has been cleared and the application has been reset to its initial state.');
        }

        // Initialize on load
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            
            // Add tab click listeners
            document.getElementById('techniques-tab-btn').addEventListener('click', () => switchTab('techniques'));
            document.getElementById('dashboard-tab-btn').addEventListener('click', () => switchTab('dashboard'));
            document.getElementById('profile-tab-btn').addEventListener('click', () => switchTab('profile'));
            document.getElementById('utilities-tab-btn').addEventListener('click', () => switchTab('utilities'));
            
            // Debug key tracking
            const keysPressed = {};
            
            document.addEventListener('keydown', function(e) {
                keysPressed[e.key.toLowerCase()] = true;
                
                // Check for QWE combination (populate sample data)
                if (keysPressed['q'] && keysPressed['w'] && keysPressed['e']) {
                    const activeTab = document.querySelector('.tab-content.active');
                    if (activeTab && activeTab.id === 'utilities-tab') {
                        populateSampleData();
                        keysPressed['q'] = false;
                        keysPressed['w'] = false;
                        keysPressed['e'] = false;
                    }
                }
                
                // Check for ASD combination (factory reset)
                if (keysPressed['a'] && keysPressed['s'] && keysPressed['d']) {
                    const activeTab = document.querySelector('.tab-content.active');
                    if (activeTab && activeTab.id === 'utilities-tab') {
                        if (confirm('Factory Reset: This will clear ALL data. Are you sure?')) {
                            factoryReset();
                        }
                        keysPressed['a'] = false;
                        keysPressed['s'] = false;
                        keysPressed['d'] = false;
                    }
                }
            });
            
            document.addEventListener('keyup', function(e) {
                keysPressed[e.key.toLowerCase()] = false;
            });
        });

        // Make functions globally available for onclick handlers
        window.toggleCategory = toggleCategory;
        window.toggleDetails = toggleDetails;
        window.updateStatus = updateStatus;
        window.updateOtherText = updateOtherText;
        window.saveTechniqueNote = saveTechniqueNote;
        window.saveGlobalNote = saveGlobalNote;
        window.saveProfile = saveProfile;
        window.exportData = exportData;
        window.importData = importData;
        window.emailData = emailData;
        window.saveToLocal = saveToLocal;
        window.hideReminder = hideReminder;
        window.populateSampleData = populateSampleData;
        window.factoryReset = factoryReset;

        // Auto-save on changes
        setInterval(saveData, 30000); // Auto-save every 30 seconds
    </script>
</body>
</html>