<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Victorian Household Energy Audit Tool</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            line-height: 1.5;
            color: #333;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 15px;
        }

        .page {
            display: none;
            animation: fadeIn 0.3s ease-in;
            background: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h1 {
            color: #2E7D32;
            margin-bottom: 8px;
            font-size: 1.8em;
        }

        h2 {
            color: #1976D2;
            margin-bottom: 15px;
            font-size: 1.4em;
        }

        h3 {
            color: #2E7D32;
            margin: 15px 0 8px 0;
            font-size: 1.1em;
        }

        .intro-text {
            color: #666;
            margin-bottom: 15px;
            font-size: 0.95em;
            line-height: 1.6;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 4px;
            color: #555;
            font-weight: 500;
            font-size: 0.95em;
        }

        input[type="text"],
        input[type="number"],
        select {
            width: 100%;
            padding: 8px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 15px;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        select:focus {
            border-color: #1976D2;
            outline: none;
        }

        .radio-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 8px;
            margin-top: 8px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            background: #f8f9fa;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.3s;
            font-size: 0.9em;
        }

        .radio-option:hover {
            background: #e3f2fd;
        }

        input[type="radio"] {
            margin-right: 6px;
        }

        .checkbox-group {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
            gap: 8px;
            margin-top: 8px;
        }

        .checkbox-option {
            display: flex;
            align-items: center;
            background: #f8f9fa;
            padding: 8px 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: background 0.3s;
            font-size: 0.9em;
        }

        .checkbox-option:hover {
            background: #e3f2fd;
        }

        input[type="checkbox"] {
            margin-right: 6px;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid #e0e0e0;
        }

        button {
            background: #1976D2;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            font-size: 15px;
            cursor: pointer;
            transition: background 0.3s;
        }

        button:hover {
            background: #1565C0;
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        button.secondary {
            background: #757575;
        }

        button.secondary:hover {
            background: #616161;
        }

        .progress-bar {
            height: 3px;
            background: #e0e0e0;
            border-radius: 2px;
            margin-bottom: 15px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #2E7D32;
            border-radius: 2px;
            transition: width 0.3s;
        }

        .page-indicator {
            text-align: center;
            color: #666;
            margin-top: 8px;
            font-size: 13px;
        }

        .slider-container {
            margin: 15px 0;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
            font-size: 0.9em;
        }

        input[type="range"] {
            width: 100%;
            -webkit-appearance: none;
            height: 6px;
            border-radius: 3px;
            background: #ddd;
            outline: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #1976D2;
            cursor: pointer;
        }

        input[type="range"]::-moz-range-thumb {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            background: #1976D2;
            cursor: pointer;
        }

        .vehicle-entry {
            background: #f5f5f5;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 12px;
        }

        .vehicle-entry h3 {
            margin-top: 0;
        }

        .vehicle-entry .form-group {
            margin-bottom: 10px;
        }

        .remove-vehicle {
            background: #f44336;
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 13px;
            margin-top: 8px;
        }

        .remove-vehicle:hover {
            background: #d32f2f;
        }

        .results-card {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            margin: 15px 0;
        }

        .metric {
            display: flex;
            justify-content: space-between;
            margin: 8px 0;
            padding: 8px;
            background: white;
            border-radius: 5px;
            font-size: 0.95em;
        }

        .metric-label {
            font-weight: 500;
            color: #555;
        }

        .metric-value {
            font-weight: bold;
            color: #1976D2;
        }

        .chart-container {
            margin: 20px 0;
            padding: 15px;
            background: white;
            border-radius: 6px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .expandable {
            margin: 15px 0;
        }

        .expandable-header {
            background: #f5f5f5;
            padding: 12px;
            border-radius: 6px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.95em;
        }

        .expandable-header:hover {
            background: #eeeeee;
        }

        .expandable-content {
            display: none;
            padding: 12px;
            background: #fafafa;
            border-radius: 0 0 6px 6px;
            margin-top: -6px;
            font-size: 0.9em;
        }

        .expandable.expanded .expandable-content {
            display: block;
        }

        .expandable-arrow {
            transition: transform 0.3s;
        }

        .expandable.expanded .expandable-arrow {
            transform: rotate(90deg);
        }

        .save-indicator {
            position: fixed;
            top: 15px;
            right: 15px;
            background: #4CAF50;
            color: white;
            padding: 8px 16px;
            border-radius: 5px;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1000;
            font-size: 14px;
        }

        .save-indicator.show {
            opacity: 1;
        }

        .comparison-bar {
            position: relative;
            height: 35px;
            background: #e0e0e0;
            border-radius: 18px;
            margin: 15px 0;
        }

        .comparison-fill {
            position: absolute;
            height: 100%;
            background: linear-gradient(to right, #4CAF50, #FF6B35);
            border-radius: 18px;
            display: flex;
            align-items: center;
            padding: 0 12px;
            color: white;
            font-weight: bold;
            font-size: 0.9em;
        }

        .comparison-markers {
            position: relative;
            height: 20px;
            margin-top: 5px;
        }

        .comparison-marker {
            position: absolute;
            width: 2px;
            height: 20px;
            background: #666;
        }

        .comparison-label {
            position: absolute;
            top: 22px;
            transform: translateX(-50%);
            font-size: 11px;
            color: #666;
            text-align: center;
        }

        .info-box {
            background: #E3F2FD;
            border-left: 3px solid #1976D2;
            padding: 12px;
            margin: 15px 0;
            border-radius: 3px;
            font-size: 0.9em;
        }

        .warning-box {
            background: #FFF3E0;
            border-left: 3px solid #FF6B35;
            padding: 12px;
            margin: 15px 0;
            border-radius: 3px;
            font-size: 0.9em;
        }

        .quick-nav {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 15px 0;
        }

        .quick-nav button {
            padding: 6px 12px;
            font-size: 13px;
        }

        @media print {
            body {
                background: white;
            }
            .page {
                box-shadow: none;
                padding: 15px;
            }
            .navigation,
            .save-indicator {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            .page {
                padding: 15px;
            }
            h1 {
                font-size: 1.4em;
            }
            h2 {
                font-size: 1.2em;
            }
            .radio-group,
            .checkbox-group {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="save-indicator" id="saveIndicator">Progress Saved</div>

        <!-- Page 1: Welcome -->
        <div class="page active" id="page1">
            <h1>Victorian Household Energy Audit Tool</h1>
            <p class="intro-text">
                This tool helps Year 8 students understand household energy consumption. 
                Most energy comes from heating/cooling (40-60%), transport (30-40%), and hot water (15-20%). 
                Lights and standby power typically use only 3-5%.
            </p>
            
            <div class="info-box">
                <strong>Key fact:</strong> Reducing heating by 2°C saves more energy than turning off all lights permanently. 
                One less weekly car trip saves more than eliminating all standby power.
            </div>

            <div class="form-group">
                <label for="studentName">Your Name:</label>
                <input type="text" id="studentName" placeholder="Enter your name">
            </div>

            <div class="form-group">
                <label for="postcode">Postcode:</label>
                <input type="text" id="postcode" placeholder="e.g., 3000" maxlength="4">
            </div>

            <div class="navigation">
                <span></span>
                <button onclick="nextPage()">Next</button>
            </div>
            <div class="page-indicator">Page 1 of 14</div>
        </div>

        <!-- Page 2: Home Details -->
        <div class="page" id="page2">
            <h2>Home Details</h2>
            <p class="intro-text">
                Basic home details affect energy patterns. Larger, older homes typically use more energy.
            </p>

            <div class="form-group">
                <label for="dwellingType">Type of Home:</label>
                <select id="dwellingType">
                    <option value="">Select...</option>
                    <option value="house">House</option>
                    <option value="townhouse">Townhouse</option>
                    <option value="apartment">Apartment/Unit</option>
                </select>
            </div>

            <div class="form-group">
                <label for="occupants">Number of People:</label>
                <input type="number" id="occupants" min="1" max="10" value="3">
            </div>

            <div class="form-group">
                <label for="floorArea">Floor Area:</label>
                <select id="floorArea">
                    <option value="">Select...</option>
                    <option value="small">Small (&lt;100m²)</option>
                    <option value="medium">Medium (100-200m²)</option>
                    <option value="large">Large (200-300m²)</option>
                    <option value="very-large">Very Large (&gt;300m²)</option>
                </select>
            </div>

            <div class="form-group">
                <label for="buildingAge">Building Age:</label>
                <select id="buildingAge">
                    <option value="">Select...</option>
                    <option value="pre-1990">Before 1990</option>
                    <option value="1990-2005">1990-2005</option>
                    <option value="2005-2015">2005-2015</option>
                    <option value="post-2015">After 2015</option>
                </select>
            </div>

            <div class="navigation">
                <button onclick="previousPage()" class="secondary">Back</button>
                <button onclick="nextPage()">Next</button>
            </div>
            <div class="page-indicator">Page 2 of 14</div>
        </div>

        <!-- Page 3: Heating & Cooling -->
        <div class="page" id="page3">
            <h2>Heating & Cooling</h2>
            <p class="intro-text">
                Heating and cooling: 40-60% of household energy. System type and usage matter most.
            </p>

            <div class="form-group">
                <label>Main Heating:</label>
                <div class="radio-group">
                    <label class="radio-option">
                        <input type="radio" name="heatingType" value="gas-ducted">
                        Gas Ducted
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="heatingType" value="reverse-cycle">
                        Reverse Cycle
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="heatingType" value="gas-wall">
                        Gas Wall
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="heatingType" value="electric">
                        Electric
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="heatingType" value="wood">
                        Wood
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="heatingType" value="none">
                        None
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label>Winter Usage:</label>
                <div class="radio-group">
                    <label class="radio-option">
                        <input type="radio" name="heatingUsage" value="daily">
                        Daily
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="heatingUsage" value="most-days">
                        Most Days
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="heatingUsage" value="sometimes">
                        Sometimes
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="heatingUsage" value="rarely">
                        Rarely
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label>Main Cooling:</label>
                <div class="radio-group">
                    <label class="radio-option">
                        <input type="radio" name="coolingType" value="ducted-ac">
                        Ducted AC
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="coolingType" value="split-system">
                        Split System
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="coolingType" value="evaporative">
                        Evaporative
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="coolingType" value="fans">
                        Fans Only
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="coolingType" value="none">
                        None
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label>Summer Usage:</label>
                <div class="radio-group">
                    <label class="radio-option">
                        <input type="radio" name="coolingUsage" value="daily">
                        Daily
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="coolingUsage" value="hot-days">
                        Hot Days
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="coolingUsage" value="sometimes">
                        Sometimes
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="coolingUsage" value="rarely">
                        Rarely
                    </label>
                </div>
            </div>

            <div class="navigation">
                <button onclick="previousPage()" class="secondary">Back</button>
                <button onclick="nextPage()">Next</button>
            </div>
            <div class="page-indicator">Page 3 of 14</div>
        </div>

        <!-- Page 4: Hot Water & Cooking -->
        <div class="page" id="page4">
            <h2>Hot Water & Cooking</h2>
            <p class="intro-text">
                Hot water: 15-20% of energy. System type and shower length affect consumption.
            </p>

            <div class="form-group">
                <label>Hot Water:</label>
                <div class="radio-group">
                    <label class="radio-option">
                        <input type="radio" name="hotWaterType" value="gas-storage">
                        Gas Storage
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="hotWaterType" value="gas-instant">
                        Gas Instant
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="hotWaterType" value="electric-storage">
                        Electric Storage
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="hotWaterType" value="heat-pump">
                        Heat Pump
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="hotWaterType" value="solar">
                        Solar
                    </label>
                </div>
            </div>

            <div class="form-group" id="boostTypeGroup" style="display: none;">
                <label>Solar Boost:</label>
                <div class="radio-group">
                    <label class="radio-option">
                        <input type="radio" name="boostType" value="electric">
                        Electric Boost
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="boostType" value="gas">
                        Gas Boost
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label>Shower Length:</label>
                <div class="radio-group">
                    <label class="radio-option">
                        <input type="radio" name="showerLength" value="short">
                        &lt;4 min
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="showerLength" value="medium">
                        4-7 min
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="showerLength" value="long">
                        7-10 min
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="showerLength" value="very-long">
                        &gt;10 min
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label>Cooktop:</label>
                <div class="radio-group">
                    <label class="radio-option">
                        <input type="radio" name="cooktopType" value="gas">
                        Gas
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="cooktopType" value="electric">
                        Electric
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="cooktopType" value="induction">
                        Induction
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label>Oven:</label>
                <div class="radio-group">
                    <label class="radio-option">
                        <input type="radio" name="ovenType" value="gas">
                        Gas
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="ovenType" value="electric">
                        Electric
                    </label>
                </div>
            </div>

            <div class="navigation">
                <button onclick="previousPage()" class="secondary">Back</button>
                <button onclick="nextPage()">Next</button>
            </div>
            <div class="page-indicator">Page 4 of 14</div>
        </div>

        <!-- Page 5: Transport -->
        <div class="page" id="page5">
            <h2>Transport</h2>
            <p class="intro-text">
                Transport: 30-40% of energy. One tank of petrol = TV for 6 months.
            </p>

            <div id="vehiclesList"></div>
            
            <button onclick="addVehicle()" style="margin-bottom: 15px;">Add Vehicle</button>

            <div class="form-group">
                <label>Alternative Transport:</label>
                <div class="checkbox-group">
                    <label class="checkbox-option">
                        <input type="checkbox" id="ebike" value="ebike">
                        E-bike/E-scooter
                    </label>
                    <label class="checkbox-option">
                        <input type="checkbox" id="publicTransport" value="public">
                        Public Transport
                    </label>
                    <label class="checkbox-option">
                        <input type="checkbox" id="bicycle" value="bicycle">
                        Bicycle
                    </label>
                    <label class="checkbox-option">
                        <input type="checkbox" id="walking" value="walking">
                        Walking
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label for="wfhDays">Work From Home Days/Week:</label>
                <input type="number" id="wfhDays" min="0" max="7" value="0">
            </div>

            <div class="navigation">
                <button onclick="previousPage()" class="secondary">Back</button>
                <button onclick="nextPage()">Next</button>
            </div>
            <div class="page-indicator">Page 5 of 14</div>
        </div>

        <!-- Page 6: Building Efficiency -->
        <div class="page" id="page6">
            <h2>Building Efficiency</h2>
            <p class="intro-text">
                Insulation and features can reduce heating/cooling by 15-30%.
            </p>

            <div class="form-group">
                <label>Ceiling Insulation:</label>
                <div class="radio-group">
                    <label class="radio-option">
                        <input type="radio" name="ceilingInsulation" value="full">
                        Full
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="ceilingInsulation" value="partial">
                        Partial
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="ceilingInsulation" value="none">
                        None
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label>Wall Insulation:</label>
                <div class="radio-group">
                    <label class="radio-option">
                        <input type="radio" name="wallInsulation" value="full">
                        Full
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="wallInsulation" value="partial">
                        Partial
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="wallInsulation" value="none">
                        None
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label>Double Glazing:</label>
                <div class="radio-group">
                    <label class="radio-option">
                        <input type="radio" name="doubleGlazing" value="most">
                        Most Windows
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="doubleGlazing" value="some">
                        Some Windows
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="doubleGlazing" value="none">
                        None
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label>Draft Sealing:</label>
                <div class="radio-group">
                    <label class="radio-option">
                        <input type="radio" name="draftSealing" value="good">
                        Good (seals fitted)
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="draftSealing" value="poor">
                        Poor (gaps present)
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label>Features:</label>
                <div class="checkbox-group">
                    <label class="checkbox-option">
                        <input type="checkbox" id="externalShading">
                        External Shading
                    </label>
                    <label class="checkbox-option">
                        <input type="checkbox" id="windowCoverings">
                        Heavy Curtains
                    </label>
                    <label class="checkbox-option">
                        <input type="checkbox" id="northFacing">
                        North Windows
                    </label>
                    <label class="checkbox-option">
                        <input type="checkbox" id="swimmingPool">
                        Pool
                    </label>
                    <label class="checkbox-option">
                        <input type="checkbox" id="spa">
                        Spa
                    </label>
                    <label class="checkbox-option">
                        <input type="checkbox" id="workshop">
                        Workshop
                    </label>
                </div>
            </div>

            <div class="form-group" id="poolHeatingGroup" style="display: none;">
                <label>Pool Heating:</label>
                <div class="radio-group">
                    <label class="radio-option">
                        <input type="radio" name="poolHeating" value="gas">
                        Gas
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="poolHeating" value="solar">
                        Solar
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="poolHeating" value="none">
                        None
                    </label>
                </div>
            </div>

            <div class="navigation">
                <button onclick="previousPage()" class="secondary">Back</button>
                <button onclick="nextPage()">Next</button>
            </div>
            <div class="page-indicator">Page 6 of 14</div>
        </div>

        <!-- Page 7: Renewable Energy -->
        <div class="page" id="page7">
            <h2>Renewable Energy</h2>
            <p class="intro-text">
                Solar reduces grid electricity. GreenPower only affects grid electricity emissions, not gas or petrol.
            </p>

            <div class="form-group">
                <label>Solar PV:</label>
                <div class="radio-group">
                    <label class="radio-option">
                        <input type="radio" name="solarPV" value="large">
                        Large (&gt;10kW)
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="solarPV" value="medium">
                        Medium (5-10kW)
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="solarPV" value="small">
                        Small (&lt;5kW)
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="solarPV" value="none">
                        None
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label>Battery:</label>
                <div class="radio-group">
                    <label class="radio-option">
                        <input type="radio" name="battery" value="large">
                        Large (&gt;10kWh)
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="battery" value="small">
                        Small (&lt;10kWh)
                    </label>
                    <label class="radio-option">
                        <input type="radio" name="battery" value="none">
                        None
                    </label>
                </div>
            </div>

            <div class="form-group">
                <label for="greenPower">GreenPower:</label>
                <select id="greenPower">
                    <option value="0">0% (Standard)</option>
                    <option value="25">25%</option>
                    <option value="50">50%</option>
                    <option value="100">100%</option>
                </select>
            </div>

            <div class="info-box">
                GreenPower only reduces grid electricity emissions, not gas or transport.
            </div>

            <div class="navigation">
                <button onclick="previousPage()" class="secondary">Back</button>
                <button onclick="nextPage()">Next</button>
            </div>
            <div class="page-indicator">Page 7 of 14</div>
        </div>

        <!-- Page 8: Energy Behaviors -->
        <div class="page" id="page8">
            <h2>Energy Behaviors</h2>
            <p class="intro-text">
                Daily habits help but have less impact than major systems.
            </p>

            <div class="slider-container">
                <div class="slider-label">
                    <span>Lights Off</span>
                    <span id="lightsOffValue">Sometimes</span>
                </div>
                <input type="range" id="lightsOff" min="0" max="3" value="2">
            </div>

            <div class="slider-container">
                <div class="slider-label">
                    <span>Standby Off</span>
                    <span id="standbyOffValue">Rarely</span>
                </div>
                <input type="range" id="standbyOff" min="0" max="3" value="1">
            </div>

            <div class="slider-container">
                <div class="slider-label">
                    <span>Cold Washing</span>
                    <span id="coldWashingValue">Sometimes</span>
                </div>
                <input type="range" id="coldWashing" min="0" max="3" value="2">
            </div>

            <div class="slider-container">
                <div class="slider-label">
                    <span>Air Dry Clothes</span>
                    <span id="airDryValue">Sometimes</span>
                </div>
                <input type="range" id="airDry" min="0" max="3" value="2">
            </div>

            <div class="slider-container">
                <div class="slider-label">
                    <span>Close Curtains</span>
                    <span id="closeCurtainsValue">Sometimes</span>
                </div>
                <input type="range" id="closeCurtains" min="0" max="3" value="2">
            </div>

            <div class="slider-container">
                <div class="slider-label">
                    <span>Thermostat (20°C/26°C)</span>
                    <span id="thermostatValue">Rarely</span>
                </div>
                <input type="range" id="thermostat" min="0" max="3" value="1">
            </div>

            <div class="form-group">
                <label for="energyEfforts">Other Efforts:</label>
                <textarea id="energyEfforts" rows="2" style="width: 100%; padding: 8px; border: 2px solid #ddd; border-radius: 5px;"></textarea>
            </div>

            <div class="navigation">
                <button onclick="previousPage()" class="secondary">Back</button>
                <button onclick="calculateResults()">Calculate Results</button>
            </div>
            <div class="page-indicator">Page 8 of 14</div>
        </div>

        <!-- Page 9: Summary Dashboard -->
        <div class="page" id="page9">
            <h2>Energy Audit Results</h2>
            
            <div class="results-card">
                <h3>Total Household Energy</h3>
                <div class="metric">
                    <span class="metric-label">Total Energy</span>
                    <span class="metric-value" id="totalEnergy">0 kWh/year</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Total CO₂</span>
                    <span class="metric-value" id="totalCO2">0 kg/year</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Per Person Energy</span>
                    <span class="metric-value" id="perCapitaEnergy">0 kWh/year</span>
                </div>
                <div class="metric">
                    <span class="metric-label">Per Person CO₂</span>
                    <span class="metric-value" id="perCapitaCO2">0 kg/year</span>
                </div>
            </div>

            <h3>Victorian Comparison</h3>
            <div class="comparison-bar">
                <div class="comparison-fill" id="comparisonFill" style="width: 50%;">
                    Your Household
                </div>
            </div>
            <div class="comparison-markers">
                <div class="comparison-marker" style="left: 25%;">
                    <div class="comparison-label">Efficient<br>15,000 kWh</div>
                </div>
                <div class="comparison-marker" style="left: 50%;">
                    <div class="comparison-label">Average<br>21,000 kWh<br>2,900 kg CO₂/person</div>
                </div>
                <div class="comparison-marker" style="left: 75%;">
                    <div class="comparison-label">High<br>28,000 kWh</div>
                </div>
            </div>

            <div class="chart-container">
                <h3>Energy Sources</h3>
                <canvas id="sourcesChart"></canvas>
            </div>

            <div class="chart-container">
                <h3>Energy Uses</h3>
                <canvas id="usesChart"></canvas>
            </div>

            <div class="quick-nav">
                <button onclick="goToPage(10)">View Improvements</button>
                <button onclick="goToPage(11)">Detailed Breakdown</button>
                <button onclick="goToPage(12)">Print Report</button>
            </div>

            <div class="navigation">
                <button onclick="previousPage()" class="secondary">Back</button>
                <button onclick="nextPage()">Continue</button>
            </div>
            <div class="page-indicator">Page 9 of 14</div>
        </div>

        <!-- Page 10: Potential Improvements -->
        <div class="page" id="page10">
            <h2>Potential Improvements</h2>
            <p class="intro-text">
                Options your household might consider. Savings are typical estimates.
            </p>

            <div id="improvementsList"></div>

            <div class="warning-box">
                Educational estimates only. Actual savings vary. Consult professionals for specific advice.
            </div>

            <div class="navigation">
                <button onclick="previousPage()" class="secondary">Back</button>
                <button onclick="nextPage()">Next</button>
            </div>
            <div class="page-indicator">Page 10 of 14</div>
        </div>

        <!-- Page 11: Detailed Results -->
        <div class="page" id="page11">
            <h2>Detailed Results</h2>
            
            <div class="expandable">
                <div class="expandable-header" onclick="toggleExpandable(this)">
                    <span>Heating & Cooling</span>
                    <span class="expandable-arrow">▶</span>
                </div>
                <div class="expandable-content" id="heatingCoolingDetails"></div>
            </div>

            <div class="expandable">
                <div class="expandable-header" onclick="toggleExpandable(this)">
                    <span>Hot Water</span>
                    <span class="expandable-arrow">▶</span>
                </div>
                <div class="expandable-content" id="hotWaterDetails"></div>
            </div>

            <div class="expandable">
                <div class="expandable-header" onclick="toggleExpandable(this)">
                    <span>Transport</span>
                    <span class="expandable-arrow">▶</span>
                </div>
                <div class="expandable-content" id="transportDetails"></div>
            </div>

            <div class="expandable">
                <div class="expandable-header" onclick="toggleExpandable(this)">
                    <span>Appliances</span>
                    <span class="expandable-arrow">▶</span>
                </div>
                <div class="expandable-content" id="appliancesDetails"></div>
            </div>

            <div class="expandable">
                <div class="expandable-header" onclick="toggleExpandable(this)">
                    <span>Renewable Energy</span>
                    <span class="expandable-arrow">▶</span>
                </div>
                <div class="expandable-content" id="renewableDetails"></div>
            </div>

            <div class="navigation">
                <button onclick="previousPage()" class="secondary">Back</button>
                <button onclick="nextPage()">Next</button>
            </div>
            <div class="page-indicator">Page 11 of 14</div>
        </div>

        <!-- Page 12: Print Report -->
        <div class="page" id="page12">
            <h2>Print Report</h2>
            <p class="intro-text">
                Formatted for printing. Use browser's print function.
            </p>

            <div id="printReport" style="background: white; padding: 15px; border: 1px solid #ddd;">
                <!-- Report content generated here -->
            </div>

            <button onclick="window.print()" style="margin-top: 15px;">Print This Report</button>

            <div class="navigation">
                <button onclick="previousPage()" class="secondary">Back</button>
                <button onclick="nextPage()">Next</button>
            </div>
            <div class="page-indicator">Page 12 of 14</div>
        </div>

        <!-- Page 13: Calculation Methods -->
        <div class="page" id="page13">
            <h2>Calculation Methods</h2>
            <p class="intro-text">
                Based on Victorian government data and industry standards.
            </p>

            <h3>Emissions Factors</h3>
            <ul style="margin-left: 20px; font-size: 0.9em; line-height: 1.6;">
                <li>Grid electricity: 0.86 kg CO₂/kWh</li>
                <li>Natural gas: 0.186 kg CO₂/kWh</li>
                <li>Petrol: 0.259 kg CO₂/L (8.9 kWh/L)</li>
                <li>Diesel: 0.252 kg CO₂/L (10.7 kWh/L)</li>
            </ul>

            <h3>Adjustments Applied</h3>
            <ul style="margin-left: 20px; font-size: 0.9em; line-height: 1.6;">
                <li>Home size: 0.6x (small) to 1.8x (very large)</li>
                <li>Building age: 0.8x (new) to 1.3x (pre-1990)</li>
                <li>Usage patterns: 0.1x (rarely) to 1.0x (daily)</li>
                <li>Insulation: 0.85x to 1.0x factors</li>
                <li>Work from home: -8% transport per day</li>
                <li>Public transport: -25% car energy</li>
            </ul>

            <h3>Solar Generation (Victoria)</h3>
            <ul style="margin-left: 20px; font-size: 0.9em; line-height: 1.6;">
                <li>Small (&lt;5kW): 5,500 kWh/year</li>
                <li>Medium (5-10kW): 9,000 kWh/year</li>
                <li>Large (&gt;10kW): 13,000 kWh/year</li>
                <li>Self-use: 30% (no battery), 60% (small), 80% (large)</li>
            </ul>

            <div class="navigation">
                <button onclick="previousPage()" class="secondary">Back</button>
                <button onclick="nextPage()">Next</button>
            </div>
            <div class="page-indicator">Page 13 of 14</div>
        </div>

        <!-- Page 14: Bibliography -->
        <div class="page" id="page14">
            <h2>Bibliography</h2>
            <p class="intro-text">
                Data sources and references.
            </p>

            <h3>Primary Sources</h3>
            <ul style="margin-left: 20px; font-size: 0.9em; line-height: 1.6;">
                <li>Sustainability Victoria (2024). <em>State of Sustainability Report 2024</em>.</li>
                <li>Essential Services Commission Victoria (2024). <em>Victorian Default Offer 2024-25</em>.</li>
                <li>Australian Energy Regulator (2024). <em>Residential Energy Benchmarks</em>.</li>
                <li>Department of Climate Change (2024). <em>National Greenhouse Accounts Factors</em>.</li>
            </ul>

            <h3>Secondary Sources</h3>
            <ul style="margin-left: 20px; font-size: 0.9em; line-height: 1.6;">
                <li>Australian Bureau of Statistics (2021). <em>Census: Transport to Work</em>.</li>
                <li>RACV (2024). <em>Real World Fuel Consumption Database</em>.</li>
                <li>Clean Energy Regulator (2024). <em>Small-scale Renewable Energy Data</em>.</li>
            </ul>

            <h3>Resources</h3>
            <ul style="margin-left: 20px; font-size: 0.9em; line-height: 1.6;">
                <li>Victorian Energy Saver: <a href="https://www.victorianenergysaver.vic.gov.au" target="_blank">www.victorianenergysaver.vic.gov.au</a></li>
                <li>Sustainability Victoria: <a href="https://www.sustainability.vic.gov.au" target="_blank">www.sustainability.vic.gov.au</a></li>
            </ul>

            <div class="info-box" style="margin-top: 20px;">
                Educational tool for Year 8 curriculum. Estimates only - not for commercial decisions.
            </div>

            <div class="navigation">
                <button onclick="previousPage()" class="secondary">Back</button>
                <button onclick="goToPage(1)">Start Over</button>
            </div>
            <div class="page-indicator">Page 14 of 14</div>
        </div>
    </div>

    <script>
        // Initialize data structure
        let auditData = {
            studentName: '',
            postcode: '',
            dwellingType: '',
            occupants: 3,
            floorArea: '',
            buildingAge: '',
            heatingType: '',
            heatingUsage: '',
            coolingType: '',
            coolingUsage: '',
            hotWaterType: '',
            boostType: '',
            showerLength: '',
            cooktopType: '',
            ovenType: '',
            vehicles: [],
            alternativeTransport: {
                ebike: false,
                publicTransport: false,
                bicycle: false,
                walking: false
            },
            wfhDays: 0,
            insulation: {
                ceilingInsulation: 'none',
                wallInsulation: 'none',
                doubleGlazing: 'none',
                draftSealing: 'poor'
            },
            features: {
                externalShading: false,
                windowCoverings: false,
                northFacing: false,
                swimmingPool: false,
                spa: false,
                workshop: false
            },
            poolHeating: 'none',
            solarPV: 'none',
            battery: 'none',
            greenPower: 0,
            behaviors: {
                lightsOff: 2,
                standbyOff: 1,
                coldWashing: 2,
                airDry: 2,
                closeCurtains: 2,
                thermostat: 1
            },
            energyEfforts: ''
        };

        // Load saved data on page load
        window.addEventListener('DOMContentLoaded', () => {
            loadSavedData();
            setupEventListeners();
            updateProgress();
        });

        // Current page tracking
        let currentPage = 1;
        const totalPages = 14;

        function nextPage() {
            saveData();
            if (currentPage < totalPages) {
                goToPage(currentPage + 1);
            }
        }

        function previousPage() {
            saveData();
            if (currentPage > 1) {
                goToPage(currentPage - 1);
            }
        }

        function goToPage(pageNum) {
            saveData();
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(`page${pageNum}`).classList.add('active');
            currentPage = pageNum;
            updateProgress();
            window.scrollTo(0, 0);
        }

        function updateProgress() {
            const progress = (currentPage / totalPages) * 100;
            const progressBar = document.createElement('div');
            progressBar.className = 'progress-bar';
            progressBar.innerHTML = `<div class="progress-fill" style="width: ${progress}%"></div>`;
            
            const activePage = document.querySelector('.page.active');
            if (activePage && !activePage.querySelector('.progress-bar')) {
                activePage.insertBefore(progressBar, activePage.firstChild);
            }
        }

        function saveData() {
            // Collect all form data
            auditData.studentName = document.getElementById('studentName')?.value || '';
            auditData.postcode = document.getElementById('postcode')?.value || '';
            auditData.dwellingType = document.getElementById('dwellingType')?.value || '';
            auditData.occupants = parseInt(document.getElementById('occupants')?.value) || 3;
            auditData.floorArea = document.getElementById('floorArea')?.value || '';
            auditData.buildingAge = document.getElementById('buildingAge')?.value || '';
            
            // Radio buttons
            const radioGroups = ['heatingType', 'heatingUsage', 'coolingType', 'coolingUsage', 
                                'hotWaterType', 'boostType', 'showerLength', 'cooktopType', 
                                'ovenType', 'ceilingInsulation', 'wallInsulation', 
                                'doubleGlazing', 'draftSealing', 'poolHeating', 'solarPV', 'battery'];
            
            radioGroups.forEach(group => {
                const selected = document.querySelector(`input[name="${group}"]:checked`);
                if (group.includes('Insulation') || group === 'doubleGlazing' || group === 'draftSealing') {
                    auditData.insulation[group] = selected?.value || 'none';
                } else {
                    auditData[group] = selected?.value || '';
                }
            });
            
            // Checkboxes
            auditData.alternativeTransport.ebike = document.getElementById('ebike')?.checked || false;
            auditData.alternativeTransport.publicTransport = document.getElementById('publicTransport')?.checked || false;
            auditData.alternativeTransport.bicycle = document.getElementById('bicycle')?.checked || false;
            auditData.alternativeTransport.walking = document.getElementById('walking')?.checked || false;
            
            auditData.features.externalShading = document.getElementById('externalShading')?.checked || false;
            auditData.features.windowCoverings = document.getElementById('windowCoverings')?.checked || false;
            auditData.features.northFacing = document.getElementById('northFacing')?.checked || false;
            auditData.features.swimmingPool = document.getElementById('swimmingPool')?.checked || false;
            auditData.features.spa = document.getElementById('spa')?.checked || false;
            auditData.features.workshop = document.getElementById('workshop')?.checked || false;
            
            // Other inputs
            auditData.wfhDays = parseInt(document.getElementById('wfhDays')?.value) || 0;
            auditData.greenPower = parseInt(document.getElementById('greenPower')?.value) || 0;
            auditData.energyEfforts = document.getElementById('energyEfforts')?.value || '';
            
            // Behavior sliders
            auditData.behaviors.lightsOff = parseInt(document.getElementById('lightsOff')?.value) || 2;
            auditData.behaviors.standbyOff = parseInt(document.getElementById('standbyOff')?.value) || 1;
            auditData.behaviors.coldWashing = parseInt(document.getElementById('coldWashing')?.value) || 2;
            auditData.behaviors.airDry = parseInt(document.getElementById('airDry')?.value) || 2;
            auditData.behaviors.closeCurtains = parseInt(document.getElementById('closeCurtains')?.value) || 2;
            auditData.behaviors.thermostat = parseInt(document.getElementById('thermostat')?.value) || 1;
            
            // Save to localStorage
            localStorage.setItem('energyAuditData', JSON.stringify(auditData));
            showSaveIndicator();
        }

        function loadSavedData() {
            const saved = localStorage.getItem('energyAuditData');
            if (saved) {
                auditData = JSON.parse(saved);
                
                // Restore form values
                if (document.getElementById('studentName')) document.getElementById('studentName').value = auditData.studentName;
                if (document.getElementById('postcode')) document.getElementById('postcode').value = auditData.postcode;
                if (document.getElementById('dwellingType')) document.getElementById('dwellingType').value = auditData.dwellingType;
                if (document.getElementById('occupants')) document.getElementById('occupants').value = auditData.occupants;
                if (document.getElementById('floorArea')) document.getElementById('floorArea').value = auditData.floorArea;
                if (document.getElementById('buildingAge')) document.getElementById('buildingAge').value = auditData.buildingAge;
                if (document.getElementById('wfhDays')) document.getElementById('wfhDays').value = auditData.wfhDays;
                if (document.getElementById('greenPower')) document.getElementById('greenPower').value = auditData.greenPower;
                if (document.getElementById('energyEfforts')) document.getElementById('energyEfforts').value = auditData.energyEfforts;
                
                // Restore vehicles
                if (auditData.vehicles.length > 0) {
                    auditData.vehicles.forEach(vehicle => {
                        addVehicle(vehicle);
                    });
                }
            }
        }

        function showSaveIndicator() {
            const indicator = document.getElementById('saveIndicator');
            indicator.classList.add('show');
            setTimeout(() => {
                indicator.classList.remove('show');
            }, 2000);
        }

        function setupEventListeners() {
            // Hot water system change
            document.querySelectorAll('input[name="hotWaterType"]').forEach(radio => {
                radio.addEventListener('change', (e) => {
                    const boostGroup = document.getElementById('boostTypeGroup');
                    if (e.target.value === 'solar') {
                        boostGroup.style.display = 'block';
                    } else {
                        boostGroup.style.display = 'none';
                    }
                });
            });
            
            // Swimming pool checkbox
            document.getElementById('swimmingPool')?.addEventListener('change', (e) => {
                const poolHeatingGroup = document.getElementById('poolHeatingGroup');
                if (e.target.checked) {
                    poolHeatingGroup.style.display = 'block';
                } else {
                    poolHeatingGroup.style.display = 'none';
                }
            });
            
            // Behavior sliders
            const behaviorLabels = {
                lightsOff: ['Never', 'Rarely', 'Sometimes', 'Always'],
                standbyOff: ['Never', 'Rarely', 'Sometimes', 'Always'],
                coldWashing: ['Never', 'Rarely', 'Sometimes', 'Always'],
                airDry: ['Never', 'Rarely', 'Sometimes', 'Always'],
                closeCurtains: ['Never', 'Rarely', 'Sometimes', 'Always'],
                thermostat: ['Never', 'Rarely', 'Sometimes', 'Always']
            };
            
            Object.keys(behaviorLabels).forEach(key => {
                const slider = document.getElementById(key);
                const label = document.getElementById(key + 'Value');
                if (slider && label) {
                    slider.addEventListener('input', (e) => {
                        label.textContent = behaviorLabels[key][e.target.value];
                    });
                }
            });
            
            // Auto-save on all inputs
            document.querySelectorAll('input, select, textarea').forEach(element => {
                element.addEventListener('change', saveData);
            });
        }

        let vehicleCount = 0;
        
        function addVehicle(vehicleData = null) {
            vehicleCount++;
            const vehiclesList = document.getElementById('vehiclesList');
            
            const vehicleEntry = document.createElement('div');
            vehicleEntry.className = 'vehicle-entry';
            vehicleEntry.id = `vehicle${vehicleCount}`;
            
            vehicleEntry.innerHTML = `
                <h3>Vehicle ${vehicleCount}</h3>
                <div class="form-group">
                    <label>Name (e.g., "Mum's car"):</label>
                    <input type="text" id="vehicleName${vehicleCount}" placeholder="Name this vehicle" 
                           value="${vehicleData?.name || ''}">
                </div>
                <div class="form-group">
                    <label>Type:</label>
                    <select id="vehicleType${vehicleCount}">
                        <option value="">Select...</option>
                        <option value="car" ${vehicleData?.type === 'car' ? 'selected' : ''}>Car</option>
                        <option value="suv" ${vehicleData?.type === 'suv' ? 'selected' : ''}>SUV/4WD</option>
                        <option value="ute" ${vehicleData?.type === 'ute' ? 'selected' : ''}>Ute/Van</option>
                        <option value="motorcycle" ${vehicleData?.type === 'motorcycle' ? 'selected' : ''}>Motorcycle</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Fuel:</label>
                    <select id="vehicleFuel${vehicleCount}">
                        <option value="">Select...</option>
                        <option value="petrol" ${vehicleData?.fuel === 'petrol' ? 'selected' : ''}>Petrol</option>
                        <option value="diesel" ${vehicleData?.fuel === 'diesel' ? 'selected' : ''}>Diesel</option>
                        <option value="hybrid" ${vehicleData?.fuel === 'hybrid' ? 'selected' : ''}>Hybrid</option>
                        <option value="plug-in-hybrid" ${vehicleData?.fuel === 'plug-in-hybrid' ? 'selected' : ''}>Plug-in Hybrid</option>
                        <option value="electric" ${vehicleData?.fuel === 'electric' ? 'selected' : ''}>Electric</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Size:</label>
                    <select id="vehicleSize${vehicleCount}">
                        <option value="">Select...</option>
                        <option value="small" ${vehicleData?.size === 'small' ? 'selected' : ''}>Small</option>
                        <option value="medium" ${vehicleData?.size === 'medium' ? 'selected' : ''}>Medium</option>
                        <option value="large" ${vehicleData?.size === 'large' ? 'selected' : ''}>Large</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Km/year:</label>
                    <input type="number" id="vehicleKm${vehicleCount}" min="0" max="100000" 
                           value="${vehicleData?.km || 15000}" placeholder="15000">
                </div>
                ${vehicleCount > 1 ? `<button class="remove-vehicle" onclick="removeVehicle(${vehicleCount})">Remove</button>` : ''}
            `;
            
            vehiclesList.appendChild(vehicleEntry);
            
            // Add event listeners
            vehicleEntry.querySelectorAll('input, select').forEach(element => {
                element.addEventListener('change', () => {
                    updateVehicleData();
                    saveData();
                });
            });
        }

        function removeVehicle(id) {
            document.getElementById(`vehicle${id}`).remove();
            updateVehicleData();
            saveData();
        }

        function updateVehicleData() {
            auditData.vehicles = [];
            for (let i = 1; i <= vehicleCount; i++) {
                const vehicleDiv = document.getElementById(`vehicle${i}`);
                if (vehicleDiv) {
                    const vehicle = {
                        name: document.getElementById(`vehicleName${i}`)?.value || `Vehicle ${i}`,
                        type: document.getElementById(`vehicleType${i}`)?.value || '',
                        fuel: document.getElementById(`vehicleFuel${i}`)?.value || '',
                        size: document.getElementById(`vehicleSize${i}`)?.value || '',
                        km: parseInt(document.getElementById(`vehicleKm${i}`)?.value) || 15000
                    };
                    auditData.vehicles.push(vehicle);
                }
            }
        }

        function toggleExpandable(header) {
            header.parentElement.classList.toggle('expanded');
        }

        // Energy calculation functions
        function calculateResults() {
            saveData();
            
            // Base consumption values (kWh/year)
            const baseConsumption = {
                heating: {
                    'gas-ducted': 18000,
                    'reverse-cycle': 2500,
                    'gas-wall': 12000,
                    'electric': 4000,
                    'wood': 0,
                    'none': 0
                },
                cooling: {
                    'ducted-ac': 2000,
                    'split-system': 1200,
                    'evaporative': 400,
                    'fans': 150,
                    'none': 0
                },
                hotWater: {
                    'gas-storage': 5500,
                    'gas-instant': 4500,
                    'electric-storage': 3500,
                    'heat-pump': 1200,
                    'solar': 800
                }
            };
            
            // Size multipliers
            const sizeMultipliers = {
                'small': 0.6,
                'medium': 1.0,
                'large': 1.4,
                'very-large': 1.8
            };
            
            // Building age multipliers
            const ageMultipliers = {
                'pre-1990': 1.3,
                '1990-2005': 1.1,
                '2005-2015': 0.95,
                'post-2015': 0.8
            };
            
            // Usage multipliers
            const usageMultipliers = {
                heating: {
                    'daily': 1.0,
                    'most-days': 0.75,
                    'sometimes': 0.4,
                    'rarely': 0.15
                },
                cooling: {
                    'daily': 1.0,
                    'hot-days': 0.5,
                    'sometimes': 0.25,
                    'rarely': 0.1
                }
            };
            
            // Calculate heating energy
            let heatingEnergy = baseConsumption.heating[auditData.heatingType] || 0;
            heatingEnergy *= sizeMultipliers[auditData.floorArea] || 1;
            heatingEnergy *= ageMultipliers[auditData.buildingAge] || 1;
            heatingEnergy *= usageMultipliers.heating[auditData.heatingUsage] || 1;
            
            // Apply insulation factors
            if (auditData.insulation.ceilingInsulation === 'full') heatingEnergy *= 0.85;
            else if (auditData.insulation.ceilingInsulation === 'partial') heatingEnergy *= 0.92;
            
            if (auditData.insulation.wallInsulation === 'full') heatingEnergy *= 0.9;
            else if (auditData.insulation.wallInsulation === 'partial') heatingEnergy *= 0.95;
            
            if (auditData.insulation.doubleGlazing === 'most') heatingEnergy *= 0.92;
            else if (auditData.insulation.doubleGlazing === 'some') heatingEnergy *= 0.96;
            
            if (auditData.insulation.draftSealing === 'good') heatingEnergy *= 0.95;
            
            // Occupant factor
            const occupantFactor = Math.min(0.8 + (0.05 * auditData.occupants), 1.2);
            heatingEnergy *= occupantFactor;
            
            // Calculate cooling energy
            let coolingEnergy = baseConsumption.cooling[auditData.coolingType] || 0;
            coolingEnergy *= sizeMultipliers[auditData.floorArea] || 1;
            coolingEnergy *= ageMultipliers[auditData.buildingAge] || 1;
            coolingEnergy *= usageMultipliers.cooling[auditData.coolingUsage] || 1;
            
            // Apply features
            if (auditData.features.externalShading) coolingEnergy *= 0.9;
            if (auditData.features.windowCoverings) coolingEnergy *= 0.95;
            
            // Calculate hot water energy
            let hotWaterEnergy = baseConsumption.hotWater[auditData.hotWaterType] || 3000;
            
            // Special handling for solar hot water with boost
            if (auditData.hotWaterType === 'solar') {
                if (auditData.boostType === 'gas') {
                    hotWaterEnergy = 900; // Gas boosted solar hot water consumption
                } else {
                    hotWaterEnergy = 800; // Electric boosted solar hot water
                }
            }
            
            hotWaterEnergy *= (0.4 + 0.3 * auditData.occupants);
            
            // Shower length factors
            const showerFactors = {
                'short': 0.7,
                'medium': 1.0,
                'long': 1.3,
                'very-long': 1.6
            };
            hotWaterEnergy *= showerFactors[auditData.showerLength] || 1;
            
            // Calculate transport energy
            let transportEnergy = 0;
            let transportCO2 = 0;
            
            const vehicleConsumption = {
                petrol: { small: 0.579, medium: 0.712, large: 0.890 },
                diesel: { small: 0.589, medium: 0.749, large: 0.963 },
                hybrid: { small: 0.376, medium: 0.463, large: 0.579 },
                'plug-in-hybrid': { small: 0.25, medium: 0.31, large: 0.39 },
                electric: { small: 0.18, medium: 0.18, large: 0.18 }
            };
            
            auditData.vehicles.forEach(vehicle => {
                if (vehicle.fuel && vehicle.size && vehicle.km) {
                    let consumption = vehicleConsumption[vehicle.fuel]?.[vehicle.size] || 0.7;
                    let vehicleKwh = vehicle.km * consumption;
                    
                    // Apply work from home reduction
                    vehicleKwh *= (1 - auditData.wfhDays * 0.08);
                    
                    // Apply public transport reduction
                    if (auditData.alternativeTransport.publicTransport) {
                        vehicleKwh *= 0.75;
                    }
                    
                    transportEnergy += vehicleKwh;
                    
                    // Calculate CO2 for transport
                    if (vehicle.fuel === 'petrol') {
                        transportCO2 += (vehicleKwh / 8.9) * 0.259 * 1000;
                    } else if (vehicle.fuel === 'diesel') {
                        transportCO2 += (vehicleKwh / 10.7) * 0.252 * 1000;
                    } else if (vehicle.fuel === 'hybrid') {
                        transportCO2 += (vehicleKwh / 8.9) * 0.259 * 1000 * 0.65;
                    } else if (vehicle.fuel === 'plug-in-hybrid') {
                        // 50% electric, 50% petrol assumption
                        transportCO2 += (vehicleKwh * 0.5 / 8.9) * 0.259 * 1000;
                    }
                    // Electric vehicle CO2 calculated with electricity
                }
            });
            
            // Calculate appliances and other
            let appliancesEnergy = 2200; // Base load
            if (auditData.features.swimmingPool) {
                appliancesEnergy += 10000;
                if (auditData.poolHeating === 'gas') {
                    // Pool heating added to gas separately
                }
            }
            if (auditData.features.spa) appliancesEnergy += 2500;
            if (auditData.features.workshop) appliancesEnergy += 1500;
            
            // Cooking energy
            let cookingGasEnergy = 0;
            let cookingElecEnergy = 0;
            
            if (auditData.cooktopType === 'gas') cookingGasEnergy += 400;
            else cookingElecEnergy += 400;
            
            if (auditData.ovenType === 'gas') cookingGasEnergy += 200;
            else cookingElecEnergy += 400;
            
            // Apply behavior adjustments
            let behaviorMultiplier = 1;
            const behaviorSum = Object.values(auditData.behaviors).reduce((a, b) => a + b, 0);
            if (behaviorSum > 15) behaviorMultiplier = 0.85;
            else if (behaviorSum > 10) behaviorMultiplier = 0.95;
            
            appliancesEnergy *= behaviorMultiplier;
            cookingElecEnergy *= behaviorMultiplier;
            
            // Separate gas and electricity
            let gasEnergy = 0;
            let electricityEnergy = 0;
            
            // Heating
            if (auditData.heatingType && auditData.heatingType.includes('gas')) {
                gasEnergy += heatingEnergy;
            } else {
                electricityEnergy += heatingEnergy;
            }
            
            // Cooling (always electric)
            electricityEnergy += coolingEnergy;
            
            // Hot water - FIXED: Properly handle gas-boosted solar
            if (auditData.hotWaterType === 'solar' && auditData.boostType === 'gas') {
                gasEnergy += hotWaterEnergy; // Add to gas consumption
            } else if (auditData.hotWaterType && auditData.hotWaterType.includes('gas')) {
                gasEnergy += hotWaterEnergy;
            } else {
                electricityEnergy += hotWaterEnergy;
            }
            
            // Cooking
            gasEnergy += cookingGasEnergy;
            electricityEnergy += cookingElecEnergy;
            
            // Pool heating
            if (auditData.poolHeating === 'gas') gasEnergy += 15000;
            
            // Appliances (always electric)
            electricityEnergy += appliancesEnergy;
            
            // Add electric vehicle consumption to electricity
            auditData.vehicles.forEach(vehicle => {
                if (vehicle.fuel === 'electric' && vehicle.size && vehicle.km) {
                    let vehicleKwh = vehicle.km * 0.18;
                    vehicleKwh *= (1 - auditData.wfhDays * 0.08);
                    if (auditData.alternativeTransport.publicTransport) {
                        vehicleKwh *= 0.75;
                    }
                    electricityEnergy += vehicleKwh;
                }
                // Plug-in hybrid: 50% to electricity
                if (vehicle.fuel === 'plug-in-hybrid' && vehicle.size && vehicle.km) {
                    let vehicleKwh = vehicle.km * vehicleConsumption['plug-in-hybrid'][vehicle.size] * 0.5;
                    vehicleKwh *= (1 - auditData.wfhDays * 0.08);
                    if (auditData.alternativeTransport.publicTransport) {
                        vehicleKwh *= 0.75;
                    }
                    electricityEnergy += vehicleKwh;
                }
            });
            
            // Solar generation
            let solarGeneration = 0;
            let selfConsumption = 0;
            
            if (auditData.solarPV === 'small') solarGeneration = 5500;
            else if (auditData.solarPV === 'medium') solarGeneration = 9000;
            else if (auditData.solarPV === 'large') solarGeneration = 13000;
            
            if (solarGeneration > 0) {
                if (auditData.battery === 'none') selfConsumption = solarGeneration * 0.3;
                else if (auditData.battery === 'small') selfConsumption = solarGeneration * 0.6;
                else if (auditData.battery === 'large') selfConsumption = solarGeneration * 0.8;
                
                electricityEnergy = Math.max(0, electricityEnergy - selfConsumption);
            }
            
            // Calculate total energy
            const totalEnergy = electricityEnergy + gasEnergy + transportEnergy;
            
            // Calculate CO2 emissions
            const electricityCO2 = electricityEnergy * 0.86 * (1 - auditData.greenPower / 100);
            const gasCO2 = gasEnergy * 0.186;
            const totalCO2 = (electricityCO2 + gasCO2 + transportCO2) / 1000; // Convert to kg
            
            // Store results
            auditData.results = {
                totalEnergy: Math.round(totalEnergy),
                totalCO2: Math.round(totalCO2),
                perCapitaEnergy: Math.round(totalEnergy / auditData.occupants),
                perCapitaCO2: Math.round(totalCO2 / auditData.occupants),
                electricityEnergy: Math.round(electricityEnergy),
                gasEnergy: Math.round(gasEnergy),
                transportEnergy: Math.round(transportEnergy),
                heatingEnergy: Math.round(heatingEnergy),
                coolingEnergy: Math.round(coolingEnergy),
                hotWaterEnergy: Math.round(hotWaterEnergy),
                appliancesEnergy: Math.round(appliancesEnergy + cookingElecEnergy + cookingGasEnergy),
                solarGeneration: Math.round(solarGeneration),
                selfConsumption: Math.round(selfConsumption)
            };
            
            // Save and display
            saveData();
            displayResults();
            goToPage(9);
        }

        function displayResults() {
            // Update summary values
            document.getElementById('totalEnergy').textContent = `${auditData.results.totalEnergy.toLocaleString()} kWh/year`;
            document.getElementById('totalCO2').textContent = `${auditData.results.totalCO2.toLocaleString()} kg/year`;
            document.getElementById('perCapitaEnergy').textContent = `${auditData.results.perCapitaEnergy.toLocaleString()} kWh/year`;
            document.getElementById('perCapitaCO2').textContent = `${auditData.results.perCapitaCO2.toLocaleString()} kg/year`;
            
            // Update comparison bar
            const percentage = Math.min(100, (auditData.results.totalEnergy / 28000) * 75);
            document.getElementById('comparisonFill').style.width = `${percentage}%`;
            
            // Create charts
            createCharts();
            
            // Generate improvements
            generateImprovements();
            
            // Generate detailed breakdowns
            generateDetailedBreakdowns();
            
            // Generate print report
            generatePrintReport();
        }

        function createCharts() {
            // Sources pie chart
            const sourcesCtx = document.getElementById('sourcesChart').getContext('2d');
            new Chart(sourcesCtx, {
                type: 'pie',
                data: {
                    labels: ['Electricity', 'Gas', 'Transport'],
                    datasets: [{
                        data: [
                            auditData.results.electricityEnergy,
                            auditData.results.gasEnergy,
                            auditData.results.transportEnergy
                        ],
                        backgroundColor: ['#1976D2', '#FF6B35', '#4CAF50']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
            
            // Uses bar chart
            const usesCtx = document.getElementById('usesChart').getContext('2d');
            new Chart(usesCtx, {
                type: 'bar',
                data: {
                    labels: ['Heating', 'Cooling', 'Hot Water', 'Transport', 'Appliances'],
                    datasets: [{
                        label: 'Energy (kWh/year)',
                        data: [
                            auditData.results.heatingEnergy,
                            auditData.results.coolingEnergy,
                            auditData.results.hotWaterEnergy,
                            auditData.results.transportEnergy,
                            auditData.results.appliancesEnergy
                        ],
                        backgroundColor: '#2E7D32'
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        function generateImprovements() {
            const improvements = [];
            
            if (auditData.heatingType && auditData.heatingType !== 'reverse-cycle' && auditData.heatingType !== 'none') {
                improvements.push({
                    title: 'Upgrade to Reverse Cycle',
                    description: 'Modern systems are 300-600% efficient vs gas at 80-90%.',
                    savings: 'Typical: 10,000-15,000 kWh/year'
                });
            }
            
            if (auditData.insulation.ceilingInsulation !== 'full') {
                improvements.push({
                    title: 'Install Ceiling Insulation',
                    description: 'Reduces heat loss/gain significantly.',
                    savings: 'Typical: 15% of heating/cooling'
                });
            }
            
            if (auditData.vehicles.length > 0 && !auditData.alternativeTransport.publicTransport) {
                improvements.push({
                    title: 'Use Public Transport Weekly',
                    description: 'Replace one car trip per week.',
                    savings: 'Typical: 2,000-3,000 kWh/year'
                });
            }
            
            if (auditData.solarPV === 'none') {
                improvements.push({
                    title: 'Install Solar Panels',
                    description: '6.6kW system generates ~9,000 kWh/year in Victoria.',
                    savings: 'Typical: 30-50% of electricity'
                });
            }
            
            const improvementsList = document.getElementById('improvementsList');
            improvementsList.innerHTML = improvements.map(item => `
                <div class="results-card">
                    <h3>${item.title}</h3>
                    <p>${item.description}</p>
                    <p><strong>${item.savings}</strong></p>
                </div>
            `).join('');
        }

        function generateDetailedBreakdowns() {
            // Heating & Cooling
            document.getElementById('heatingCoolingDetails').innerHTML = `
                <p><strong>Heating:</strong> ${auditData.results.heatingEnergy.toLocaleString()} kWh/year</p>
                <p><strong>Cooling:</strong> ${auditData.results.coolingEnergy.toLocaleString()} kWh/year</p>
                <p><strong>Combined:</strong> ${(auditData.results.heatingEnergy + auditData.results.coolingEnergy).toLocaleString()} kWh/year</p>
                <p><strong>% of Total:</strong> ${Math.round((auditData.results.heatingEnergy + auditData.results.coolingEnergy) / auditData.results.totalEnergy * 100)}%</p>
                <hr style="margin: 10px 0;">
                <p>System: ${auditData.heatingType || 'Not specified'} / ${auditData.coolingType || 'Not specified'}</p>
                <p>Usage: ${auditData.heatingUsage || 'Not specified'} / ${auditData.coolingUsage || 'Not specified'}</p>
            `;
            
            // Hot Water
            document.getElementById('hotWaterDetails').innerHTML = `
                <p><strong>Energy:</strong> ${auditData.results.hotWaterEnergy.toLocaleString()} kWh/year</p>
                <p><strong>% of Total:</strong> ${Math.round(auditData.results.hotWaterEnergy / auditData.results.totalEnergy * 100)}%</p>
                <hr style="margin: 10px 0;">
                <p>System: ${auditData.hotWaterType || 'Not specified'}</p>
                ${auditData.boostType ? `<p>Boost: ${auditData.boostType}</p>` : ''}
                <p>Shower: ${auditData.showerLength || 'Not specified'}</p>
                <p>Occupants: ${auditData.occupants}</p>
            `;
            
            // Transport
            let transportDetails = `
                <p><strong>Energy:</strong> ${auditData.results.transportEnergy.toLocaleString()} kWh/year</p>
                <p><strong>% of Total:</strong> ${Math.round(auditData.results.transportEnergy / auditData.results.totalEnergy * 100)}%</p>
                <hr style="margin: 10px 0;">
            `;
            
            auditData.vehicles.forEach((vehicle, index) => {
                transportDetails += `
                    <p><strong>${vehicle.name || `Vehicle ${index + 1}`}:</strong> ${vehicle.type}, ${vehicle.fuel}, ${vehicle.km.toLocaleString()} km/year</p>
                `;
            });
            
            document.getElementById('transportDetails').innerHTML = transportDetails;
            
            // Appliances
            document.getElementById('appliancesDetails').innerHTML = `
                <p><strong>Energy:</strong> ${auditData.results.appliancesEnergy.toLocaleString()} kWh/year</p>
                <p><strong>% of Total:</strong> ${Math.round(auditData.results.appliancesEnergy / auditData.results.totalEnergy * 100)}%</p>
                <hr style="margin: 10px 0;">
                <p>Base: 2,200 kWh/year</p>
                ${auditData.features.swimmingPool ? '<p>Pool: 10,000 kWh/year</p>' : ''}
                ${auditData.poolHeating === 'gas' ? '<p>Pool heating: 15,000 kWh/year</p>' : ''}
                ${auditData.features.spa ? '<p>Spa: 2,500 kWh/year</p>' : ''}
                ${auditData.features.workshop ? '<p>Workshop: 1,500 kWh/year</p>' : ''}
            `;
            
            // Renewable
            document.getElementById('renewableDetails').innerHTML = `
                <p><strong>Generation:</strong> ${auditData.results.solarGeneration.toLocaleString()} kWh/year</p>
                <p><strong>Self-use:</strong> ${auditData.results.selfConsumption.toLocaleString()} kWh/year</p>
                <p><strong>Export:</strong> ${(auditData.results.solarGeneration - auditData.results.selfConsumption).toLocaleString()} kWh/year</p>
                <hr style="margin: 10px 0;">
                <p>Solar: ${auditData.solarPV || 'None'}</p>
                <p>Battery: ${auditData.battery || 'None'}</p>
                <p>GreenPower: ${auditData.greenPower}%</p>
            `;
        }

        function generatePrintReport() {
            const report = document.getElementById('printReport');
            
            const vehiclesList = auditData.vehicles.map((v, i) => 
                `${v.name || `Vehicle ${i+1}`}: ${v.type} ${v.fuel} (${v.km.toLocaleString()} km/year)`
            ).join(', ') || 'None';
            
            // Victorian average CO2 per person = 7,500 kg/year total / 2.6 people average = 2,900 kg/person
            const vicAvgCO2PerPerson = 2900;
            
            report.innerHTML = `
                <h2 style="color: #2E7D32;">Energy Audit Report</h2>
                <p><strong>Student:</strong> ${auditData.studentName || 'Not provided'}</p>
                <p><strong>Postcode:</strong> ${auditData.postcode || 'Not provided'}</p>
                <p><strong>Date:</strong> ${new Date().toLocaleDateString()}</p>
                
                <h3 style="color: #1976D2; margin-top: 20px;">Household Profile</h3>
                <p>Dwelling: ${auditData.dwellingType || 'Not specified'}, ${auditData.occupants} occupants</p>
                <p>Floor area: ${auditData.floorArea || 'Not specified'}, Built: ${auditData.buildingAge || 'Not specified'}</p>
                
                <h3 style="color: #1976D2; margin-top: 20px;">Energy Results</h3>
                <table style="width: 100%; border-collapse: collapse; margin: 10px 0;">
                    <tr style="background: #f5f5f5;">
                        <td style="padding: 8px; border: 1px solid #ddd;"><strong>Total Energy</strong></td>
                        <td style="padding: 8px; border: 1px solid #ddd; text-align: right;"><strong>${auditData.results.totalEnergy.toLocaleString()} kWh/year</strong></td>
                    </tr>
                    <tr>
                        <td style="padding: 8px; border: 1px solid #ddd;">Total CO₂</td>
                        <td style="padding: 8px; border: 1px solid #ddd; text-align: right;">${auditData.results.totalCO2.toLocaleString()} kg/year</td>
                    </tr>
                    <tr style="background: #f5f5f5;">
                        <td style="padding: 8px; border: 1px solid #ddd;">Per Person Energy</td>
                        <td style="padding: 8px; border: 1px solid #ddd; text-align: right;">${auditData.results.perCapitaEnergy.toLocaleString()} kWh/year</td>
                    </tr>
                    <tr>
                        <td style="padding: 8px; border: 1px solid #ddd;">Per Person CO₂</td>
                        <td style="padding: 8px; border: 1px solid #ddd; text-align: right;">${auditData.results.perCapitaCO2.toLocaleString()} kg/year</td>
                    </tr>
                </table>
                
                <h3 style="color: #1976D2;">Energy Breakdown</h3>
                <p>Electricity: ${auditData.results.electricityEnergy.toLocaleString()} kWh</p>
                <p>Gas: ${auditData.results.gasEnergy.toLocaleString()} kWh</p>
                <p>Transport: ${auditData.results.transportEnergy.toLocaleString()} kWh</p>
                
                <h3 style="color: #1976D2;">Victorian Comparison</h3>
                <p>Average household: 21,096 kWh/year</p>
                <p>Your household: ${Math.round(auditData.results.totalEnergy / 21096 * 100)}% of average</p>
                <p>Average CO₂ per person: ${vicAvgCO2PerPerson.toLocaleString()} kg/year</p>
                <p>Your CO₂ per person: ${Math.round(auditData.results.perCapitaCO2 / vicAvgCO2PerPerson * 100)}% of average</p>
                
                <h3 style="color: #1976D2;">Key Systems</h3>
                <p>Heating: ${auditData.heatingType || 'Not specified'}</p>
                <p>Cooling: ${auditData.coolingType || 'Not specified'}</p>
                <p>Hot Water: ${auditData.hotWaterType || 'Not specified'}${auditData.boostType ? ` (${auditData.boostType} boost)` : ''}</p>
                <p>Solar: ${auditData.solarPV || 'None'}</p>
                <p>Vehicles: ${vehiclesList}</p>
                
                <div style="margin-top: 30px; padding: 12px; background: #E3F2FD; border-radius: 6px;">
                    <p style="font-size: 11px;">
                        <strong>Disclaimer:</strong> Educational estimates based on typical patterns. 
                        Actual energy varies with weather, usage, and efficiency. 
                        Consult professionals for specific advice.
                    </p>
                </div>
            `;
        }
    </script>
</body>
</html>