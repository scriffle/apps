<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Victorian Household Energy Audit Tool</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f5f5;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        header {
            background: #2E7D32;
            color: white;
            padding: 20px;
            border-radius: 8px 8px 0 0;
            margin-bottom: 2px;
        }

        header h1 {
            font-size: 1.8em;
            font-weight: 600;
        }

        header p {
            margin-top: 8px;
            opacity: 0.9;
            font-size: 0.95em;
        }

        .progress-bar {
            background: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 2px solid #e0e0e0;
        }

        .progress-indicator {
            font-size: 0.9em;
            color: #666;
        }

        .save-indicator {
            font-size: 0.85em;
            color: #2E7D32;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .save-indicator.show {
            opacity: 1;
        }

        .content {
            background: white;
            padding: 40px;
            flex: 1;
            overflow-y: auto;
        }

        .page {
            display: none;
            animation: fadeIn 0.3s;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        h2 {
            color: #2E7D32;
            font-size: 1.8em;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .page-intro {
            color: #666;
            margin-bottom: 30px;
            font-size: 0.95em;
            line-height: 1.7;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #444;
        }

        input[type="text"],
        input[type="number"],
        select,
        textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 1em;
            font-family: inherit;
            transition: border-color 0.3s;
        }

        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: #2E7D32;
        }

        textarea {
            resize: vertical;
            min-height: 100px;
        }

        .radio-group,
        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .radio-option,
        .checkbox-option {
            display: flex;
            align-items: center;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .radio-option:hover,
        .checkbox-option:hover {
            background: #f9f9f9;
            border-color: #2E7D32;
        }

        .radio-option input,
        .checkbox-option input {
            margin-right: 10px;
            width: auto;
        }

        .two-column {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .info-box {
            background: #E3F2FD;
            border-left: 4px solid #1976D2;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .warning-box {
            background: #FFF3E0;
            border-left: 4px solid #FF6B35;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .info-box p,
        .warning-box p {
            margin: 0;
            font-size: 0.9em;
        }

        .vehicle-list {
            margin-top: 20px;
        }

        .vehicle-item {
            background: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            margin-bottom: 15px;
            position: relative;
        }

        .vehicle-item h4 {
            margin-bottom: 10px;
            color: #2E7D32;
        }

        .remove-vehicle {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #d32f2f;
            color: white;
            border: none;
            padding: 5px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85em;
        }

        .remove-vehicle:hover {
            background: #b71c1c;
        }

        .add-vehicle-btn {
            background: #1976D2;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1em;
            margin-top: 10px;
        }

        .add-vehicle-btn:hover {
            background: #1565C0;
        }

        .slider-group {
            margin-bottom: 30px;
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .slider-value {
            font-weight: 600;
            color: #2E7D32;
        }

        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #2E7D32;
            cursor: pointer;
        }

        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #2E7D32;
            cursor: pointer;
            border: none;
        }

        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 20px;
            border-top: 1px solid #e0e0e0;
        }

        button {
            padding: 12px 30px;
            border: none;
            border-radius: 4px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }

        .btn-primary {
            background: #2E7D32;
            color: white;
        }

        .btn-primary:hover {
            background: #1B5E20;
        }

        .btn-secondary {
            background: #757575;
            color: white;
        }

        .btn-secondary:hover {
            background: #616161;
        }

        .btn-print {
            background: #1976D2;
            color: white;
            margin-right: 10px;
        }

        .btn-print:hover {
            background: #1565C0;
        }

        .results-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .result-card {
            background: linear-gradient(135deg, #2E7D32 0%, #1B5E20 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }

        .result-card.electricity {
            background: linear-gradient(135deg, #1976D2 0%, #1565C0 100%);
        }

        .result-card.gas {
            background: linear-gradient(135deg, #FF6B35 0%, #E85A2B 100%);
        }

        .result-card.transport {
            background: linear-gradient(135deg, #7B1FA2 0%, #6A1B9A 100%);
        }

        .result-card.co2 {
            background: linear-gradient(135deg, #424242 0%, #212121 100%);
        }

        .result-value {
            font-size: 2.5em;
            font-weight: 700;
            margin: 10px 0;
        }

        .result-label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .chart-container {
            max-width: 600px;
            margin: 30px auto;
            padding: 20px;
            background: #fafafa;
            border-radius: 8px;
        }

        .comparison-table {
            width: 100%;
            margin: 30px 0;
            border-collapse: collapse;
        }

        .comparison-table th,
        .comparison-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }

        .comparison-table th {
            background: #f5f5f5;
            font-weight: 600;
            color: #2E7D32;
        }

        .comparison-table tr:hover {
            background: #f9f9f9;
        }

        .improvement-item {
            background: #f9f9f9;
            border-left: 4px solid #2E7D32;
            padding: 20px;
            margin-bottom: 20px;
            border-radius: 4px;
        }

        .improvement-item h3 {
            color: #2E7D32;
            margin-bottom: 10px;
        }

        .improvement-item .savings {
            font-weight: 600;
            color: #1976D2;
            margin: 10px 0;
        }

        .expandable {
            margin-bottom: 15px;
        }

        .expandable-header {
            background: #2E7D32;
            color: white;
            padding: 15px;
            cursor: pointer;
            border-radius: 4px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .expandable-header:hover {
            background: #1B5E20;
        }

        .expandable-content {
            display: none;
            padding: 20px;
            background: #fafafa;
            border: 1px solid #ddd;
            border-top: none;
            border-radius: 0 0 4px 4px;
        }

        .expandable-content.show {
            display: block;
        }

        .calculation-formula {
            background: white;
            border: 1px solid #ddd;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
        }

        .reference-item {
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid #e0e0e0;
        }

        .reference-item h3 {
            color: #2E7D32;
            margin-bottom: 8px;
        }

        .reference-item a {
            color: #1976D2;
            text-decoration: none;
        }

        .reference-item a:hover {
            text-decoration: underline;
        }

        @media print {
            .no-print {
                display: none;
            }
            
            body {
                background: white;
            }
            
            .container {
                max-width: 100%;
                padding: 0;
            }
            
            .content {
                padding: 20px;
            }
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }

            .content {
                padding: 20px;
            }

            .two-column {
                grid-template-columns: 1fr;
            }

            .results-summary {
                grid-template-columns: 1fr;
            }

            h2 {
                font-size: 1.4em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="no-print">
            <h1>Victorian Household Energy Audit Tool</h1>
            <p>Year 8 Educational Resource - Energy Consumption and CO₂ Emissions Calculator</p>
        </header>

        <div class="progress-bar no-print">
            <div class="progress-indicator">
                <button onclick="prevPage()" style="background: none; border: none; cursor: pointer; font-size: 1.2em; padding: 0 10px; color: #2E7D32;" title="Previous page">&lt;</button>
                <button onclick="nextPage()" style="background: none; border: none; cursor: pointer; font-size: 1.2em; padding: 0 10px; color: #2E7D32;" title="Next page">&gt;</button>
                Page <span id="currentPage">1</span> of 14
            </div>
            <div class="save-indicator" id="saveIndicator">Progress Saved</div>
        </div>

        <div class="content">
            <!-- PAGE 1: Welcome -->
            <div class="page active" data-page="1">
                <h2>Welcome to the Household Energy Audit</h2>
                <div class="page-intro">
                    <p>This tool helps you understand where your household uses energy and calculate your carbon dioxide emissions. Most household energy consumption comes from three main areas:</p>
                </div>

                <div class="info-box">
                    <p><strong>Major Energy Users (85-90% of total household energy):</strong></p>
                    <ul style="margin-left: 20px; margin-top: 10px;">
                        <li>Heating and cooling (40-60% of household energy)</li>
                        <li>Transport (30-40% of household energy)</li>
                        <li>Hot water systems (15-20% of household energy)</li>
                    </ul>
                    <p style="margin-top: 10px;"><em>Note: Lights and standby power typically account for only 3-5% of total household energy use.</em></p>
                </div>

                <div class="form-group">
                    <label for="studentName">Your Name</label>
                    <input type="text" id="studentName" placeholder="Enter your name">
                </div>

                <div class="form-group">
                    <label for="postcode">Postcode</label>
                    <input type="text" id="postcode" placeholder="e.g., 3000" maxlength="4">
                </div>

                <div class="navigation">
                    <div></div>
                    <button class="btn-primary" onclick="nextPage()">Next</button>
                </div>
            </div>

            <!-- PAGE 2: Home Details -->
            <div class="page" data-page="2">
                <h2>Home Details</h2>
                <div class="page-intro">
                    <p>Tell us about your home. Larger and older homes typically use more energy for heating and cooling.</p>
                </div>

                <div class="form-group">
                    <label>Dwelling Type</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="dwellingType" value="house">
                            <span>House (detached)</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="dwellingType" value="townhouse">
                            <span>Townhouse or semi-detached</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="dwellingType" value="apartment">
                            <span>Apartment or unit</span>
                        </label>
                    </div>
                </div>

                <div class="two-column">
                    <div class="form-group">
                        <label for="occupants">Number of Occupants</label>
                        <input type="number" id="occupants" min="1" max="10" value="3">
                    </div>

                    <div class="form-group">
                        <label for="floorArea">Approximate Floor Area</label>
                        <select id="floorArea">
                            <option value="">Select size</option>
                            <option value="small">Small (less than 100m²)</option>
                            <option value="medium">Medium (100-200m²)</option>
                            <option value="large">Large (200-300m²)</option>
                            <option value="very-large">Very Large (more than 300m²)</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label for="buildingAge">Building Age</label>
                    <select id="buildingAge">
                        <option value="">Select age</option>
                        <option value="pre-1990">Before 1990</option>
                        <option value="1990-2005">1990-2005</option>
                        <option value="2005-2015">2005-2015</option>
                        <option value="post-2015">After 2015</option>
                    </select>
                </div>

                <div class="navigation">
                    <button class="btn-secondary" onclick="prevPage()">Back</button>
                    <button class="btn-primary" onclick="nextPage()">Next</button>
                </div>
            </div>

            <!-- PAGE 3: Heating & Cooling -->
            <div class="page" data-page="3">
                <h2>Heating and Cooling</h2>
                <div class="page-intro">
                    <p>Heating and cooling systems are the largest energy users in most Victorian homes. The type of system and how often you use it significantly affects your energy consumption.</p>
                </div>

                <div class="info-box">
                    <p><strong>Energy Impact:</strong> Reducing your heating temperature by 2°C in winter saves more energy than turning off all lights in your home permanently.</p>
                </div>

                <div class="form-group">
                    <label for="heatingType">Main Heating System</label>
                    <select id="heatingType">
                        <option value="">Select heating type</option>
                        <option value="gas-ducted">Gas Ducted Heating</option>
                        <option value="reverse-cycle">Reverse Cycle (Heat Pump)</option>
                        <option value="gas-wall">Gas Wall Furnace</option>
                        <option value="electric">Electric Heater</option>
                        <option value="none">No heating system</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="heatingUsage">Heating Usage (Winter)</label>
                    <select id="heatingUsage">
                        <option value="">Select usage frequency</option>
                        <option value="daily">Daily use</option>
                        <option value="most-days">Most days (4-6 days per week)</option>
                        <option value="sometimes">Sometimes (1-3 days per week)</option>
                        <option value="rarely">Rarely</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="coolingType">Main Cooling System</label>
                    <select id="coolingType">
                        <option value="">Select cooling type</option>
                        <option value="ducted-ac">Ducted Air Conditioning</option>
                        <option value="split-system">Split System Air Conditioner</option>
                        <option value="evaporative">Evaporative Cooler</option>
                        <option value="fans">Fans only</option>
                        <option value="none">No cooling system</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="coolingUsage">Cooling Usage (Summer)</label>
                    <select id="coolingUsage">
                        <option value="">Select usage frequency</option>
                        <option value="daily">Daily use during summer</option>
                        <option value="hot-days">Hot days only</option>
                        <option value="sometimes">Sometimes</option>
                        <option value="rarely">Rarely</option>
                    </select>
                </div>

                <div class="navigation">
                    <button class="btn-secondary" onclick="prevPage()">Back</button>
                    <button class="btn-primary" onclick="nextPage()">Next</button>
                </div>
            </div>

            <!-- PAGE 4: Hot Water & Cooking -->
            <div class="page" data-page="4">
                <h2>Hot Water and Cooking</h2>
                <div class="page-intro">
                    <p>Hot water systems are the second-largest energy user in Victorian homes. The type of system and shower duration significantly impact energy consumption.</p>
                </div>

                <div class="form-group">
                    <label for="hotWaterType">Hot Water System</label>
                    <select id="hotWaterType">
                        <option value="">Select system type</option>
                        <option value="gas-storage">Gas Storage Tank</option>
                        <option value="gas-instant">Gas Instantaneous</option>
                        <option value="electric-storage">Electric Storage Tank</option>
                        <option value="heat-pump">Heat Pump</option>
                        <option value="solar-electric">Solar with Electric Boost</option>
                        <option value="solar-gas">Solar with Gas Boost</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="showerLength">Average Shower Length</label>
                    <select id="showerLength">
                        <option value="">Select duration</option>
                        <option value="short">Less than 4 minutes</option>
                        <option value="medium">4-7 minutes</option>
                        <option value="long">7-10 minutes</option>
                        <option value="very-long">More than 10 minutes</option>
                    </select>
                </div>

                <div class="two-column">
                    <div class="form-group">
                        <label for="cooktopType">Cooktop Type</label>
                        <select id="cooktopType">
                            <option value="">Select type</option>
                            <option value="gas">Gas Cooktop</option>
                            <option value="electric">Electric Cooktop</option>
                            <option value="induction">Induction Cooktop</option>
                            <option value="none">No cooktop</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="ovenType">Oven Type</label>
                        <select id="ovenType">
                            <option value="">Select type</option>
                            <option value="gas">Gas Oven</option>
                            <option value="electric">Electric Oven</option>
                            <option value="none">No oven</option>
                        </select>
                    </div>
                </div>

                <div class="navigation">
                    <button class="btn-secondary" onclick="prevPage()">Back</button>
                    <button class="btn-primary" onclick="nextPage()">Next</button>
                </div>
            </div>

            <!-- PAGE 5: Transport -->
            <div class="page" data-page="5">
                <h2>Transport</h2>
                <div class="page-intro">
                    <p>Transport is a major energy user for most households. One litre of petrol contains enough energy to power a television for six months. Reducing one weekly car trip saves more energy than eliminating all standby power in your home.</p>
                </div>

                <div class="info-box">
                    <p><strong>Energy Comparison:</strong> A full tank of petrol (50 litres) contains approximately 445 kWh of energy - enough to run a refrigerator for nearly a year.</p>
                </div>

                <div class="form-group">
                    <label>Household Vehicles</label>
                    <div id="vehicleList" class="vehicle-list"></div>
                    <button class="add-vehicle-btn" onclick="addVehicle()">Add Vehicle</button>
                </div>

                <div class="form-group">
                    <label>Alternative Transport Used</label>
                    <div class="checkbox-group">
                        <label class="checkbox-option">
                            <input type="checkbox" id="ebike">
                            <span>E-bike</span>
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox" id="publicTransport">
                            <span>Public Transport</span>
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox" id="bicycle">
                            <span>Bicycle</span>
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox" id="walking">
                            <span>Walking</span>
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label for="wfhDays">Work/Study from Home Days per Week</label>
                    <input type="number" id="wfhDays" min="0" max="5" value="0">
                    <small style="color: #666; display: block; margin-top: 5px;">Enter number of days per week anyone in household works or studies from home (reduces transport energy)</small>
                </div>

                <div class="navigation">
                    <button class="btn-secondary" onclick="prevPage()">Back</button>
                    <button class="btn-primary" onclick="nextPage()">Next</button>
                </div>
            </div>

            <!-- PAGE 6: Building Efficiency -->
            <div class="page" data-page="6">
                <h2>Building Efficiency</h2>
                <div class="page-intro">
                    <p>Insulation and building features significantly affect heating and cooling energy use. Well-insulated homes can use 30-40% less energy for temperature control.</p>
                </div>

                <div class="form-group">
                    <label for="ceilingInsulation">Ceiling Insulation</label>
                    <select id="ceilingInsulation">
                        <option value="none">None or unknown</option>
                        <option value="partial">Partial coverage</option>
                        <option value="full">Full coverage</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="wallInsulation">Wall Insulation</label>
                    <select id="wallInsulation">
                        <option value="none">None or unknown</option>
                        <option value="partial">Partial coverage</option>
                        <option value="full">Full coverage</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="doubleGlazing">Double Glazed Windows</label>
                    <select id="doubleGlazing">
                        <option value="none">None</option>
                        <option value="some">Some windows</option>
                        <option value="most">Most windows</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="draftSealing">Draft Sealing Quality</label>
                    <select id="draftSealing">
                        <option value="poor">Poor or unknown</option>
                        <option value="good">Good (well sealed)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Additional Features</label>
                    <div class="checkbox-group">
                        <label class="checkbox-option">
                            <input type="checkbox" id="swimmingPool">
                            <span>Swimming Pool</span>
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox" id="poolHeatingCheck">
                            <span>Pool Heating (gas)</span>
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox" id="spa">
                            <span>Spa</span>
                        </label>
                        <label class="checkbox-option">
                            <input type="checkbox" id="workshop">
                            <span>Workshop or Studio</span>
                        </label>
                    </div>
                </div>

                <div class="navigation">
                    <button class="btn-secondary" onclick="prevPage()">Back</button>
                    <button class="btn-primary" onclick="nextPage()">Next</button>
                </div>
            </div>

            <!-- PAGE 7: Renewable Energy -->
            <div class="page" data-page="7">
                <h2>Renewable Energy</h2>
                <div class="page-intro">
                    <p>Solar panels, batteries, and green power options can significantly reduce your household carbon emissions from grid electricity.</p>
                </div>

                <div class="warning-box">
                    <p><strong>Important:</strong> Green power and solar energy only affect emissions from grid electricity. They do not reduce emissions from natural gas heating, gas hot water, or transport fuels.</p>
                </div>

                <div class="form-group">
                    <label for="solarPV">Solar PV System Size</label>
                    <select id="solarPV">
                        <option value="none">No solar panels</option>
                        <option value="small">Small (less than 5kW)</option>
                        <option value="medium">Medium (5-10kW)</option>
                        <option value="large">Large (more than 10kW)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="battery">Battery Storage</label>
                    <select id="battery">
                        <option value="none">No battery</option>
                        <option value="small">Small battery (less than 10kWh)</option>
                        <option value="large">Large battery (10kWh or more)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="greenPower">GreenPower Percentage</label>
                    <select id="greenPower">
                        <option value="0">0% (no GreenPower)</option>
                        <option value="25">25%</option>
                        <option value="50">50%</option>
                        <option value="100">100%</option>
                    </select>
                    <small style="color: #666; display: block; margin-top: 5px;">GreenPower is a government-accredited renewable energy program available through electricity retailers</small>
                </div>

                <div class="navigation">
                    <button class="btn-secondary" onclick="prevPage()">Back</button>
                    <button class="btn-primary" onclick="nextPage()">Next</button>
                </div>
            </div>

            <!-- PAGE 8: Energy Behaviors -->
            <div class="page" data-page="8">
                <h2>Energy Behaviors</h2>
                <div class="page-intro">
                    <p>Daily habits can influence household energy use. Rate how consistently your household practices these behaviors.</p>
                </div>

                <div class="slider-group">
                    <div class="slider-label">
                        <label>Turning off lights when leaving rooms</label>
                        <span class="slider-value" id="lightsOffValue">Sometimes</span>
                    </div>
                    <input type="range" id="lightsOff" min="0" max="3" value="2" oninput="updateSlider('lightsOff')">
                    <div style="display: flex; justify-content: space-between; font-size: 0.85em; color: #666; margin-top: 5px;">
                        <span>Never</span>
                        <span>Rarely</span>
                        <span>Sometimes</span>
                        <span>Always</span>
                    </div>
                </div>

                <div class="slider-group">
                    <div class="slider-label">
                        <label>Turning off devices at the power point (not just standby)</label>
                        <span class="slider-value" id="standbyOffValue">Rarely</span>
                    </div>
                    <input type="range" id="standbyOff" min="0" max="3" value="1" oninput="updateSlider('standbyOff')">
                    <div style="display: flex; justify-content: space-between; font-size: 0.85em; color: #666; margin-top: 5px;">
                        <span>Never</span>
                        <span>Rarely</span>
                        <span>Sometimes</span>
                        <span>Always</span>
                    </div>
                </div>

                <div class="slider-group">
                    <div class="slider-label">
                        <label>Using cold water for clothes washing</label>
                        <span class="slider-value" id="coldWashingValue">Sometimes</span>
                    </div>
                    <input type="range" id="coldWashing" min="0" max="3" value="2" oninput="updateSlider('coldWashing')">
                    <div style="display: flex; justify-content: space-between; font-size: 0.85em; color: #666; margin-top: 5px;">
                        <span>Never</span>
                        <span>Rarely</span>
                        <span>Sometimes</span>
                        <span>Always</span>
                    </div>
                </div>

                <div class="slider-group">
                    <div class="slider-label">
                        <label>Air-drying clothes instead of using dryer</label>
                        <span class="slider-value" id="airDryValue">Sometimes</span>
                    </div>
                    <input type="range" id="airDry" min="0" max="3" value="2" oninput="updateSlider('airDry')">
                    <div style="display: flex; justify-content: space-between; font-size: 0.85em; color: #666; margin-top: 5px;">
                        <span>Never</span>
                        <span>Rarely</span>
                        <span>Sometimes</span>
                        <span>Always</span>
                    </div>
                </div>

                <div class="slider-group">
                    <div class="slider-label">
                        <label>Closing curtains/blinds at night to retain heat</label>
                        <span class="slider-value" id="closeCurtainsValue">Sometimes</span>
                    </div>
                    <input type="range" id="closeCurtains" min="0" max="3" value="2" oninput="updateSlider('closeCurtains')">
                    <div style="display: flex; justify-content: space-between; font-size: 0.85em; color: #666; margin-top: 5px;">
                        <span>Never</span>
                        <span>Rarely</span>
                        <span>Sometimes</span>
                        <span>Always</span>
                    </div>
                </div>

                <div class="slider-group">
                    <div class="slider-label">
                        <label>Setting heating to 20°C or lower in winter</label>
                        <span class="slider-value" id="thermostatValue">Rarely</span>
                    </div>
                    <input type="range" id="thermostat" min="0" max="3" value="1" oninput="updateSlider('thermostat')">
                    <div style="display: flex; justify-content: space-between; font-size: 0.85em; color: #666; margin-top: 5px;">
                        <span>Never</span>
                        <span>Rarely</span>
                        <span>Sometimes</span>
                        <span>Always</span>
                    </div>
                </div>

                <div class="form-group">
                    <label for="energyEfforts">Other Energy Saving Efforts (Optional)</label>
                    <textarea id="energyEfforts" placeholder="Describe any other ways your household reduces energy use..."></textarea>
                </div>

                <div class="navigation">
                    <button class="btn-secondary" onclick="prevPage()">Back</button>
                    <button class="btn-primary" onclick="calculateResults()">Calculate Results</button>
                </div>
            </div>

            <!-- PAGE 9: Summary Dashboard -->
            <div class="page" data-page="9">
                <h2>Your Energy Audit Results</h2>
                <div class="page-intro">
                    <p>Here is a summary of your household energy consumption and carbon dioxide emissions.</p>
                </div>

                <div class="results-summary" id="resultsSummary"></div>

                <div class="chart-container">
                    <canvas id="energyChart"></canvas>
                </div>

                <div class="chart-container">
                    <canvas id="breakdownChart"></canvas>
                </div>

                <h3 style="margin-top: 40px; color: #2E7D32;">Comparison to Victorian Averages</h3>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>Your Household</th>
                            <th>Victorian Average</th>
                            <th>Difference</th>
                        </tr>
                    </thead>
                    <tbody id="comparisonTable"></tbody>
                </table>

                <div class="chart-container">
                    <canvas id="categoryComparisonChart"></canvas>
                </div>

                <div class="navigation">
                    <button class="btn-secondary" onclick="prevPage()">Back</button>
                    <button class="btn-primary" onclick="nextPage()">View Improvements</button>
                </div>
            </div>

            <!-- PAGE 10: Potential Improvements -->
            <div class="page" data-page="10">
                <h2>Potential Improvements</h2>
                <div class="page-intro">
                    <p>These are options your household might consider. Actual savings depend on many factors including installation costs, rebates, and specific circumstances.</p>
                </div>

                <div class="warning-box">
                    <p><strong>Disclaimer:</strong> The savings shown are typical estimates only. Before making changes, consult qualified professionals and consider all costs. Some improvements require significant upfront investment.</p>
                </div>

                <div id="improvementsList"></div>

                <div class="navigation">
                    <button class="btn-secondary" onclick="prevPage()">Back</button>
                    <button class="btn-primary" onclick="nextPage()">View Details</button>
                </div>
            </div>

            <!-- PAGE 11: Detailed Results -->
            <div class="page" data-page="11">
                <h2>Detailed Energy Breakdown</h2>
                <div class="page-intro">
                    <p>Expand each section to see detailed calculations for your household.</p>
                </div>

                <div class="expandable">
                    <div class="expandable-header" onclick="toggleExpand(this)">
                        <span>Heating Energy</span>
                        <span>▼</span>
                    </div>
                    <div class="expandable-content" id="heatingDetails"></div>
                </div>

                <div class="expandable">
                    <div class="expandable-header" onclick="toggleExpand(this)">
                        <span>Cooling Energy</span>
                        <span>▼</span>
                    </div>
                    <div class="expandable-content" id="coolingDetails"></div>
                </div>

                <div class="expandable">
                    <div class="expandable-header" onclick="toggleExpand(this)">
                        <span>Hot Water Energy</span>
                        <span>▼</span>
                    </div>
                    <div class="expandable-content" id="hotWaterDetails"></div>
                </div>

                <div class="expandable">
                    <div class="expandable-header" onclick="toggleExpand(this)">
                        <span>Cooking Energy</span>
                        <span>▼</span>
                    </div>
                    <div class="expandable-content" id="cookingDetails"></div>
                </div>

                <div class="expandable">
                    <div class="expandable-header" onclick="toggleExpand(this)">
                        <span>Transport Energy</span>
                        <span>▼</span>
                    </div>
                    <div class="expandable-content" id="transportDetails"></div>
                </div>

                <div class="expandable">
                    <div class="expandable-header" onclick="toggleExpand(this)">
                        <span>Solar and Renewable Energy</span>
                        <span>▼</span>
                    </div>
                    <div class="expandable-content" id="solarDetails"></div>
                </div>

                <div class="navigation">
                    <button class="btn-secondary" onclick="prevPage()">Back</button>
                    <button class="btn-primary" onclick="nextPage()">Generate Report</button>
                </div>
            </div>

            <!-- PAGE 12: Print Report -->
            <div class="page" data-page="12">
                <h2>Generate Report</h2>
                <div class="page-intro no-print">
                    <p>You can print this report or email it. The report includes all your results and comparisons.</p>
                </div>

                <div class="no-print" style="margin-bottom: 30px;">
                    <button class="btn-print" onclick="window.print()">Print Report</button>
                    <button class="btn-print" onclick="emailReport()">Email Report</button>
                </div>

                <div id="printableReport"></div>

                <div class="navigation no-print">
                    <button class="btn-secondary" onclick="prevPage()">Back</button>
                    <button class="btn-primary" onclick="nextPage()">View Calculations</button>
                </div>
            </div>

            <!-- PAGE 13: Calculation Methods -->
            <div class="page" data-page="13">
                <h2>Calculation Methods</h2>
                <div class="page-intro">
                    <p>This page explains how the audit calculates energy consumption and emissions. All calculations use Victorian data and published consumption benchmarks.</p>
                </div>

                <h3 style="color: #2E7D32; margin-top: 30px;">1. Heating Energy</h3>
                <div class="calculation-formula">
                    Heating (kWh/year) = Base_Heating × Size × Age × Usage × 
                    Ceiling_Insulation × Wall_Insulation × Double_Glazing × 
                    Draft_Sealing × Occupant_Factor
                </div>
                <p><strong>Base Heating Consumption:</strong></p>
                <ul style="margin-left: 20px; margin-bottom: 15px;">
                    <li>Gas Ducted: 18,000 kWh</li>
                    <li>Reverse Cycle: 2,500 kWh</li>
                    <li>Gas Wall: 12,000 kWh</li>
                    <li>Electric: 4,000 kWh</li>
                </ul>
                <p><strong>Size Multipliers:</strong> Small 0.6, Medium 1.0, Large 1.4, Very Large 1.8</p>
                <p><strong>Age Multipliers:</strong> Pre-1990: 1.3, 1990-2005: 1.1, 2005-2015: 0.95, Post-2015: 0.8</p>
                <p><strong>Usage Multipliers:</strong> Daily 1.0, Most days 0.75, Sometimes 0.4, Rarely 0.15</p>
                <p><strong>Insulation Multipliers:</strong> Full ceiling 0.85, Partial ceiling 0.92, Full walls 0.9, Partial walls 0.95, Double glazing most 0.92, Double glazing some 0.96, Good draft sealing 0.95</p>
                <p><strong>Occupant Factor:</strong> 0.8 + (0.05 × occupants), maximum 1.2</p>

                <h3 style="color: #2E7D32; margin-top: 30px;">2. Cooling Energy</h3>
                <div class="calculation-formula">
                    Cooling (kWh/year) = Base_Cooling × Size × Age × Usage × 
                    Ceiling_Insulation × Wall_Insulation × Double_Glazing × Draft_Sealing
                </div>
                <p><strong>Base Cooling Consumption:</strong></p>
                <ul style="margin-left: 20px; margin-bottom: 15px;">
                    <li>Ducted AC: 2,000 kWh</li>
                    <li>Split System: 1,200 kWh</li>
                    <li>Evaporative: 400 kWh</li>
                    <li>Fans: 150 kWh</li>
                </ul>
                <p><strong>Usage Multipliers:</strong> Daily 1.0, Hot days 0.5, Sometimes 0.25, Rarely 0.1</p>

                <h3 style="color: #2E7D32; margin-top: 30px;">3. Hot Water Energy</h3>
                <div class="calculation-formula">
                    Hot_Water (kWh/year) = Base × (0.4 + 0.3 × occupants) × Shower_Length
                </div>
                <p><strong>Base Hot Water Consumption:</strong></p>
                <ul style="margin-left: 20px; margin-bottom: 15px;">
                    <li>Gas Storage: 5,500 kWh</li>
                    <li>Gas Instant: 4,500 kWh</li>
                    <li>Electric Storage: 3,500 kWh</li>
                    <li>Heat Pump: 1,200 kWh</li>
                    <li>Solar Electric Boost: 800 kWh</li>
                    <li>Solar Gas Boost: 900 kWh</li>
                </ul>
                <p><strong>Shower Length Multipliers:</strong> Less than 4min: 0.7, 4-7min: 1.0, 7-10min: 1.3, More than 10min: 1.6</p>

                <h3 style="color: #2E7D32; margin-top: 30px;">4. Cooking Energy</h3>
                <div class="calculation-formula">
                    Cooktop (kWh/year) = Base_Cooktop × (0.5 + 0.15 × occupants)
                    Oven (kWh/year) = Base_Oven × (0.5 + 0.15 × occupants)
                </div>
                <p><strong>Base Cooking Consumption:</strong></p>
                <ul style="margin-left: 20px; margin-bottom: 15px;">
                    <li>Gas Cooktop: 1,500 kWh</li>
                    <li>Electric Cooktop: 550 kWh</li>
                    <li>Induction Cooktop: 350 kWh</li>
                    <li>Gas Oven: 1,200 kWh</li>
                    <li>Electric Oven: 450 kWh</li>
                </ul>

                <h3 style="color: #2E7D32; margin-top: 30px;">5. Transport Energy</h3>
                <div class="calculation-formula">
                    Vehicle (kWh/year) = Distance × Consumption_Rate × 
                    (1 - WFH_Days × 0.08) × PT_Reduction
                </div>
                <p><strong>Consumption Rates (kWh/km):</strong></p>
                <ul style="margin-left: 20px; margin-bottom: 15px;">
                    <li>Petrol: Small 0.579, Medium 0.712, Large 0.890</li>
                    <li>Diesel: Small 0.589, Medium 0.749, Large 0.963</li>
                    <li>Hybrid: Small 0.376, Medium 0.463, Large 0.579</li>
                    <li>Plug-in Hybrid: 50% electric (0.20 kWh/km) + 50% petrol (reduced rate)</li>
                    <li>Electric: 0.18 kWh/km (all sizes)</li>
                </ul>
                <p><strong>Modifiers:</strong> Work from home reduces by 8% per day. Public transport use applies 0.75 reduction factor.</p>

                <h3 style="color: #2E7D32; margin-top: 30px;">6. Solar Generation</h3>
                <div class="calculation-formula">
                    Solar_Generation: Small 5,500 kWh, Medium 9,000 kWh, Large 13,000 kWh
                    Self_Consumption: No battery 30%, Small battery 60%, Large battery 80%
                </div>

                <h3 style="color: #2E7D32; margin-top: 30px;">7. CO₂ Emissions</h3>
                <div class="calculation-formula">
                    Grid_Electricity_CO₂ = (Electricity - Solar_Self_Use) × 0.86 × (1 - GreenPower%)
                    Gas_CO₂ = Gas_kWh × 0.186
                    Petrol_CO₂ = Petrol_kWh × 0.259
                    Diesel_CO₂ = Diesel_kWh × 0.252
                </div>
                <p><strong>Emission Factors (kg CO₂/kWh):</strong></p>
                <ul style="margin-left: 20px; margin-bottom: 15px;">
                    <li>Grid Electricity: 0.86</li>
                    <li>Natural Gas: 0.186</li>
                    <li>Petrol: 0.259</li>
                    <li>Diesel: 0.252</li>
                </ul>

                <h3 style="color: #2E7D32; margin-top: 30px;">Victorian Benchmarks</h3>
                <p><strong>Average Household:</strong></p>
                <ul style="margin-left: 20px; margin-bottom: 15px;">
                    <li>Total Energy: 21,096 kWh/year</li>
                    <li>Electricity: 4,615 kWh/year</li>
                    <li>Gas: 16,481 kWh/year</li>
                    <li>CO₂: 7,500 kg/year</li>
                    <li>Per Capita: 8,100 kWh/year</li>
                </ul>

                <div class="navigation">
                    <button class="btn-secondary" onclick="prevPage()">Back</button>
                    <button class="btn-primary" onclick="nextPage()">View References</button>
                </div>
            </div>

            <!-- PAGE 14: Bibliography -->
            <div class="page" data-page="14">
                <h2>References and Data Sources</h2>
                <div class="page-intro">
                    <p>All calculations and benchmarks in this audit tool are based on Victorian government sources and published research.</p>
                </div>

                <div class="reference-item">
                    <h3>Sustainability Victoria</h3>
                    <p><strong>State of Sustainability Report 2024</strong></p>
                    <p>Victorian household energy consumption benchmarks, residential heating and cooling patterns.</p>
                    <p><a href="https://www.sustainability.vic.gov.au/" target="_blank">https://www.sustainability.vic.gov.au/</a></p>
                </div>

                <div class="reference-item">
                    <h3>Essential Services Commission Victoria</h3>
                    <p><strong>Victorian Default Offer and Energy Fact Sheets</strong></p>
                    <p>CO₂ emission factors for Victorian grid electricity (0.86 kg CO₂/kWh), natural gas consumption data.</p>
                    <p><a href="https://www.esc.vic.gov.au/" target="_blank">https://www.esc.vic.gov.au/</a></p>
                </div>

                <div class="reference-item">
                    <h3>Australian Energy Regulator</h3>
                    <p><strong>Residential Energy Consumption Benchmarks</strong></p>
                    <p>National and state-level energy consumption patterns, appliance usage data.</p>
                    <p><a href="https://www.aer.gov.au/" target="_blank">https://www.aer.gov.au/</a></p>
                </div>

                <div class="reference-item">
                    <h3>Department of Energy, Environment and Climate Action (DEECA)</h3>
                    <p><strong>Victorian Energy Efficiency Programs</strong></p>
                    <p>Building efficiency standards, insulation requirements, solar panel performance data.</p>
                    <p><a href="https://www.energy.vic.gov.au/" target="_blank">https://www.energy.vic.gov.au/</a></p>
                </div>

                <div class="reference-item">
                    <h3>Australian Bureau of Statistics</h3>
                    <p><strong>Transport Census 2021</strong></p>
                    <p>Victorian household vehicle ownership, average annual kilometers traveled.</p>
                    <p><a href="https://www.abs.gov.au/" target="_blank">https://www.abs.gov.au/</a></p>
                </div>

                <div class="reference-item">
                    <h3>RACV</h3>
                    <p><strong>Real-World Vehicle Fuel Consumption Data</strong></p>
                    <p>Actual fuel consumption rates for common vehicles in Australian conditions.</p>
                    <p><a href="https://www.racv.com.au/" target="_blank">https://www.racv.com.au/</a></p>
                </div>

                <div class="reference-item">
                    <h3>Clean Energy Council</h3>
                    <p><strong>Solar Panel Performance Data</strong></p>
                    <p>Average solar generation rates for Victorian installations, battery storage efficiency.</p>
                    <p><a href="https://www.cleanenergycouncil.org.au/" target="_blank">https://www.cleanenergycouncil.org.au/</a></p>
                </div>

                <div class="reference-item">
                    <h3>National Greenhouse and Energy Reporting</h3>
                    <p><strong>Emission Factors</strong></p>
                    <p>Official CO₂ emission factors for electricity, natural gas, petrol, and diesel.</p>
                    <p><a href="https://www.dcceew.gov.au/" target="_blank">https://www.dcceew.gov.au/</a></p>
                </div>

                <div class="info-box" style="margin-top: 30px;">
                    <p><strong>Educational Use:</strong> This tool is designed for Year 8 students in Victoria as an educational resource. While calculations use published data sources, results are estimates and should not be used for commercial energy audits or professional assessments.</p>
                </div>

                <div class="navigation">
                    <button class="btn-secondary" onclick="prevPage()">Back</button>
                    <button class="btn-primary" onclick="goToPage(1)">Start New Audit</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data structure
        let auditData = {
            studentName: '',
            postcode: '',
            dwellingType: '',
            occupants: 3,
            floorArea: '',
            buildingAge: '',
            heatingType: '',
            heatingUsage: '',
            coolingType: '',
            coolingUsage: '',
            hotWaterType: '',
            showerLength: '',
            cooktopType: '',
            ovenType: '',
            vehicles: [],
            alternativeTransport: {
                ebike: false,
                publicTransport: false,
                bicycle: false,
                walking: false
            },
            wfhDays: 0,
            insulation: {
                ceilingInsulation: 'none',
                wallInsulation: 'none',
                doubleGlazing: 'none',
                draftSealing: 'poor'
            },
            features: {
                swimmingPool: false,
                poolHeating: false,
                spa: false,
                workshop: false
            },
            solarPV: 'none',
            battery: 'none',
            greenPower: 0,
            behaviors: {
                lightsOff: 2,
                standbyOff: 1,
                coldWashing: 2,
                airDry: 2,
                closeCurtains: 2,
                thermostat: 1
            },
            energyEfforts: ''
        };

        let results = {};
        let currentPage = 1;

        // Load data on page load
        window.addEventListener('DOMContentLoaded', function() {
            loadData();
            initializeEventListeners();
            renderVehicles();
            updateSliderLabels();
        });

        function initializeEventListeners() {
            // Text inputs
            document.getElementById('studentName').addEventListener('input', function() {
                auditData.studentName = this.value;
                saveData();
            });

            document.getElementById('postcode').addEventListener('input', function() {
                auditData.postcode = this.value;
                saveData();
            });

            // Radio buttons
            document.querySelectorAll('input[name="dwellingType"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    auditData.dwellingType = this.value;
                    saveData();
                });
            });

            // Number inputs
            document.getElementById('occupants').addEventListener('input', function() {
                auditData.occupants = parseInt(this.value) || 3;
                saveData();
            });

            document.getElementById('wfhDays').addEventListener('input', function() {
                auditData.wfhDays = parseInt(this.value) || 0;
                saveData();
            });

            // Select inputs
            const selectIds = ['floorArea', 'buildingAge', 'heatingType', 'heatingUsage', 
                'coolingType', 'coolingUsage', 'hotWaterType', 'showerLength', 
                'cooktopType', 'ovenType', 'ceilingInsulation', 'wallInsulation', 
                'doubleGlazing', 'draftSealing', 'solarPV', 'battery', 'greenPower'];
            
            selectIds.forEach(id => {
                const element = document.getElementById(id);
                if (element) {
                    element.addEventListener('change', function() {
                        if (id === 'ceilingInsulation' || id === 'wallInsulation' || 
                            id === 'doubleGlazing' || id === 'draftSealing') {
                            auditData.insulation[id] = this.value;
                        } else if (id === 'greenPower') {
                            auditData.greenPower = parseInt(this.value) || 0;
                        } else {
                            auditData[id] = this.value;
                        }
                        saveData();
                    });
                }
            });

            // Checkboxes for alternative transport
            ['ebike', 'publicTransport', 'bicycle', 'walking'].forEach(id => {
                document.getElementById(id).addEventListener('change', function() {
                    auditData.alternativeTransport[id] = this.checked;
                    saveData();
                });
            });

            // Checkboxes for features
            document.getElementById('swimmingPool').addEventListener('change', function() {
                auditData.features.swimmingPool = this.checked;
                saveData();
            });

            document.getElementById('poolHeatingCheck').addEventListener('change', function() {
                auditData.features.poolHeating = this.checked;
                saveData();
            });

            document.getElementById('spa').addEventListener('change', function() {
                auditData.features.spa = this.checked;
                saveData();
            });

            document.getElementById('workshop').addEventListener('change', function() {
                auditData.features.workshop = this.checked;
                saveData();
            });

            // Sliders
            ['lightsOff', 'standbyOff', 'coldWashing', 'airDry', 'closeCurtains', 'thermostat'].forEach(id => {
                document.getElementById(id).addEventListener('input', function() {
                    auditData.behaviors[id] = parseInt(this.value);
                    saveData();
                });
            });

            // Textarea
            document.getElementById('energyEfforts').addEventListener('input', function() {
                auditData.energyEfforts = this.value;
                saveData();
            });
        }

        function saveData() {
            try {
                localStorage.setItem('victorianEnergyAudit', JSON.stringify(auditData));
                showSaveIndicator();
            } catch (e) {
                console.error('Error saving data:', e);
            }
        }

        function loadData() {
            try {
                const saved = localStorage.getItem('victorianEnergyAudit');
                if (saved) {
                    auditData = JSON.parse(saved);
                    populateForm();
                }
            } catch (e) {
                console.error('Error loading data:', e);
            }
        }

        function populateForm() {
            // Text inputs
            if (auditData.studentName) document.getElementById('studentName').value = auditData.studentName;
            if (auditData.postcode) document.getElementById('postcode').value = auditData.postcode;
            
            // Radio buttons
            if (auditData.dwellingType) {
                const radio = document.querySelector(`input[name="dwellingType"][value="${auditData.dwellingType}"]`);
                if (radio) radio.checked = true;
            }

            // Numbers
            document.getElementById('occupants').value = auditData.occupants;
            document.getElementById('wfhDays').value = auditData.wfhDays;

            // Selects
            const selectMapping = {
                floorArea: auditData.floorArea,
                buildingAge: auditData.buildingAge,
                heatingType: auditData.heatingType,
                heatingUsage: auditData.heatingUsage,
                coolingType: auditData.coolingType,
                coolingUsage: auditData.coolingUsage,
                hotWaterType: auditData.hotWaterType,
                showerLength: auditData.showerLength,
                cooktopType: auditData.cooktopType,
                ovenType: auditData.ovenType,
                ceilingInsulation: auditData.insulation.ceilingInsulation,
                wallInsulation: auditData.insulation.wallInsulation,
                doubleGlazing: auditData.insulation.doubleGlazing,
                draftSealing: auditData.insulation.draftSealing,
                solarPV: auditData.solarPV,
                battery: auditData.battery,
                greenPower: auditData.greenPower
            };

            Object.keys(selectMapping).forEach(id => {
                const element = document.getElementById(id);
                if (element && selectMapping[id]) {
                    element.value = selectMapping[id];
                }
            });

            // Checkboxes
            Object.keys(auditData.alternativeTransport).forEach(key => {
                const element = document.getElementById(key);
                if (element) element.checked = auditData.alternativeTransport[key];
            });

            document.getElementById('swimmingPool').checked = auditData.features.swimmingPool;
            document.getElementById('poolHeatingCheck').checked = auditData.features.poolHeating;
            document.getElementById('spa').checked = auditData.features.spa;
            document.getElementById('workshop').checked = auditData.features.workshop;

            // Sliders
            Object.keys(auditData.behaviors).forEach(key => {
                const element = document.getElementById(key);
                if (element) {
                    element.value = auditData.behaviors[key];
                    updateSlider(key);
                }
            });

            // Textarea
            if (auditData.energyEfforts) {
                document.getElementById('energyEfforts').value = auditData.energyEfforts;
            }
        }

        function showSaveIndicator() {
            const indicator = document.getElementById('saveIndicator');
            indicator.classList.add('show');
            setTimeout(() => {
                indicator.classList.remove('show');
            }, 2000);
        }

        // Vehicle management
        function addVehicle() {
            const vehicle = {
                name: '',
                type: '',
                size: '',
                km: 0
            };
            auditData.vehicles.push(vehicle);
            saveData();
            renderVehicles();
        }

        function removeVehicle(index) {
            auditData.vehicles.splice(index, 1);
            saveData();
            renderVehicles();
        }

        function renderVehicles() {
            const container = document.getElementById('vehicleList');
            if (!container) return;

            if (auditData.vehicles.length === 0) {
                container.innerHTML = '<p style="color: #666;">No vehicles added yet. Click "Add Vehicle" to begin.</p>';
                return;
            }

            container.innerHTML = auditData.vehicles.map((vehicle, index) => `
                <div class="vehicle-item">
                    <button class="remove-vehicle" onclick="removeVehicle(${index})">Remove</button>
                    <h4>Vehicle ${index + 1}</h4>
                    <div class="form-group">
                        <label>Vehicle Name (e.g., "Mum's car", "Family car")</label>
                        <input type="text" value="${vehicle.name || ''}" 
                            onchange="updateVehicle(${index}, 'name', this.value)">
                    </div>
                    <div class="form-group">
                        <label>Vehicle Type</label>
                        <select onchange="updateVehicle(${index}, 'type', this.value)">
                            <option value="">Select type</option>
                            <option value="petrol" ${vehicle.type === 'petrol' ? 'selected' : ''}>Petrol</option>
                            <option value="diesel" ${vehicle.type === 'diesel' ? 'selected' : ''}>Diesel</option>
                            <option value="hybrid" ${vehicle.type === 'hybrid' ? 'selected' : ''}>Hybrid (no plug-in)</option>
                            <option value="plugin-hybrid" ${vehicle.type === 'plugin-hybrid' ? 'selected' : ''}>Plug-in Hybrid (PHEV)</option>
                            <option value="electric" ${vehicle.type === 'electric' ? 'selected' : ''}>Electric (EV)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Vehicle Size</label>
                        <select onchange="updateVehicle(${index}, 'size', this.value)">
                            <option value="">Select size</option>
                            <option value="small" ${vehicle.size === 'small' ? 'selected' : ''}>Small (e.g., Mazda 2, Toyota Yaris)</option>
                            <option value="medium" ${vehicle.size === 'medium' ? 'selected' : ''}>Medium (e.g., Toyota Camry, Mazda CX-5)</option>
                            <option value="large" ${vehicle.size === 'large' ? 'selected' : ''}>Large (e.g., Ford Ranger, LandCruiser)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Annual Kilometers</label>
                        <input type="number" value="${vehicle.km || 0}" min="0" 
                            onchange="updateVehicle(${index}, 'km', parseInt(this.value))">
                    </div>
                </div>
            `).join('');
        }

        function updateVehicle(index, field, value) {
            auditData.vehicles[index][field] = value;
            saveData();
        }

        // Slider updates
        function updateSlider(sliderId) {
            const value = parseInt(document.getElementById(sliderId).value);
            const labels = ['Never', 'Rarely', 'Sometimes', 'Always'];
            document.getElementById(sliderId + 'Value').textContent = labels[value];
        }

        function updateSliderLabels() {
            ['lightsOff', 'standbyOff', 'coldWashing', 'airDry', 'closeCurtains', 'thermostat'].forEach(updateSlider);
        }

        // Navigation
        function nextPage() {
            if (currentPage < 14) {
                goToPage(currentPage + 1);
            }
        }

        function prevPage() {
            if (currentPage > 1) {
                goToPage(currentPage - 1);
            }
        }

        function goToPage(pageNum) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            const targetPage = document.querySelector(`[data-page="${pageNum}"]`);
            if (targetPage) {
                targetPage.classList.add('active');
                currentPage = pageNum;
                document.getElementById('currentPage').textContent = currentPage;
                window.scrollTo(0, 0);
            }
        }

        // Calculations
        function calculateResults() {
            results = {
                electricity: 0,
                gas: 0,
                transportPetrol: 0,
                transportDiesel: 0,
                transportElectric: 0,
                solarGeneration: 0,
                solarSelfUse: 0,
                co2: 0,
                breakdown: {}
            };

            calculateHeating();
            calculateCooling();
            calculateHotWater();
            calculateCooking();
            calculateAppliances();
            calculateTransport();
            calculateSolar();
            calculateCO2();

            goToPage(9);
            displayResults();
        }

        function getMultiplier(category, value) {
            const multipliers = {
                size: {
                    'small': 0.6,
                    'medium': 1.0,
                    'large': 1.4,
                    'very-large': 1.8
                },
                age: {
                    'pre-1990': 1.3,
                    '1990-2005': 1.1,
                    '2005-2015': 0.95,
                    'post-2015': 0.8
                },
                heatingUsage: {
                    'daily': 1.0,
                    'most-days': 0.75,
                    'sometimes': 0.4,
                    'rarely': 0.15
                },
                coolingUsage: {
                    'daily': 1.0,
                    'hot-days': 0.5,
                    'sometimes': 0.25,
                    'rarely': 0.1
                },
                showerLength: {
                    'short': 0.7,
                    'medium': 1.0,
                    'long': 1.3,
                    'very-long': 1.6
                },
                ceilingInsulation: {
                    'none': 1.0,
                    'partial': 0.92,
                    'full': 0.85
                },
                wallInsulation: {
                    'none': 1.0,
                    'partial': 0.95,
                    'full': 0.9
                },
                doubleGlazing: {
                    'none': 1.0,
                    'some': 0.96,
                    'most': 0.92
                },
                draftSealing: {
                    'poor': 1.0,
                    'good': 0.95
                }
            };

            return multipliers[category]?.[value] || 1.0;
        }

        function calculateHeating() {
            const baseHeating = {
                'gas-ducted': 18000,
                'reverse-cycle': 2500,
                'gas-wall': 12000,
                'electric': 4000,
                'none': 0
            };

            const base = baseHeating[auditData.heatingType] || 0;
            const size = getMultiplier('size', auditData.floorArea);
            const age = getMultiplier('age', auditData.buildingAge);
            const usage = getMultiplier('heatingUsage', auditData.heatingUsage);
            const ceiling = getMultiplier('ceilingInsulation', auditData.insulation.ceilingInsulation);
            const walls = getMultiplier('wallInsulation', auditData.insulation.wallInsulation);
            const glazing = getMultiplier('doubleGlazing', auditData.insulation.doubleGlazing);
            const draft = getMultiplier('draftSealing', auditData.insulation.draftSealing);
            const occupantFactor = Math.min(0.8 + (0.05 * auditData.occupants), 1.2);

            const heating = base * size * age * usage * ceiling * walls * glazing * draft * occupantFactor;

            results.breakdown.heating = heating;

            if (auditData.heatingType === 'gas-ducted' || auditData.heatingType === 'gas-wall') {
                results.gas += heating;
            } else {
                results.electricity += heating;
            }
        }

        function calculateCooling() {
            const baseCooling = {
                'ducted-ac': 2000,
                'split-system': 1200,
                'evaporative': 400,
                'fans': 150,
                'none': 0
            };

            const base = baseCooling[auditData.coolingType] || 0;
            const size = getMultiplier('size', auditData.floorArea);
            const age = getMultiplier('age', auditData.buildingAge);
            const usage = getMultiplier('coolingUsage', auditData.coolingUsage);
            const ceiling = getMultiplier('ceilingInsulation', auditData.insulation.ceilingInsulation);
            const walls = getMultiplier('wallInsulation', auditData.insulation.wallInsulation);
            const glazing = getMultiplier('doubleGlazing', auditData.insulation.doubleGlazing);
            const draft = getMultiplier('draftSealing', auditData.insulation.draftSealing);

            const cooling = base * size * age * usage * ceiling * walls * glazing * draft;

            results.breakdown.cooling = cooling;
            results.electricity += cooling;
        }

        function calculateHotWater() {
            const baseHotWater = {
                'gas-storage': 5500,
                'gas-instant': 4500,
                'electric-storage': 3500,
                'heat-pump': 1200,
                'solar-electric': 800,
                'solar-gas': 900
            };

            const base = baseHotWater[auditData.hotWaterType] || 0;
            const occupantFactor = 0.4 + (0.3 * auditData.occupants);
            const showerFactor = getMultiplier('showerLength', auditData.showerLength);

            const hotWater = base * occupantFactor * showerFactor;

            results.breakdown.hotWater = hotWater;

            if (auditData.hotWaterType === 'gas-storage' || auditData.hotWaterType === 'gas-instant' || 
                auditData.hotWaterType === 'solar-gas') {
                results.gas += hotWater;
            } else {
                results.electricity += hotWater;
            }
        }

        function calculateCooking() {
            const baseCooktop = {
                'gas': 1500,
                'electric': 550,
                'induction': 350,
                'none': 0
            };

            const baseOven = {
                'gas': 1200,
                'electric': 450,
                'none': 0
            };

            const cookingFactor = 0.5 + (0.15 * auditData.occupants);

            const cooktop = (baseCooktop[auditData.cooktopType] || 0) * cookingFactor;
            const oven = (baseOven[auditData.ovenType] || 0) * cookingFactor;

            results.breakdown.cooktop = cooktop;
            results.breakdown.oven = oven;

            if (auditData.cooktopType === 'gas') {
                results.gas += cooktop;
            } else {
                results.electricity += cooktop;
            }

            if (auditData.ovenType === 'gas') {
                results.gas += oven;
            } else {
                results.electricity += oven;
            }
        }

        function calculateAppliances() {
            let baseLoad = 1500; // Reduced from 2200

            if (auditData.features.swimmingPool) {
                results.electricity += 10000;
                baseLoad += 10000;
            }

            if (auditData.features.poolHeating) {
                results.gas += 15000;
            }

            if (auditData.features.spa) {
                results.electricity += 2500;
                baseLoad += 2500;
            }

            if (auditData.features.workshop) {
                results.electricity += 1500;
                baseLoad += 1500;
            }

            results.breakdown.baseLoad = baseLoad;
            results.electricity += 1500; // Base appliances
        }

        function calculateTransport() {
            const consumptionRates = {
                petrol: { small: 0.579, medium: 0.712, large: 0.890 },
                diesel: { small: 0.589, medium: 0.749, large: 0.963 },
                hybrid: { small: 0.376, medium: 0.463, large: 0.579 },
                electric: 0.18
            };

            const wfhReduction = 1 - (auditData.wfhDays * 0.08);
            const ptReduction = auditData.alternativeTransport.publicTransport ? 0.75 : 1.0;

            results.breakdown.vehicles = [];

            auditData.vehicles.forEach(vehicle => {
                let energy = 0;
                let electricPortion = 0;
                let petrolPortion = 0;

                if (vehicle.type === 'electric') {
                    energy = vehicle.km * consumptionRates.electric * wfhReduction * ptReduction;
                    results.transportElectric += energy;
                    results.electricity += energy;
                } else if (vehicle.type === 'plugin-hybrid') {
                    // 50% electric, 50% petrol
                    const electricDistance = vehicle.km * 0.5;
                    const petrolDistance = vehicle.km * 0.5;
                    
                    electricPortion = electricDistance * 0.20 * wfhReduction * ptReduction;
                    petrolPortion = petrolDistance * consumptionRates.petrol[vehicle.size] * 0.65 * wfhReduction * ptReduction;
                    
                    results.transportElectric += electricPortion;
                    results.electricity += electricPortion;
                    results.transportPetrol += petrolPortion;
                    energy = electricPortion + petrolPortion;
                } else if (vehicle.type === 'hybrid') {
                    energy = vehicle.km * consumptionRates.hybrid[vehicle.size] * wfhReduction * ptReduction;
                    results.transportPetrol += energy;
                } else if (vehicle.type === 'petrol') {
                    energy = vehicle.km * consumptionRates.petrol[vehicle.size] * wfhReduction * ptReduction;
                    results.transportPetrol += energy;
                } else if (vehicle.type === 'diesel') {
                    energy = vehicle.km * consumptionRates.diesel[vehicle.size] * wfhReduction * ptReduction;
                    results.transportDiesel += energy;
                }

                results.breakdown.vehicles.push({
                    name: vehicle.name || `Vehicle ${auditData.vehicles.indexOf(vehicle) + 1}`,
                    type: vehicle.type,
                    energy: energy
                });
            });
        }

        function calculateSolar() {
            const solarGeneration = {
                'none': 0,
                'small': 5500,
                'medium': 9000,
                'large': 13000
            };

            const selfConsumption = {
                'none': 0.3,
                'small': 0.6,
                'large': 0.8
            };

            results.solarGeneration = solarGeneration[auditData.solarPV] || 0;
            const consumptionRate = selfConsumption[auditData.battery] || 0.3;
            results.solarSelfUse = results.solarGeneration * consumptionRate;
        }

        function calculateCO2() {
            const gridElectricity = Math.max(0, results.electricity - results.solarSelfUse);
            const greenPowerFactor = 1 - (auditData.greenPower / 100);

            const electricityCO2 = gridElectricity * 0.86 * greenPowerFactor;
            const gasCO2 = results.gas * 0.186;
            const petrolCO2 = results.transportPetrol * 0.259;
            const dieselCO2 = results.transportDiesel * 0.252;

            results.co2 = electricityCO2 + gasCO2 + petrolCO2 + dieselCO2;
        }

        function displayResults() {
            // Summary cards
            const totalEnergy = results.electricity + results.gas + results.transportPetrol + results.transportDiesel;
            const perCapita = totalEnergy / auditData.occupants;

            document.getElementById('resultsSummary').innerHTML = `
                <div class="result-card">
                    <div class="result-label">Total Energy</div>
                    <div class="result-value">${Math.round(totalEnergy).toLocaleString()}</div>
                    <div class="result-label">kWh/year</div>
                </div>
                <div class="result-card electricity">
                    <div class="result-label">Electricity</div>
                    <div class="result-value">${Math.round(results.electricity).toLocaleString()}</div>
                    <div class="result-label">kWh/year</div>
                </div>
                <div class="result-card gas">
                    <div class="result-label">Natural Gas</div>
                    <div class="result-value">${Math.round(results.gas).toLocaleString()}</div>
                    <div class="result-label">kWh/year</div>
                </div>
                <div class="result-card transport">
                    <div class="result-label">Transport</div>
                    <div class="result-value">${Math.round(results.transportPetrol + results.transportDiesel).toLocaleString()}</div>
                    <div class="result-label">kWh/year</div>
                </div>
                <div class="result-card co2">
                    <div class="result-label">CO₂ Emissions</div>
                    <div class="result-value">${Math.round(results.co2).toLocaleString()}</div>
                    <div class="result-label">kg/year</div>
                </div>
                <div class="result-card">
                    <div class="result-label">Per Person</div>
                    <div class="result-value">${Math.round(perCapita).toLocaleString()}</div>
                    <div class="result-label">kWh/year</div>
                </div>
            `;

            // Charts
            createEnergyChart();
            createBreakdownChart();
            createCategoryComparisonChart();
            createComparisonTable();
            createImprovementsList();
            createDetailedBreakdowns();
            createPrintableReport();
        }

        function createEnergyChart() {
            const ctx = document.getElementById('energyChart');
            if (window.energyChartInstance) {
                window.energyChartInstance.destroy();
            }

            window.energyChartInstance = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['Electricity', 'Natural Gas', 'Transport'],
                    datasets: [{
                        data: [
                            results.electricity,
                            results.gas,
                            results.transportPetrol + results.transportDiesel
                        ],
                        backgroundColor: ['#1976D2', '#FF6B35', '#7B1FA2']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Energy Use by Fuel Type',
                            font: { size: 16 }
                        },
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function createBreakdownChart() {
            const ctx = document.getElementById('breakdownChart');
            if (window.breakdownChartInstance) {
                window.breakdownChartInstance.destroy();
            }

            const labels = [];
            const data = [];

            if (results.breakdown.heating > 0) {
                labels.push('Heating');
                data.push(results.breakdown.heating);
            }
            if (results.breakdown.cooling > 0) {
                labels.push('Cooling');
                data.push(results.breakdown.cooling);
            }
            if (results.breakdown.hotWater > 0) {
                labels.push('Hot Water');
                data.push(results.breakdown.hotWater);
            }
            if ((results.breakdown.cooktop || 0) + (results.breakdown.oven || 0) > 0) {
                labels.push('Cooking');
                data.push((results.breakdown.cooktop || 0) + (results.breakdown.oven || 0));
            }
            if (results.transportPetrol + results.transportDiesel > 0) {
                labels.push('Transport');
                data.push(results.transportPetrol + results.transportDiesel);
            }
            if (results.breakdown.baseLoad > 0) {
                labels.push('Appliances');
                data.push(results.breakdown.baseLoad);
            }

            window.breakdownChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Energy Use (kWh/year)',
                        data: data,
                        backgroundColor: '#2E7D32'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Energy Use by Category',
                            font: { size: 16 }
                        },
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        function createCategoryComparisonChart() {
            const ctx = document.getElementById('categoryComparisonChart');
            if (window.categoryComparisonChartInstance) {
                window.categoryComparisonChartInstance.destroy();
            }

            // Victorian average category breakdown (kWh/year)
            const victorianAverages = {
                heating: 10000,
                cooling: 800,
                hotWater: 5000,
                cooking: 1500,
                transport: 10700,
                appliances: 3500
            };

            // User's data
            const userData = {
                heating: results.breakdown.heating || 0,
                cooling: results.breakdown.cooling || 0,
                hotWater: results.breakdown.hotWater || 0,
                cooking: (results.breakdown.cooktop || 0) + (results.breakdown.oven || 0),
                transport: results.transportPetrol + results.transportDiesel + results.transportElectric,
                appliances: results.breakdown.baseLoad || 0
            };

            window.categoryComparisonChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Heating', 'Cooling', 'Hot Water', 'Cooking', 'Transport', 'Appliances'],
                    datasets: [{
                        label: 'Your Household',
                        data: [
                            userData.heating,
                            userData.cooling,
                            userData.hotWater,
                            userData.cooking,
                            userData.transport,
                            userData.appliances
                        ],
                        backgroundColor: '#2E7D32'
                    }, {
                        label: 'Victorian Average',
                        data: [
                            victorianAverages.heating,
                            victorianAverages.cooling,
                            victorianAverages.hotWater,
                            victorianAverages.cooking,
                            victorianAverages.transport,
                            victorianAverages.appliances
                        ],
                        backgroundColor: '#757575'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Your Household vs Victorian Average by Category',
                            font: { size: 16 }
                        },
                        legend: {
                            position: 'bottom'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Energy Use (kWh/year)'
                            }
                        }
                    }
                }
            });
        }

        function createComparisonTable() {
            const totalEnergy = results.electricity + results.gas + results.transportPetrol + results.transportDiesel;
            const perCapita = totalEnergy / auditData.occupants;
            const transport = results.transportPetrol + results.transportDiesel;

            const benchmarks = {
                totalEnergy: 21096,
                electricity: 4615,
                gas: 16481,
                transport: 10700,
                co2: 7500,
                perCapita: 8100
            };

            const rows = [
                ['Total Energy', totalEnergy, benchmarks.totalEnergy],
                ['Electricity', results.electricity, benchmarks.electricity],
                ['Natural Gas', results.gas, benchmarks.gas],
                ['Transport', transport, benchmarks.transport],
                ['CO₂ Emissions', results.co2, benchmarks.co2],
                ['Per Person', perCapita, benchmarks.perCapita]
            ];

            document.getElementById('comparisonTable').innerHTML = rows.map(row => {
                const diff = row[1] - row[2];
                const diffPercent = ((diff / row[2]) * 100).toFixed(0);
                const diffText = diff > 0 ? 
                    `+${Math.round(diff).toLocaleString()} (${diffPercent}% above average)` :
                    `${Math.round(diff).toLocaleString()} (${Math.abs(diffPercent)}% below average)`;
                
                return `
                    <tr>
                        <td><strong>${row[0]}</strong></td>
                        <td>${Math.round(row[1]).toLocaleString()} ${row[0].includes('CO₂') ? 'kg' : 'kWh'}</td>
                        <td>${Math.round(row[2]).toLocaleString()} ${row[0].includes('CO₂') ? 'kg' : 'kWh'}</td>
                        <td>${diffText}</td>
                    </tr>
                `;
            }).join('');
        }

        function createImprovementsList() {
            const improvements = [];

            // Heating improvements
            if (results.breakdown.heating > 5000 && auditData.insulation.ceilingInsulation === 'none') {
                improvements.push({
                    title: 'Add Ceiling Insulation',
                    description: 'Full ceiling insulation could reduce heating energy by approximately 15%.',
                    savings: Math.round(results.breakdown.heating * 0.15),
                    type: 'kWh/year'
                });
            }

            // Hot water improvements
            if (auditData.hotWaterType === 'electric-storage' && results.breakdown.hotWater > 2000) {
                improvements.push({
                    title: 'Consider Heat Pump Hot Water',
                    description: 'Heat pump systems use approximately 65% less energy than electric storage systems.',
                    savings: Math.round(results.breakdown.hotWater * 0.65),
                    type: 'kWh/year'
                });
            }

            // Solar improvements
            if (auditData.solarPV === 'none' && results.electricity > 3000) {
                improvements.push({
                    title: 'Install Solar Panels',
                    description: 'A typical 5kW solar system could provide approximately 5,500 kWh per year. With 30% self-consumption, this could offset 1,650 kWh of your electricity use.',
                    savings: 1650,
                    type: 'kWh/year'
                });
            }

            // Transport improvements
            if (results.transportPetrol + results.transportDiesel > 8000) {
                improvements.push({
                    title: 'Reduce Vehicle Travel',
                    description: 'Reducing vehicle kilometers by 20% through public transport, cycling, or combining trips could save significant energy. One less 10km trip per week saves approximately 890 kWh per year.',
                    savings: 890,
                    type: 'kWh/year'
                });
            }

            if (improvements.length === 0) {
                document.getElementById('improvementsList').innerHTML = `
                    <div class="info-box">
                        <p>Your household is already using energy efficiently in most areas. Continue with your current practices and consider minor optimizations where possible.</p>
                    </div>
                `;
            } else {
                document.getElementById('improvementsList').innerHTML = improvements.map(imp => `
                    <div class="improvement-item">
                        <h3>${imp.title}</h3>
                        <p>${imp.description}</p>
                        <div class="savings">Potential savings: ${imp.savings.toLocaleString()} ${imp.type}</div>
                    </div>
                `).join('');
            }
        }

        function createDetailedBreakdowns() {
            // Heating details
            document.getElementById('heatingDetails').innerHTML = `
                <p><strong>Heating Type:</strong> ${auditData.heatingType || 'Not specified'}</p>
                <p><strong>Usage:</strong> ${auditData.heatingUsage || 'Not specified'}</p>
                <p><strong>Annual Energy:</strong> ${Math.round(results.breakdown.heating || 0).toLocaleString()} kWh</p>
                <p><strong>Fuel Type:</strong> ${(auditData.heatingType === 'gas-ducted' || auditData.heatingType === 'gas-wall') ? 'Natural Gas' : 'Electricity'}</p>
            `;

            // Cooling details
            document.getElementById('coolingDetails').innerHTML = `
                <p><strong>Cooling Type:</strong> ${auditData.coolingType || 'Not specified'}</p>
                <p><strong>Usage:</strong> ${auditData.coolingUsage || 'Not specified'}</p>
                <p><strong>Annual Energy:</strong> ${Math.round(results.breakdown.cooling || 0).toLocaleString()} kWh (Electricity)</p>
            `;

            // Hot water details
            document.getElementById('hotWaterDetails').innerHTML = `
                <p><strong>System Type:</strong> ${auditData.hotWaterType || 'Not specified'}</p>
                <p><strong>Shower Length:</strong> ${auditData.showerLength || 'Not specified'}</p>
                <p><strong>Annual Energy:</strong> ${Math.round(results.breakdown.hotWater || 0).toLocaleString()} kWh</p>
            `;

            // Cooking details
            document.getElementById('cookingDetails').innerHTML = `
                <p><strong>Cooktop:</strong> ${auditData.cooktopType || 'Not specified'} - ${Math.round(results.breakdown.cooktop || 0).toLocaleString()} kWh</p>
                <p><strong>Oven:</strong> ${auditData.ovenType || 'Not specified'} - ${Math.round(results.breakdown.oven || 0).toLocaleString()} kWh</p>
                <p><strong>Total Cooking Energy:</strong> ${Math.round((results.breakdown.cooktop || 0) + (results.breakdown.oven || 0)).toLocaleString()} kWh</p>
            `;

            // Transport details
            const transportHTML = results.breakdown.vehicles.length > 0 ?
                results.breakdown.vehicles.map(v => `
                    <p><strong>${v.name}:</strong> ${v.type} - ${Math.round(v.energy).toLocaleString()} kWh</p>
                `).join('') :
                '<p>No vehicles recorded</p>';

            document.getElementById('transportDetails').innerHTML = `
                ${transportHTML}
                <p><strong>Total Transport:</strong> ${Math.round(results.transportPetrol + results.transportDiesel + results.transportElectric).toLocaleString()} kWh</p>
                <p><strong>Work from Home Days:</strong> ${auditData.wfhDays} days per week</p>
            `;

            // Solar details
            document.getElementById('solarDetails').innerHTML = `
                <p><strong>Solar System:</strong> ${auditData.solarPV || 'None'}</p>
                <p><strong>Annual Generation:</strong> ${Math.round(results.solarGeneration).toLocaleString()} kWh</p>
                <p><strong>Self-Consumption:</strong> ${Math.round(results.solarSelfUse).toLocaleString()} kWh</p>
                <p><strong>Battery:</strong> ${auditData.battery || 'None'}</p>
                <p><strong>GreenPower:</strong> ${auditData.greenPower}%</p>
            `;
        }

        function createPrintableReport() {
            const totalEnergy = results.electricity + results.gas + results.transportPetrol + results.transportDiesel;
            
            // Victorian average category breakdown
            const victorianAverages = {
                heating: 10000,
                cooling: 800,
                hotWater: 5000,
                cooking: 1500,
                transport: 10700,
                appliances: 3500
            };

            const userData = {
                heating: results.breakdown.heating || 0,
                cooling: results.breakdown.cooling || 0,
                hotWater: results.breakdown.hotWater || 0,
                cooking: (results.breakdown.cooktop || 0) + (results.breakdown.oven || 0),
                transport: results.transportPetrol + results.transportDiesel + results.transportElectric,
                appliances: results.breakdown.baseLoad || 0
            };
            
            document.getElementById('printableReport').innerHTML = `
                <h2>Household Energy Audit Report</h2>
                <p><strong>Student:</strong> ${auditData.studentName || 'Not provided'}</p>
                <p><strong>Postcode:</strong> ${auditData.postcode || 'Not provided'}</p>
                <p><strong>Date:</strong> ${new Date().toLocaleDateString('en-AU')}</p>
                
                <h3 style="margin-top: 30px;">Summary</h3>
                <table class="comparison-table">
                    <tr>
                        <td><strong>Total Energy Use</strong></td>
                        <td>${Math.round(totalEnergy).toLocaleString()} kWh/year</td>
                    </tr>
                    <tr>
                        <td><strong>Electricity</strong></td>
                        <td>${Math.round(results.electricity).toLocaleString()} kWh/year</td>
                    </tr>
                    <tr>
                        <td><strong>Natural Gas</strong></td>
                        <td>${Math.round(results.gas).toLocaleString()} kWh/year</td>
                    </tr>
                    <tr>
                        <td><strong>Transport</strong></td>
                        <td>${Math.round(results.transportPetrol + results.transportDiesel).toLocaleString()} kWh/year</td>
                    </tr>
                    <tr>
                        <td><strong>CO₂ Emissions</strong></td>
                        <td>${Math.round(results.co2).toLocaleString()} kg/year</td>
                    </tr>
                </table>

                <h3 style="margin-top: 30px;">Household Details</h3>
                <p><strong>Dwelling Type:</strong> ${auditData.dwellingType || 'Not specified'}</p>
                <p><strong>Occupants:</strong> ${auditData.occupants}</p>
                <p><strong>Floor Area:</strong> ${auditData.floorArea || 'Not specified'}</p>
                <p><strong>Building Age:</strong> ${auditData.buildingAge || 'Not specified'}</p>

                <h3 style="margin-top: 30px;">Energy Breakdown</h3>
                <table class="comparison-table">
                    <tr>
                        <td>Heating</td>
                        <td>${Math.round(results.breakdown.heating || 0).toLocaleString()} kWh</td>
                    </tr>
                    <tr>
                        <td>Cooling</td>
                        <td>${Math.round(results.breakdown.cooling || 0).toLocaleString()} kWh</td>
                    </tr>
                    <tr>
                        <td>Hot Water</td>
                        <td>${Math.round(results.breakdown.hotWater || 0).toLocaleString()} kWh</td>
                    </tr>
                    <tr>
                        <td>Cooking</td>
                        <td>${Math.round((results.breakdown.cooktop || 0) + (results.breakdown.oven || 0)).toLocaleString()} kWh</td>
                    </tr>
                    <tr>
                        <td>Appliances</td>
                        <td>${Math.round(results.breakdown.baseLoad || 0).toLocaleString()} kWh</td>
                    </tr>
                    <tr>
                        <td>Transport</td>
                        <td>${Math.round(results.transportPetrol + results.transportDiesel + results.transportElectric).toLocaleString()} kWh</td>
                    </tr>
                </table>

                <h3 style="margin-top: 30px;">Comparison to Victorian Average</h3>
                <table class="comparison-table">
                    <thead>
                        <tr>
                            <th>Category</th>
                            <th>Your Household</th>
                            <th>Victorian Average</th>
                            <th>Difference</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><strong>Heating</strong></td>
                            <td>${Math.round(userData.heating).toLocaleString()} kWh</td>
                            <td>${Math.round(victorianAverages.heating).toLocaleString()} kWh</td>
                            <td>${Math.round(userData.heating - victorianAverages.heating).toLocaleString()} kWh</td>
                        </tr>
                        <tr>
                            <td><strong>Cooling</strong></td>
                            <td>${Math.round(userData.cooling).toLocaleString()} kWh</td>
                            <td>${Math.round(victorianAverages.cooling).toLocaleString()} kWh</td>
                            <td>${Math.round(userData.cooling - victorianAverages.cooling).toLocaleString()} kWh</td>
                        </tr>
                        <tr>
                            <td><strong>Hot Water</strong></td>
                            <td>${Math.round(userData.hotWater).toLocaleString()} kWh</td>
                            <td>${Math.round(victorianAverages.hotWater).toLocaleString()} kWh</td>
                            <td>${Math.round(userData.hotWater - victorianAverages.hotWater).toLocaleString()} kWh</td>
                        </tr>
                        <tr>
                            <td><strong>Cooking</strong></td>
                            <td>${Math.round(userData.cooking).toLocaleString()} kWh</td>
                            <td>${Math.round(victorianAverages.cooking).toLocaleString()} kWh</td>
                            <td>${Math.round(userData.cooking - victorianAverages.cooking).toLocaleString()} kWh</td>
                        </tr>
                        <tr>
                            <td><strong>Transport</strong></td>
                            <td>${Math.round(userData.transport).toLocaleString()} kWh</td>
                            <td>${Math.round(victorianAverages.transport).toLocaleString()} kWh</td>
                            <td>${Math.round(userData.transport - victorianAverages.transport).toLocaleString()} kWh</td>
                        </tr>
                        <tr>
                            <td><strong>Appliances</strong></td>
                            <td>${Math.round(userData.appliances).toLocaleString()} kWh</td>
                            <td>${Math.round(victorianAverages.appliances).toLocaleString()} kWh</td>
                            <td>${Math.round(userData.appliances - victorianAverages.appliances).toLocaleString()} kWh</td>
                        </tr>
                    </tbody>
                </table>
            `;
        }

        function emailReport() {
            const totalEnergy = results.electricity + results.gas + results.transportPetrol + results.transportDiesel;
            
            const subject = encodeURIComponent('Victorian Household Energy Audit Results');
            const body = encodeURIComponent(`
Household Energy Audit Report
Student: ${auditData.studentName || 'Not provided'}
Postcode: ${auditData.postcode || 'Not provided'}
Date: ${new Date().toLocaleDateString('en-AU')}

SUMMARY
Total Energy Use: ${Math.round(totalEnergy).toLocaleString()} kWh/year
Electricity: ${Math.round(results.electricity).toLocaleString()} kWh/year
Natural Gas: ${Math.round(results.gas).toLocaleString()} kWh/year
Transport: ${Math.round(results.transportPetrol + results.transportDiesel).toLocaleString()} kWh/year
CO₂ Emissions: ${Math.round(results.co2).toLocaleString()} kg/year

HOUSEHOLD DETAILS
Dwelling Type: ${auditData.dwellingType || 'Not specified'}
Occupants: ${auditData.occupants}
Floor Area: ${auditData.floorArea || 'Not specified'}
Building Age: ${auditData.buildingAge || 'Not specified'}

ENERGY BREAKDOWN
Heating: ${Math.round(results.breakdown.heating || 0).toLocaleString()} kWh
Cooling: ${Math.round(results.breakdown.cooling || 0).toLocaleString()} kWh
Hot Water: ${Math.round(results.breakdown.hotWater || 0).toLocaleString()} kWh
Cooking: ${Math.round((results.breakdown.cooktop || 0) + (results.breakdown.oven || 0)).toLocaleString()} kWh
Appliances: ${Math.round(results.breakdown.baseLoad || 0).toLocaleString()} kWh
Transport: ${Math.round(results.transportPetrol + results.transportDiesel + results.transportElectric).toLocaleString()} kWh

Generated by Victorian Household Energy Audit Tool
            `);

            window.location.href = `mailto:?subject=${subject}&body=${body}`;
        }

        function toggleExpand(header) {
            const content = header.nextElementSibling;
            content.classList.toggle('show');
            const arrow = header.querySelector('span:last-child');
            arrow.textContent = content.classList.contains('show') ? '▲' : '▼';
        }
    </script>
</body>
</html>